@menu
* Startup Functions::
* File System Functions::
* Widget Utilities::
* MTZ and data handling utilities::
* Molecule Info Functions::
* Library and Utility Functions::
* Graphics Utility Functions::
* Interface Preferences::
* Mouse Buttons::
* Cursor Function::
* Model/Fit/Refine Functions::
* Backup Functions::
* Recover Session Function::
* Map Functions::
* Density Increment::
* Density Functions::
* Parameters from map::
* PDB Functions::
* Refmac Functions::
* Symmetry Functions::
* History Functions::
* State Functions::
* The Virtual Trackball::
* Clipping Functions::
* Unit Cell interface::
* Colour::
* Map colour::
* Anisotropic Atoms Interface::
* Display Functions::
* Smooth Scrolling::
* Font Parameters::
* Rotation Centre::
* Atom Selection Utilities::
* Skeletonization Interface::
* Skeleton Colour::
* Read Maps::
* Save Coordinates::
* Read Phases File Functions::
* Graphics Move::
* Go To Atom Widget Functions::
* Map and Molecule Control::
* Align and Mutate::
* Renumber Residue Range::
* Scripting Interface::
* Monomer::
* Regularization and Refinement::
* Simplex Refinement Interface::
* Nomenclature Errors::
* Atom Info  Interface::
* Residue Info::
* Residue Environment Functions::
* Pointer Functions::
* Zoom Functions::
* CNS Data Functions::
* mmCIF Functions::
* SHELXL Functions::
* Validation Functions::
* Ramachandran Plot Functions::
* Sequence View Interface::
* Atom Labelling::
* Screen Rotation::
* Screen Translation::
* Views Interface::
* Background Colour::
* Ligand Fitting Functions::
* Water Fitting Functions::
* Bond Representation::
* Dots Representation::
* Pep-flip Interface::
* Rigid Body Refinement Interface::
* Add Terminal Residue Functions::
* Delete Residues::
* Mainchain Building Functions::
* Rotatmer Functions::
* 180 Flip Side chain::
* Mutate Functions::
* Pointer Atom Functions::
* Baton Build Interface Functions::
* Crosshairs  Interface::
* Edit Chi Angles::
* Masks::
* check Waters Interface::
* Trim::
* External Ray-Tracing::
* Superposition (SSM)::
* NCS::
* Helices and Strands::
* Nucleotides::
* New Molecule by Section Interface::
* RNA/DNA::
* Sequence (Assignment)::
* Surface Interface::
* FFFearing::
* Remote Control::
* Display Lists for Maps::
* Browser Interface::
* Generic Objects::
* Molprobity Interface::
* Map Sharpening Interface::
* Marking Fixed Atom Interface::
* Partial Charges::
* EM interface::
* CCP4mg Interface::
* Aux functions::
* SMILES::
* PHENIX Support::
* Graphics Text::
* PISA Interaction::
* Jiggle Fit::
* SBase interface::
* FLE-View::
* LSQ-improve::
* single-model view::
* graphics 2D ligand view::
@end menu

@node Startup Functions
@section Startup Functions

@menu
* set-prefer-python::
* prefer-python::
@end menu

@node set-prefer-python
@subsection set-prefer-python
@deffn function set-prefer-python

tell coot that you prefer to run python scripts if/when there is an option to do so. 

@end deffn

@node prefer-python
@subsection prefer-python
@deffn function prefer-python

the python-prefered mode. 

This is available so that the scripting functions know whether on not to put themselves onto in as menu items.

If you consider using this, consider in preference use_gui_qm == 2, which is used elsewhere to stop python functions adding to the gui, when guile-gtk functions have alread done so. We should clean up this (rather obscure) interface at some stage.

return 1 for python is prefered, 0 for not. 

@end deffn

@node File System Functions
@section File System Functions

@menu
* make-directory-maybe::
* set-show-paths-in-display-manager::
* show-paths-in-display-manager-state::
* add-coordinates-glob-extension::
* add-data-glob-extension::
* add-dictionary-glob-extension::
* add-map-glob-extension::
* remove-coordinates-glob-extension::
* remove-data-glob-extension::
* remove-dictionary-glob-extension::
* remove-map-glob-extension::
* set-sticky-sort-by-date::
* unset-sticky-sort-by-date::
* set-filter-fileselection-filenames::
* filter-fileselection-filenames-state::
* file-type-coords::
* open-coords-dialog::
* set-file-chooser-selector::
@end menu

@node make-directory-maybe
@subsection make-directory-maybe
@deffn function make-directory-maybe dir

Where @emph{dir} is a string

make a directory dir (if it doesn't exist) and return error code 

If it can be created, create the directory dir, return the success status like mkdir: mkdir

Returns: zero on success, or -1 if an error occurred. If dir already exists as a directory, return 0 of course. 

@end deffn

@node set-show-paths-in-display-manager
@subsection set-show-paths-in-display-manager
@deffn function set-show-paths-in-display-manager i

Where @emph{i} is an integer number

Show Paths in Display Manager? 

Some people don't like to see the full path names in the display manager here is the way to turn them off, with an argument of 1. 

@end deffn

@node show-paths-in-display-manager-state
@subsection show-paths-in-display-manager-state
@deffn function show-paths-in-display-manager-state

return the internal state 

What is the internal flag?

Returns: 1 for "yes, display paths" , 0 for not 

@end deffn

@node add-coordinates-glob-extension
@subsection add-coordinates-glob-extension
@deffn function add-coordinates-glob-extension ext

Where @emph{ext} is a string

add an extension to be treated as coordinate files 

@end deffn

@node add-data-glob-extension
@subsection add-data-glob-extension
@deffn function add-data-glob-extension ext

Where @emph{ext} is a string

add an extension to be treated as data (reflection) files 

@end deffn

@node add-dictionary-glob-extension
@subsection add-dictionary-glob-extension
@deffn function add-dictionary-glob-extension ext

Where @emph{ext} is a string

add an extension to be treated as geometry dictionary files 

@end deffn

@node add-map-glob-extension
@subsection add-map-glob-extension
@deffn function add-map-glob-extension ext

Where @emph{ext} is a string

add an extension to be treated as geometry map files 

@end deffn

@node remove-coordinates-glob-extension
@subsection remove-coordinates-glob-extension
@deffn function remove-coordinates-glob-extension ext

Where @emph{ext} is a string

remove an extension to be treated as coordinate files 

@end deffn

@node remove-data-glob-extension
@subsection remove-data-glob-extension
@deffn function remove-data-glob-extension ext

Where @emph{ext} is a string

remove an extension to be treated as data (reflection) files 

@end deffn

@node remove-dictionary-glob-extension
@subsection remove-dictionary-glob-extension
@deffn function remove-dictionary-glob-extension ext

Where @emph{ext} is a string

remove an extension to be treated as geometry dictionary files 

@end deffn

@node remove-map-glob-extension
@subsection remove-map-glob-extension
@deffn function remove-map-glob-extension ext

Where @emph{ext} is a string

remove an extension to be treated as geometry map files 

@end deffn

@node set-sticky-sort-by-date
@subsection set-sticky-sort-by-date
@deffn function set-sticky-sort-by-date

sort files in the file selection by date? 

some people like to have their files sorted by date by default 

@end deffn

@node unset-sticky-sort-by-date
@subsection unset-sticky-sort-by-date
@deffn function unset-sticky-sort-by-date

do not sort files in the file selection by date? 

removes the sorting of files by date 

@end deffn

@node set-filter-fileselection-filenames
@subsection set-filter-fileselection-filenames
@deffn function set-filter-fileselection-filenames istate

Where @emph{istate} is an integer number

on opening a file selection dialog, pre-filter the files. 

set to 1 to pre-filter, [0 (off, non-pre-filtering) is the default 

@end deffn

@node filter-fileselection-filenames-state
@subsection filter-fileselection-filenames-state
@deffn function filter-fileselection-filenames-state

, return the state of the above variable 

@end deffn

@node file-type-coords
@subsection file-type-coords
@deffn function file-type-coords file_name

Where @emph{file_name} is a string

is the given file name suitable to be read as coordinates? 

@end deffn

@node open-coords-dialog
@subsection open-coords-dialog
@deffn function open-coords-dialog

display the open coordinates dialog 

@end deffn

@node set-file-chooser-selector
@subsection set-file-chooser-selector
@deffn function set-file-chooser-selector istate

Where @emph{istate} is an integer number

this flag set chooser as default for windows, otherwise use selector 0 is selector 1 is chooser 

@end deffn

@node Widget Utilities
@section Widget Utilities

@menu
* set-main-window-title::
@end menu

@node set-main-window-title
@subsection set-main-window-title
@deffn function set-main-window-title s

Where @emph{s} is a string

set the main window title. 

function added for Lothar Esser 

@end deffn

@node MTZ and data handling utilities
@section MTZ and data handling utilities

@menu
* manage-column-selector::
@end menu

@node manage-column-selector
@subsection manage-column-selector
@deffn function manage-column-selector filename

Where @emph{filename} is a string

given a filename, try to read it as a data file 

We try as .phs and .cif files first 

@end deffn

@node Molecule Info Functions
@section Molecule Info Functions

@menu
* chain-n-residues::
* seqnum-from-serial-number::
* insertion-code-from-serial-number::
* n-models::
* n-chains::
* is-solvent-chain-p::
* is-protein-chain-p::
* is-nucleotide-chain-p::
* n-residues::
* sort-chains::
* sort-residues::
* remarks-dialog::
* print-header-secondary-structure-info::
* copy-molecule::
* add-ligand-delete-residue-copy-molecule::
* exchange-chain-ids-for-seg-ids::
* show-remarks-browswer::
@end menu

@node chain-n-residues
@subsection chain-n-residues
@deffn function chain-n-residues chain_id imol

Where: 
@itemize @bullet
@item @emph{chain_id} is a string
@item @emph{imol} is an integer number
@end itemize

the number of residues in chain chain_id and molecule number imol 

Returns: the number of residues 

@end deffn

@node seqnum-from-serial-number
@subsection seqnum-from-serial-number
@deffn function seqnum-from-serial-number imol chain_id serial_num

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{serial_num} is an integer number
@end itemize

a residue seqnum (normal residue number) from a residue serial number 

Returns: < -9999 on failure 

@end deffn

@node insertion-code-from-serial-number
@subsection insertion-code-from-serial-number
@deffn function insertion-code-from-serial-number imol chain_id serial_num

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{serial_num} is an integer number
@end itemize

the insertion code of the residue. 

Returns: NULL (scheme False) on failure. 

@end deffn

@node n-models
@subsection n-models
@deffn function n-models imol

Where @emph{imol} is an integer number

the chain_id (string) of the ichain-th chain molecule number imol 


return the number of models in molecule number imol

useful for NMR or other such multi-model molecules.

return the number of models or -1 if there was a problem with the given molecule. 

Returns: the chain-id

@end deffn

@node n-chains
@subsection n-chains
@deffn function n-chains imol

Where @emph{imol} is an integer number

number of chains in molecule number imol 

Returns: the number of chains 

@end deffn

@node is-solvent-chain-p
@subsection is-solvent-chain-p
@deffn function is-solvent-chain-p imol chain_id

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@end itemize

is this a solvent chain? [Raw function] 

This is a raw interface function, you should generally not use this, but instead use (is-solvent-chain? imol chain-id)


This wraps the mmdb function isSolventChain(). 

Returns: -1 on error, 0 for no, 1 for is "a solvent chain". We wouldn't want to be doing rotamer searches and the like on such a chain.

@end deffn

@node is-protein-chain-p
@subsection is-protein-chain-p
@deffn function is-protein-chain-p imol chain_id

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@end itemize

is this a protein chain? [Raw function] 

This is a raw interface function, you should generally not use this, but instead use (is-protein-chain? imol chain-id)


This wraps the mmdb function isAminoacidChain(). 

Returns: -1 on error, 0 for no, 1 for is "a protein chain". We wouldn't want to be doing rotamer searches and the like on such a chain.

@end deffn

@node is-nucleotide-chain-p
@subsection is-nucleotide-chain-p
@deffn function is-nucleotide-chain-p imol chain_id

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@end itemize

is this a nucleic acid chain? [Raw function] 

This is a raw interface function, you should generally not use this, but instead use (is-nucleicacid-chain? imol chain-id)


This wraps the mmdb function isNucleotideChain(). For completeness. 

Returns: -1 on error, 0 for no, 1 for is "a nucleicacid chain". We wouldn't want to be doing rotamer searches and the like on such a chain.

@end deffn

@node n-residues
@subsection n-residues
@deffn function n-residues imol

Where @emph{imol} is an integer number

return the number of residues in the molecule, 

return -1 if this is a map or closed. 

@end deffn

@node sort-chains
@subsection sort-chains
@deffn function sort-chains imol

Where @emph{imol} is an integer number

return a list of the remarks of hte molecule number imol 

sort the chain ids of the imol-th molecule in lexographical order 

@end deffn

@node sort-residues
@subsection sort-residues
@deffn function sort-residues imol

Where @emph{imol} is an integer number

sort the residues of the imol-th molecule 

@end deffn

@node remarks-dialog
@subsection remarks-dialog
@deffn function remarks-dialog imol

Where @emph{imol} is an integer number

a gui dialog showing remarks header info (for a model molecule). 

@end deffn

@node print-header-secondary-structure-info
@subsection print-header-secondary-structure-info
@deffn function print-header-secondary-structure-info imol

Where @emph{imol} is an integer number

simply print secondardy structure info to the terminal/console. In future, this could/should return the info. 

@end deffn

@node copy-molecule
@subsection copy-molecule
@deffn function copy-molecule imol

Where @emph{imol} is an integer number

copy molecule imol 

Returns: the new molecule number. Return -1 on failure to copy molecule (out of range, or molecule is closed) 

@end deffn

@node add-ligand-delete-residue-copy-molecule
@subsection add-ligand-delete-residue-copy-molecule
@deffn function add-ligand-delete-residue-copy-molecule imol_ligand_new chain_id_ligand_new resno_ligand_new imol_current chain_id_ligand_current resno_ligand_current

Where: 
@itemize @bullet
@item @emph{imol_ligand_new} is an integer number
@item @emph{chain_id_ligand_new} is a string
@item @emph{resno_ligand_new} is an integer number
@item @emph{imol_current} is an integer number
@item @emph{chain_id_ligand_current} is a string
@item @emph{resno_ligand_current} is an integer number
@end itemize

Copy a molecule with addition of a ligand and a deletion of current ligand. 

This function is used when adding a new (modified) ligand to a structure. It creates a new molecule that is a copy of the current molecule except that the new ligand is added and the current ligand/residue is deleted. 

@end deffn

@node exchange-chain-ids-for-seg-ids
@subsection exchange-chain-ids-for-seg-ids
@deffn function exchange-chain-ids-for-seg-ids imol

Where @emph{imol} is an integer number

Experimental interface for Ribosome People. 

Ribosome People have many chains in their pdb file, they prefer segids to chainids (chainids are only 1 character). But coot uses the concept of chain ids and not seg-ids. mmdb allow us to use more than one char in the chainid, so after we read in a pdb, let's replace the chain ids with the segids. Will that help? 

@end deffn

@node show-remarks-browswer
@subsection show-remarks-browswer
@deffn function show-remarks-browswer

show the remarks browser 

@end deffn

@node Library and Utility Functions
@section Library and Utility Functions

@menu
* git-revision-count::
* svn-revision::
* molecule-name::
* set-molecule-name::
* coot-real-exit::
* coot-no-state-real-exit::
* coot-clear-backup-or-real-exit::
* coot-save-state-and-exit::
* first-coords-imol::
* first-small-coords-imol::
* first-unsaved-coords-imol::
* mmcif-sfs-to-mtz::
@end menu

@node git-revision-count
@subsection git-revision-count
@deffn function git-revision-count

return the git revision count for for this build. 

@end deffn

@node svn-revision
@subsection svn-revision
@deffn function svn-revision

an alias to git_revision_count() for backwards compatibility 

@end deffn

@node molecule-name
@subsection molecule-name
@deffn function molecule-name imol

Where @emph{imol} is an integer number

return the name of molecule number imol 

Returns: 0 if not a valid name ( -> False in scheme) e.g. "/a/b/c.pdb" for "d/e/f.mtz FWT PHWT" 

@end deffn

@node set-molecule-name
@subsection set-molecule-name
@deffn function set-molecule-name imol new_name

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{new_name} is a string
@end itemize

set the molecule name of the imol-th molecule 

@end deffn

@node coot-real-exit
@subsection coot-real-exit
@deffn function coot-real-exit retval

Where @emph{retval} is an integer number

exit from coot, give return value retval back to invoking process. 

@end deffn

@node coot-no-state-real-exit
@subsection coot-no-state-real-exit
@deffn function coot-no-state-real-exit retval

Where @emph{retval} is an integer number

exit without writing a state file 

@end deffn

@node coot-clear-backup-or-real-exit
@subsection coot-clear-backup-or-real-exit
@deffn function coot-clear-backup-or-real-exit retval

Where @emph{retval} is an integer number

exit coot doing clear-backup maybe 

@end deffn

@node coot-save-state-and-exit
@subsection coot-save-state-and-exit
@deffn function coot-save-state-and-exit retval save_state_flag

Where: 
@itemize @bullet
@item @emph{retval} is an integer number
@item @emph{save_state_flag} is an integer number
@end itemize

exit coot, write a state file 

@end deffn

@node first-coords-imol
@subsection first-coords-imol
@deffn function first-coords-imol

What is the molecule number of first coordinates molecule? 

return -1 when there is none. 

@end deffn

@node first-small-coords-imol
@subsection first-small-coords-imol
@deffn function first-small-coords-imol

molecule number of first small (<400 atoms) molecule. 

return -1 on no such molecule 

@end deffn

@node first-unsaved-coords-imol
@subsection first-unsaved-coords-imol
@deffn function first-unsaved-coords-imol

What is the molecule number of first unsaved coordinates molecule? 

return -1 when there is none. 

@end deffn

@node mmcif-sfs-to-mtz
@subsection mmcif-sfs-to-mtz
@deffn function mmcif-sfs-to-mtz cif_file_name mtz_file_name

Where: 
@itemize @bullet
@item @emph{cif_file_name} is a string
@item @emph{mtz_file_name} is a string
@end itemize

convert the structure factors in cif_file_name to an mtz file. 

Return 1 on success. Return 0 on a file without Rfree, return -1 on complete failure to write a file. 

@end deffn

@node Graphics Utility Functions
@section Graphics Utility Functions

@menu
* set-do-anti-aliasing::
* do-anti-aliasing-state::
* set-do-GL-lighting::
* do-GL-lighting-state::
* use-graphics-interface-state::
* python-at-prompt-at-startup-state::
* start-graphics-interface::
* reset-view::
* graphics-n-molecules::
* toggle-idle-spin-function::
* toggle-idle-rock-function::
* set-rocking-factors::
* set-idle-function-rotate-angle::
* idle-function-rotate-angle::
* handle-read-draw-molecule::
* allow-duplicate-sequence-numbers::
* set-convert-to-v2-atom-names::
* handle-read-draw-molecule-with-recentre::
* handle-read-draw-molecule-and-move-molecule-here::
* read-pdb::
* assign-hetatms::
* hetify-residue::
* residue-has-hetatms::
* het-group-n-atoms::
* replace-fragment::
* copy-residue-range::
* clear-and-update-model-molecule-from-file::
* screendump-image::
* check-for-dark-blue-density::
* set-draw-solid-density-surface::
* set-draw-map-standard-lines::
* solid-surface::
* set-solid-density-surface-opacity::
* set-flat-shading-for-solid-density-surface::
@end menu

@node set-do-anti-aliasing
@subsection set-do-anti-aliasing
@deffn function set-do-anti-aliasing state

Where @emph{state} is an integer number

set the bond lines to be antialiased 

@end deffn

@node do-anti-aliasing-state
@subsection do-anti-aliasing-state
@deffn function do-anti-aliasing-state

return the flag for antialiasing the bond lines 

@end deffn

@node set-do-GL-lighting
@subsection set-do-GL-lighting
@deffn function set-do-GL-lighting state

Where @emph{state} is an integer number

turn the GL lighting on (state = 1) or off (state = 0) 

slows down the display of simple lines 

@end deffn

@node do-GL-lighting-state
@subsection do-GL-lighting-state
@deffn function do-GL-lighting-state

return the flag for GL lighting 

@end deffn

@node use-graphics-interface-state
@subsection use-graphics-interface-state
@deffn function use-graphics-interface-state

shall we start up the Gtk and the graphics window? 

if passed the command line argument 

no-graphics, coot will not start up gtk itself.

An interface function for Ralf. 

@end deffn

@node python-at-prompt-at-startup-state
@subsection python-at-prompt-at-startup-state
@deffn function python-at-prompt-at-startup-state

is the python interpreter at the prompt? 

Returns: 1 for yes, 0 for no. 

@end deffn

@node start-graphics-interface
@subsection start-graphics-interface
@deffn function start-graphics-interface

start Gtk (and graphics) 

This function is useful if it was not started already (which can be achieved by using the command line argument 

no-graphics).

An interface for Ralf 

@end deffn

@node reset-view
@subsection reset-view
@deffn function reset-view

"Reset" the view 

return 1 if we moved, else return 0.

centre on last-read molecule with zoom 100. If we are there, then go to the previous molecule, if we are there, then go to the origin. 

@end deffn

@node graphics-n-molecules
@subsection graphics-n-molecules
@deffn function graphics-n-molecules

return the number of molecules (coordinates molecules and map molecules combined) that are currently in coot 

Returns: the number of molecules (closed molecules are not counted) 

@end deffn

@node toggle-idle-spin-function
@subsection toggle-idle-spin-function
@deffn function toggle-idle-spin-function

Spin spin spin (or not) 

@end deffn

@node toggle-idle-rock-function
@subsection toggle-idle-rock-function
@deffn function toggle-idle-rock-function

Rock (not roll) (self-timed) 

@end deffn

@node set-rocking-factors
@subsection set-rocking-factors
@deffn function set-rocking-factors width_scale frequency_scale

Where: 
@itemize @bullet
@item @emph{width_scale} is a number
@item @emph{frequency_scale} is a number
@end itemize

Settings for the inevitable discontents who dislike the default rocking rates (defaults 1 and 1) 

@end deffn

@node set-idle-function-rotate-angle
@subsection set-idle-function-rotate-angle
@deffn function set-idle-function-rotate-angle f

Where @emph{f} is a number

how far should we rotate when (auto) spinning? Fast computer? set this to 0.1 

@end deffn

@node idle-function-rotate-angle
@subsection idle-function-rotate-angle
@deffn function idle-function-rotate-angle

what is the idle function rotation angle? 

@end deffn

@node handle-read-draw-molecule
@subsection handle-read-draw-molecule
@deffn function handle-read-draw-molecule filename

Where @emph{filename} is a string

a synonym for read-pdb. Read the coordinates from filename (can be pdb, cif or shelx format) 

@end deffn

@node allow-duplicate-sequence-numbers
@subsection allow-duplicate-sequence-numbers
@deffn function allow-duplicate-sequence-numbers

enable reading PDB/pdbx files with duplicate sequence numbers 

@end deffn

@node set-convert-to-v2-atom-names
@subsection set-convert-to-v2-atom-names
@deffn function set-convert-to-v2-atom-names state

Where @emph{state} is an integer number

shall we convert nucleotides to match the dictionary names? 

Usually we do not want to do this (give current Coot architecture). Most often not, though. Coot should handle the residue synonyms transparently.

default off (0). 

@end deffn

@node handle-read-draw-molecule-with-recentre
@subsection handle-read-draw-molecule-with-recentre
@deffn function handle-read-draw-molecule-with-recentre filename recentre_on_read_pdb_flag

Where: 
@itemize @bullet
@item @emph{filename} is a string
@item @emph{recentre_on_read_pdb_flag} is an integer number
@end itemize

read coordinates from filename with option to not recentre. 

set recentre_on_read_pdb_flag to 0 if you don't want the view to recentre on the new coordinates. 

@end deffn

@node handle-read-draw-molecule-and-move-molecule-here
@subsection handle-read-draw-molecule-and-move-molecule-here
@deffn function handle-read-draw-molecule-and-move-molecule-here filename

Where @emph{filename} is a string

read coordinates from filename and recentre the new molecule at the screen rotation centre. 

@end deffn

@node read-pdb
@subsection read-pdb
@deffn function read-pdb filename

Where @emph{filename} is a string

read coordinates from filename 

@end deffn

@node assign-hetatms
@subsection assign-hetatms
@deffn function assign-hetatms imol

Where @emph{imol} is an integer number

some programs produce PDB files with ATOMs where there should be HETATMs. This is a function to assign HETATMs as per the PDB definition. 

@end deffn

@node hetify-residue
@subsection hetify-residue
@deffn function hetify-residue imol chain_id resno ins_code

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{ins_code} is a string
@end itemize

if this is not a standard group, then turn the atoms to HETATMs. 

Return 1 on atoms changes, 0 on not. Return -1 if residue not found. 

@end deffn

@node residue-has-hetatms
@subsection residue-has-hetatms
@deffn function residue-has-hetatms imol chain_id resno ins_code

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{ins_code} is a string
@end itemize

residue has HETATMs? 

return 1 if all atoms of the specified residue are HETATMs, else, return 0. If residue not found, return -1. 

@end deffn

@node het-group-n-atoms
@subsection het-group-n-atoms
@deffn function het-group-n-atoms comp_id

Where @emph{comp_id} is a string

return the number of non-hydrogen atoms in the given het-group (comp-id). 

Return -1 on comp-id not found in dictionary. 

@end deffn

@node replace-fragment
@subsection replace-fragment
@deffn function replace-fragment imol_target imol_fragment atom_selection

Where: 
@itemize @bullet
@item @emph{imol_target} is an integer number
@item @emph{imol_fragment} is an integer number
@item @emph{atom_selection} is a string
@end itemize

replace the parts of molecule number imol that are duplicated in molecule number imol_frag 

@end deffn

@node copy-residue-range
@subsection copy-residue-range
@deffn function copy-residue-range imol_target chain_id_target imol_reference chain_id_reference resno_range_start resno_range_end

Where: 
@itemize @bullet
@item @emph{imol_target} is an integer number
@item @emph{chain_id_target} is a string
@item @emph{imol_reference} is an integer number
@item @emph{chain_id_reference} is a string
@item @emph{resno_range_start} is an integer number
@item @emph{resno_range_end} is an integer number
@end itemize

copy the given residue range from the reference chain to the target chain 

resno_range_start and resno_range_end are inclusive. 

@end deffn

@node clear-and-update-model-molecule-from-file
@subsection clear-and-update-model-molecule-from-file
@deffn function clear-and-update-model-molecule-from-file molecule_number file_name

Where: 
@itemize @bullet
@item @emph{molecule_number} is an integer number
@item @emph{file_name} is a string
@end itemize

replace pdb. Fail if molecule_number is not a valid model molecule. Return -1 on failure. Else return molecule_number 

@end deffn

@node screendump-image
@subsection screendump-image
@deffn function screendump-image filename

Where @emph{filename} is a string

dump the current screen image to a file. Format ppm 

You can use this, in conjunction with spinning and view moving functions to make movies 

@end deffn

@node check-for-dark-blue-density
@subsection check-for-dark-blue-density
@deffn function check-for-dark-blue-density

give a warning dialog if density it too dark (blue) 

@end deffn

@node set-draw-solid-density-surface
@subsection set-draw-solid-density-surface
@deffn function set-draw-solid-density-surface imol state

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{state} is an integer number
@end itemize

sets the density map of the given molecule to be drawn as a (transparent) solid surface. 

@end deffn

@node set-draw-map-standard-lines
@subsection set-draw-map-standard-lines
@deffn function set-draw-map-standard-lines imol state

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{state} is an integer number
@end itemize

toggle for standard lines representation of map. 

This turns off/on standard lines representation of map. transparent surface is another representation type.

If you want to just turn off a map, don't use this, use 

. 

@end deffn

@node solid-surface
@subsection solid-surface
@deffn function solid-surface imap on_off_flag

Where: 
@itemize @bullet
@item @emph{imap} is an integer number
@item @emph{on_off_flag} is an integer number
@end itemize

set the state of the solid surface representation for molecule imap 

@end deffn

@node set-solid-density-surface-opacity
@subsection set-solid-density-surface-opacity
@deffn function set-solid-density-surface-opacity imol opacity

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{opacity} is a number
@end itemize

set the opacity of density surface representation of the given map. 

0.0 is totally transparent, 1.0 is completely opaque and (because the objects are no longer depth sorted) considerably faster to render. 0.3 is a reasonable number. 

@end deffn

@node set-flat-shading-for-solid-density-surface
@subsection set-flat-shading-for-solid-density-surface
@deffn function set-flat-shading-for-solid-density-surface state

Where @emph{state} is an integer number

set the flag to do flat shading rather than smooth shading for solid density surface. 

Default is 1 (on. 

@end deffn

@node Interface Preferences
@section Interface Preferences

@menu
* set-scroll-by-wheel-mouse::
* scroll-by-wheel-mouse-state::
* set-default-initial-contour-level-for-map::
* set-default-initial-contour-level-for-difference-map::
* print-view-matrix::
* get-view-quaternion-internal::
* set-view-quaternion::
* apply-ncs-to-view-orientation::
* apply-ncs-to-view-orientation-and-screen-centre::
* set-fps-flag::
* get-fps-flag::
* set-show-origin-marker::
* show-origin-marker-state::
* hide-modelling-toolbar::
* show-modelling-toolbar::
* hide-main-toolbar::
* show-main-toolbar::
* show-model-toolbar-all-icons::
* show-model-toolbar-main-icons::
* reattach-modelling-toolbar::
* set-model-toolbar-docked-position::
* suck-model-fit-dialog::
* add-status-bar-text::
* set-model-fit-refine-dialog-stays-on-top::
* model-fit-refine-dialog-stays-on-top-state::
* accept-reject-dialog-docked-state::
* set-accept-reject-dialog-docked-show::
* accept-reject-dialog-docked-show-state::
@end menu

@node set-scroll-by-wheel-mouse
@subsection set-scroll-by-wheel-mouse
@deffn function set-scroll-by-wheel-mouse istate

Where @emph{istate} is an integer number

Some people (like Phil Evans) don't want to scroll their map with the mouse-wheel. 

To turn off mouse wheel recontouring call this with istate value of 0 

@end deffn

@node scroll-by-wheel-mouse-state
@subsection scroll-by-wheel-mouse-state
@deffn function scroll-by-wheel-mouse-state

return the internal state of the scroll-wheel map contouring 

@end deffn

@node set-default-initial-contour-level-for-map
@subsection set-default-initial-contour-level-for-map
@deffn function set-default-initial-contour-level-for-map n_sigma

Where @emph{n_sigma} is a number

set the default inital contour for 2FoFc-style map 

in sigma 

@end deffn

@node set-default-initial-contour-level-for-difference-map
@subsection set-default-initial-contour-level-for-difference-map
@deffn function set-default-initial-contour-level-for-difference-map n_sigma

Where @emph{n_sigma} is a number

set the default inital contour for FoFc-style map 

in sigma 

@end deffn

@node print-view-matrix
@subsection print-view-matrix
@deffn function print-view-matrix

print the view matrix to the console, useful for molscript, perhaps 

@end deffn

@node get-view-quaternion-internal
@subsection get-view-quaternion-internal
@deffn function get-view-quaternion-internal element

Where @emph{element} is an integer number

internal function to get an element of the view quaternion. The whole quaternion is returned by the scheme function view-quaternion 

@end deffn

@node set-view-quaternion
@subsection set-view-quaternion
@deffn function set-view-quaternion i j k l

Where: 
@itemize @bullet
@item @emph{i} is a number
@item @emph{j} is a number
@item @emph{k} is a number
@item @emph{l} is a number
@end itemize

Set the view quaternion. 

@end deffn

@node apply-ncs-to-view-orientation
@subsection apply-ncs-to-view-orientation
@deffn function apply-ncs-to-view-orientation imol current_chain next_ncs_chain

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{current_chain} is a string
@item @emph{next_ncs_chain} is a string
@end itemize

Given that we are in chain current_chain, apply the NCS operator that maps current_chain on to next_ncs_chain, so that the relative view is preserved. For NCS skipping. 

@end deffn

@node apply-ncs-to-view-orientation-and-screen-centre
@subsection apply-ncs-to-view-orientation-and-screen-centre
@deffn function apply-ncs-to-view-orientation-and-screen-centre imol current_chain next_ncs_chain forward_flag

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{current_chain} is a string
@item @emph{next_ncs_chain} is a string
@item @emph{forward_flag} is an integer number
@end itemize

as above, but shift the screen centre also. 

@end deffn

@node set-fps-flag
@subsection set-fps-flag
@deffn function set-fps-flag t

Where @emph{t} is an integer number

set show frame-per-second flag 

@end deffn

@node get-fps-flag
@subsection get-fps-flag
@deffn function get-fps-flag

set the state of show frames-per-second flag 

@end deffn

@node set-show-origin-marker
@subsection set-show-origin-marker
@deffn function set-show-origin-marker istate

Where @emph{istate} is an integer number

set a flag: is the origin marker to be shown? 1 for yes, 0 for no. 

@end deffn

@node show-origin-marker-state
@subsection show-origin-marker-state
@deffn function show-origin-marker-state

return the origin marker shown? state 

@end deffn

@node hide-modelling-toolbar
@subsection hide-modelling-toolbar
@deffn function hide-modelling-toolbar

hide the vertical modelling toolbar in the GTK2 version 

@end deffn

@node show-modelling-toolbar
@subsection show-modelling-toolbar
@deffn function show-modelling-toolbar

show the vertical modelling toolbar in the GTK2 version (the toolbar is shown by default) 

@end deffn

@node hide-main-toolbar
@subsection hide-main-toolbar
@deffn function hide-main-toolbar

hide the horizontal main toolbar in the GTK2 version 

@end deffn

@node show-main-toolbar
@subsection show-main-toolbar
@deffn function show-main-toolbar

show the horizontal main toolbar in the GTK2 version (the toolbar is shown by default) 

@end deffn

@node show-model-toolbar-all-icons
@subsection show-model-toolbar-all-icons
@deffn function show-model-toolbar-all-icons

show all available icons in the modelling toolbar (same as MFR dialog) 

@end deffn

@node show-model-toolbar-main-icons
@subsection show-model-toolbar-main-icons
@deffn function show-model-toolbar-main-icons

show only a selection of icons in the modelling toolbar 

@end deffn

@node reattach-modelling-toolbar
@subsection reattach-modelling-toolbar
@deffn function reattach-modelling-toolbar

reattach the modelling toolbar to the last attached position 

@end deffn

@node set-model-toolbar-docked-position
@subsection set-model-toolbar-docked-position
@deffn function set-model-toolbar-docked-position state

Where @emph{state} is an integer number

to swap sides of the Model/Fit/Refine toolbar 0 (default) is right, 1 is left, 2 is top, 3 is bottom 

@end deffn

@node suck-model-fit-dialog
@subsection suck-model-fit-dialog
@deffn function suck-model-fit-dialog

reparent the Model/Fit/Refine dialog so that it becomes part of the main window, next to the GL graphics context 

@end deffn

@node add-status-bar-text
@subsection add-status-bar-text
@deffn function add-status-bar-text s

Where @emph{s} is a string

Put text s into the status bar. 

use this to put info for the user in the statusbar (less intrusive than popup). 

@end deffn

@node set-model-fit-refine-dialog-stays-on-top
@subsection set-model-fit-refine-dialog-stays-on-top
@deffn function set-model-fit-refine-dialog-stays-on-top istate

Where @emph{istate} is an integer number

model-fit-refine dialog stays on top 

@end deffn

@node model-fit-refine-dialog-stays-on-top-state
@subsection model-fit-refine-dialog-stays-on-top-state
@deffn function model-fit-refine-dialog-stays-on-top-state

return the state model-fit-refine dialog stays on top 

@end deffn

@node accept-reject-dialog-docked-state
@subsection accept-reject-dialog-docked-state
@deffn function accept-reject-dialog-docked-state

the accept/reject dialog docked state 

@end deffn

@node set-accept-reject-dialog-docked-show
@subsection set-accept-reject-dialog-docked-show
@deffn function set-accept-reject-dialog-docked-show state

Where @emph{state} is an integer number

set the accept/reject dialog docked show state 

@end deffn

@node accept-reject-dialog-docked-show-state
@subsection accept-reject-dialog-docked-show-state
@deffn function accept-reject-dialog-docked-show-state

what is the accept/reject dialog docked show state? 

@end deffn

@node Mouse Buttons
@section Mouse Buttons

@menu
* set-control-key-for-rotate::
* control-key-for-rotate-state::
* blob-under-pointer-to-screen-centre::
@end menu

@node set-control-key-for-rotate
@subsection set-control-key-for-rotate
@deffn function set-control-key-for-rotate state

Where @emph{state} is an integer number

Alternate mode for rotation. 

Prefered by some, including Dirk Kostrewa. I don't think this mode works properly yet 

@end deffn

@node control-key-for-rotate-state
@subsection control-key-for-rotate-state
@deffn function control-key-for-rotate-state

return the control key rotate state 

@end deffn

@node blob-under-pointer-to-screen-centre
@subsection blob-under-pointer-to-screen-centre
@deffn function blob-under-pointer-to-screen-centre

Put the blob under the cursor to the screen centre. Check only positive blobs. Useful function if bound to a key. 

The refinement map must be set. (We can't check all maps because they are not (or may not be) on the same scale).

Returns: 1 if successfully found a blob and moved there. return 0 if no move. 

@end deffn

@node Cursor Function
@section Cursor Function

@menu
* normal-cursor::
* fleur-cursor::
* pick-cursor-maybe::
* rotate-cursor::
* set-pick-cursor-index::
@end menu

@node normal-cursor
@subsection normal-cursor
@deffn function normal-cursor

normal cursor 

@end deffn

@node fleur-cursor
@subsection fleur-cursor
@deffn function fleur-cursor

fleur cursor 

@end deffn

@node pick-cursor-maybe
@subsection pick-cursor-maybe
@deffn function pick-cursor-maybe

pick cursor maybe 

@end deffn

@node rotate-cursor
@subsection rotate-cursor
@deffn function rotate-cursor

rotate cursor 

@end deffn

@node set-pick-cursor-index
@subsection set-pick-cursor-index
@deffn function set-pick-cursor-index icursor_index

Where @emph{icursor_index} is an integer number

let the user have a different pick cursor 

sometimes (the default) GDK_CROSSHAIR is hard to see, let the user set their own 

@end deffn

@node Model/Fit/Refine Functions
@section Model/Fit/Refine Functions

@menu
* post-model-fit-refine-dialog::
* unset-model-fit-refine-dialog::
* unset-refine-params-dialog::
* show-select-map-dialog::
* set-model-fit-refine-rotate-translate-zone-label::
* set-model-fit-refine-place-atom-at-pointer-label::
* post-other-modelling-tools-dialog::
* set-refinement-move-atoms-with-zero-occupancy::
* refinement-move-atoms-with-zero-occupancy-state::
@end menu

@node post-model-fit-refine-dialog
@subsection post-model-fit-refine-dialog
@deffn function post-model-fit-refine-dialog

display the Model/Fit/Refine dialog 

@end deffn

@node unset-model-fit-refine-dialog
@subsection unset-model-fit-refine-dialog
@deffn function unset-model-fit-refine-dialog

unset model/fit/refine dialog 

@end deffn

@node unset-refine-params-dialog
@subsection unset-refine-params-dialog
@deffn function unset-refine-params-dialog

unset refine params dialog 

@end deffn

@node show-select-map-dialog
@subsection show-select-map-dialog
@deffn function show-select-map-dialog

display the Display Manager dialog 

@end deffn

@node set-model-fit-refine-rotate-translate-zone-label
@subsection set-model-fit-refine-rotate-translate-zone-label
@deffn function set-model-fit-refine-rotate-translate-zone-label txt

Where @emph{txt} is a string

Allow the changing of Model/Fit/Refine button label from "Rotate/Translate Zone". 

@end deffn

@node set-model-fit-refine-place-atom-at-pointer-label
@subsection set-model-fit-refine-place-atom-at-pointer-label
@deffn function set-model-fit-refine-place-atom-at-pointer-label txt

Where @emph{txt} is a string

Allow the changing of Model/Fit/Refine button label from "Place Atom at Pointer". 

@end deffn

@node post-other-modelling-tools-dialog
@subsection post-other-modelling-tools-dialog
@deffn function post-other-modelling-tools-dialog

display the Other Modelling Tools dialog 

@end deffn

@node set-refinement-move-atoms-with-zero-occupancy
@subsection set-refinement-move-atoms-with-zero-occupancy
@deffn function set-refinement-move-atoms-with-zero-occupancy state

Where @emph{state} is an integer number

shall atoms with zero occupancy be moved when refining? (default 1, yes) 

@end deffn

@node refinement-move-atoms-with-zero-occupancy-state
@subsection refinement-move-atoms-with-zero-occupancy-state
@deffn function refinement-move-atoms-with-zero-occupancy-state

return the state of "shall atoms with zero occupancy be moved 
when refining?" 

@end deffn

@node Backup Functions
@section Backup Functions

@menu
* make-backup::
* turn-off-backup::
* turn-on-backup::
* backup-state::
* apply-undo::
* apply-redo::
* set-have-unsaved-changes::
* have-unsaved-changes-p::
* set-undo-molecule::
* show-set-undo-molecule-chooser::
* set-unpathed-backup-file-names::
* unpathed-backup-file-names-state::
* backup-compress-files-state::
* set-backup-compress-files::
@end menu

@node make-backup
@subsection make-backup
@deffn function make-backup imol

Where @emph{imol} is an integer number

make backup for molecule number imol 

@end deffn

@node turn-off-backup
@subsection turn-off-backup
@deffn function turn-off-backup imol

Where @emph{imol} is an integer number

turn off backups for molecule number imol 

@end deffn

@node turn-on-backup
@subsection turn-on-backup
@deffn function turn-on-backup imol

Where @emph{imol} is an integer number

turn on backups for molecule number imol 

@end deffn

@node backup-state
@subsection backup-state
@deffn function backup-state imol

Where @emph{imol} is an integer number

return the backup state for molecule number imol 

return 0 for backups off, 1 for backups on, -1 for unknown 

@end deffn

@node apply-undo
@subsection apply-undo
@deffn function apply-undo

apply undo - the "Undo" button callback 

@end deffn

@node apply-redo
@subsection apply-redo
@deffn function apply-redo

apply redo - the "Redo" button callback 

@end deffn

@node set-have-unsaved-changes
@subsection set-have-unsaved-changes
@deffn function set-have-unsaved-changes imol

Where @emph{imol} is an integer number

set the molecule number imol to be marked as having unsaved changes 

@end deffn

@node have-unsaved-changes-p
@subsection have-unsaved-changes-p
@deffn function have-unsaved-changes-p imol

Where @emph{imol} is an integer number

does molecule number imol have unsaved changes? 

Returns: -1 on bad imol, 0 on no unsaved changes, 1 on has unsaved changes 

@end deffn

@node set-undo-molecule
@subsection set-undo-molecule
@deffn function set-undo-molecule imol

Where @emph{imol} is an integer number

set the molecule to which undo operations are done to molecule number imol 

@end deffn

@node show-set-undo-molecule-chooser
@subsection show-set-undo-molecule-chooser
@deffn function show-set-undo-molecule-chooser

show the Undo Molecule chooser - i.e. choose the molecule to which the "Undo" button applies. 

@end deffn

@node set-unpathed-backup-file-names
@subsection set-unpathed-backup-file-names
@deffn function set-unpathed-backup-file-names state

Where @emph{state} is an integer number

set the state for adding paths to backup file names 

by default directories names are added into the filename for backup (with / to _ mapping). call this with state=1 to turn off directory names 

@end deffn

@node unpathed-backup-file-names-state
@subsection unpathed-backup-file-names-state
@deffn function unpathed-backup-file-names-state

return the state for adding paths to backup file names 

@end deffn

@node backup-compress-files-state
@subsection backup-compress-files-state
@deffn function backup-compress-files-state

return the state for compression of backup files 

@end deffn

@node set-backup-compress-files
@subsection set-backup-compress-files
@deffn function set-backup-compress-files state

Where @emph{state} is an integer number

set if backup files will be compressed or not using gzip 

@end deffn

@node Recover Session Function
@section Recover Session Function

@menu
* recover-session::
@end menu

@node recover-session
@subsection recover-session
@deffn function recover-session

recover session 

After a crash, we provide this convenient interface to restore the session. It runs through all the molecules with models and looks at the coot backup directory looking for related backup files that are more recent that the read file. (Not very good, because you need to remember which files you read in before the crash - should be improved.) 

@end deffn

@node Map Functions
@section Map Functions

@menu
* calc-phases-generic::
* map-from-mtz-by-refmac-calc-phases::
* map-from-mtz-by-calc-phases::
* set-scroll-wheel-map::
* set-scrollable-map::
* scroll-wheel-map::
* save-previous-map-colour::
* restore-previous-map-colour::
* set-active-map-drag-flag::
* get-active-map-drag-flag::
* set-last-map-colour::
* set-map-colour::
* set-last-map-sigma-step::
* set-contour-by-sigma-step-by-mol::
* data-resolution::
* model-resolution::
* export-map::
* export-map-fragment::
* export-map-fragment-with-origin-shift::
* difference-map::
* reinterp-map::
* smooth-map::
@end menu

@node calc-phases-generic
@subsection calc-phases-generic
@deffn function calc-phases-generic mtz_file_name

Where @emph{mtz_file_name} is a string

fire up a GUI, which asks us which model molecule we want to calc phases from. On "OK" button there, we call map_from_mtz_by_refmac_calc_phases()

@end deffn

@node map-from-mtz-by-refmac-calc-phases
@subsection map-from-mtz-by-refmac-calc-phases
@deffn function map-from-mtz-by-refmac-calc-phases mtz_file_name f_col sigf_col imol_coords

Where: 
@itemize @bullet
@item @emph{mtz_file_name} is a string
@item @emph{f_col} is a string
@item @emph{sigf_col} is a string
@item @emph{imol_coords} is an integer number
@end itemize

Calculate SFs (using refmac optionally) from an MTZ file and generate a map. Get F and SIGF automatically (first of their type) from the mtz file. 

Returns: the new molecule number, -1 on a problem. 

@end deffn

@node map-from-mtz-by-calc-phases
@subsection map-from-mtz-by-calc-phases
@deffn function map-from-mtz-by-calc-phases mtz_file_name f_col sigf_col imol_coords

Where: 
@itemize @bullet
@item @emph{mtz_file_name} is a string
@item @emph{f_col} is a string
@item @emph{sigf_col} is a string
@item @emph{imol_coords} is an integer number
@end itemize

Calculate SFs from an MTZ file and generate a map. 

Returns: the new molecule number. 

@end deffn

@node set-scroll-wheel-map
@subsection set-scroll-wheel-map
@deffn function set-scroll-wheel-map imap

Where @emph{imap} is an integer number

set the map that is moved by changing the scroll wheel and change_contour_level(). 

@end deffn

@node set-scrollable-map
@subsection set-scrollable-map
@deffn function set-scrollable-map imol

Where @emph{imol} is an integer number

return the molecule number to which the mouse scroll wheel is attached 

set the map that has its contour level changed by the scrolling the mouse wheel to molecule number imol (same as 

). 

@end deffn

@node scroll-wheel-map
@subsection scroll-wheel-map
@deffn function scroll-wheel-map

the contouring of which map is altered when the scroll wheel changes? 

@end deffn

@node save-previous-map-colour
@subsection save-previous-map-colour
@deffn function save-previous-map-colour imol

Where @emph{imol} is an integer number

save previous colour map for molecule number imol 

@end deffn

@node restore-previous-map-colour
@subsection restore-previous-map-colour
@deffn function restore-previous-map-colour imol

Where @emph{imol} is an integer number

restore previous colour map for molecule number imol 

@end deffn

@node set-active-map-drag-flag
@subsection set-active-map-drag-flag
@deffn function set-active-map-drag-flag t

Where @emph{t} is an integer number

set the state of immediate map upate on map drag. 

By default, it is on (t=1). On slower computers it might be better to set t=0. 

@end deffn

@node get-active-map-drag-flag
@subsection get-active-map-drag-flag
@deffn function get-active-map-drag-flag

return the state of the dragged map flag 

@end deffn

@node set-last-map-colour
@subsection set-last-map-colour
@deffn function set-last-map-colour f1 f2 f3

Where: 
@itemize @bullet
@item @emph{f1} is a number
@item @emph{f2} is a number
@item @emph{f3} is a number
@end itemize

set the colour of the last (highest molecule number) map 

@end deffn

@node set-map-colour
@subsection set-map-colour
@deffn function set-map-colour imol red green blue

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{red} is a number
@item @emph{green} is a number
@item @emph{blue} is a number
@end itemize

set the colour of the imolth map 

@end deffn

@node set-last-map-sigma-step
@subsection set-last-map-sigma-step
@deffn function set-last-map-sigma-step f

Where @emph{f} is a number

set the sigma step of the last map to f sigma 

@end deffn

@node set-contour-by-sigma-step-by-mol
@subsection set-contour-by-sigma-step-by-mol
@deffn function set-contour-by-sigma-step-by-mol f state imol

Where: 
@itemize @bullet
@item @emph{f} is a number
@item @emph{state} is an integer number
@item @emph{imol} is an integer number
@end itemize

set the contour level step 

set the contour level step of molecule number imol to f and variable state (setting state to 0 turns off contouring by sigma level) 

@end deffn

@node data-resolution
@subsection data-resolution
@deffn function data-resolution imol

Where @emph{imol} is an integer number

return the resolution of the data for molecule number imol. Return negative number on error, otherwise resolution in A (eg. 2.0) 

@end deffn

@node model-resolution
@subsection model-resolution
@deffn function model-resolution imol

Where @emph{imol} is an integer number

return the resolution set in the header of the model/coordinates file. If this number is not available, return a number less than 0. 

@end deffn

@node export-map
@subsection export-map
@deffn function export-map imol filename

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{filename} is a string
@end itemize

export (write to disk) the map of molecule number imol to filename. 

Return 0 on failure, 1 on success. 

@end deffn

@node export-map-fragment
@subsection export-map-fragment
@deffn function export-map-fragment imol x y z radius filename

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{x} is a number
@item @emph{y} is a number
@item @emph{z} is a number
@item @emph{radius} is a number
@item @emph{filename} is a string
@end itemize

export a fragment of the map about (x,y,z) 

@end deffn

@node export-map-fragment-with-origin-shift
@subsection export-map-fragment-with-origin-shift
@deffn function export-map-fragment-with-origin-shift imol x y z radius filename

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{x} is a number
@item @emph{y} is a number
@item @emph{z} is a number
@item @emph{radius} is a number
@item @emph{filename} is a string
@end itemize

export a fragment of the map about (x,y,z) 

@end deffn

@node difference-map
@subsection difference-map
@deffn function difference-map imol1 imol2 map_scale

Where: 
@itemize @bullet
@item @emph{imol1} is an integer number
@item @emph{imol2} is an integer number
@item @emph{map_scale} is a number
@end itemize

make a difference map, taking map_scale * imap2 from imap1, on the grid of imap1. Return the new molecule number. Return -1 on failure. 

@end deffn

@node reinterp-map
@subsection reinterp-map
@deffn function reinterp-map map_no reference_map_no

Where: 
@itemize @bullet
@item @emph{map_no} is an integer number
@item @emph{reference_map_no} is an integer number
@end itemize

make a new map (a copy of map_no) that is in the cell, spacegroup and gridding of the map in reference_map_no. 

Return the new map molecule number - return -1 on failure 

@end deffn

@node smooth-map
@subsection smooth-map
@deffn function smooth-map map_no sampling_multiplier

Where: 
@itemize @bullet
@item @emph{map_no} is an integer number
@item @emph{sampling_multiplier} is a number
@end itemize

make a new map (a copy of map_no) that is in the cell, spacegroup and a multiple of the sampling of the input map (a sampling factor of more than 1 makes the output maps smoother) 

@end deffn

@node Density Increment
@section Density Increment

@menu
* set-iso-level-increment::
* set-diff-map-iso-level-increment::
* get-diff-map-iso-level-increment::
* set-diff-map-iso-level-increment-from-text::
* set-map-sampling-rate-text::
* set-map-sampling-rate::
* get-map-sampling-rate::
* change-contour-level::
* set-last-map-contour-level::
* set-last-map-contour-level-by-sigma::
* set-stop-scroll-diff-map::
* set-stop-scroll-iso-map::
* set-stop-scroll-iso-map-level::
* set-stop-scroll-diff-map-level::
* set-residue-density-fit-scale-factor::
@end menu

@node set-iso-level-increment
@subsection set-iso-level-increment
@deffn function set-iso-level-increment val

Where @emph{val} is a number

set the contour scroll step (in absolute e/A3) for 2Fo-Fc-style maps to val 

The is only activated when scrolling by sigma is turned off 

@end deffn

@node set-diff-map-iso-level-increment
@subsection set-diff-map-iso-level-increment
@deffn function set-diff-map-iso-level-increment val

Where @emph{val} is a number

set the contour scroll step for difference map (in absolute e/A3) to val 

The is only activated when scrolling by sigma is turned off 

@end deffn

@node get-diff-map-iso-level-increment
@subsection get-diff-map-iso-level-increment
@deffn function get-diff-map-iso-level-increment

return difference maps iso-map level increment 

@end deffn

@node set-diff-map-iso-level-increment-from-text
@subsection set-diff-map-iso-level-increment-from-text
@deffn function set-diff-map-iso-level-increment-from-text text imol

Where: 
@itemize @bullet
@item @emph{text} is a string
@item @emph{imol} is an integer number
@end itemize

set the difference maps iso-map level increment 

@end deffn

@node set-map-sampling-rate-text
@subsection set-map-sampling-rate-text
@deffn function set-map-sampling-rate-text text

Where @emph{text} is a string

sampling rate 

find the molecule for which the single map dialog applies and set the contour level and redraw 

@end deffn

@node set-map-sampling-rate
@subsection set-map-sampling-rate
@deffn function set-map-sampling-rate r

Where @emph{r} is a number

set the map sampling rate (default 1.5) 

Set to something like 2.0 or 2.5 for more finely sampled maps. Useful for baton-building low resolution maps. 

@end deffn

@node get-map-sampling-rate
@subsection get-map-sampling-rate
@deffn function get-map-sampling-rate

return the map sampling rate 

@end deffn

@node change-contour-level
@subsection change-contour-level
@deffn function change-contour-level is_increment

Where @emph{is_increment} is an integer number

change the contour level of the current map by a step 

if is_increment=1 the contour level is increased. If is_increment=0 the map contour level is decreased. 

@end deffn

@node set-last-map-contour-level
@subsection set-last-map-contour-level
@deffn function set-last-map-contour-level level

Where @emph{level} is a number

set the contour level of the map with the highest molecule number to level 

@end deffn

@node set-last-map-contour-level-by-sigma
@subsection set-last-map-contour-level-by-sigma
@deffn function set-last-map-contour-level-by-sigma n_sigma

Where @emph{n_sigma} is a number

set the contour level of the map with the highest molecule number to n_sigma sigma 

@end deffn

@node set-stop-scroll-diff-map
@subsection set-stop-scroll-diff-map
@deffn function set-stop-scroll-diff-map i

Where @emph{i} is an integer number

create a lower limit to the "Fo-Fc-style" map contour level changing 

(default 1 on) 

@end deffn

@node set-stop-scroll-iso-map
@subsection set-stop-scroll-iso-map
@deffn function set-stop-scroll-iso-map i

Where @emph{i} is an integer number

create a lower limit to the "2Fo-Fc-style" map contour level changing 

(default 1 on) 

@end deffn

@node set-stop-scroll-iso-map-level
@subsection set-stop-scroll-iso-map-level
@deffn function set-stop-scroll-iso-map-level f

Where @emph{f} is a number

set the actual map level changing limit 

(default 0.0) 

@end deffn

@node set-stop-scroll-diff-map-level
@subsection set-stop-scroll-diff-map-level
@deffn function set-stop-scroll-diff-map-level f

Where @emph{f} is a number

set the actual difference map level changing limit 

(default 0.0) 

@end deffn

@node set-residue-density-fit-scale-factor
@subsection set-residue-density-fit-scale-factor
@deffn function set-residue-density-fit-scale-factor f

Where @emph{f} is a number

set the scale factor for the Residue Density fit analysis 

@end deffn

@node Density Functions
@section Density Functions

@menu
* set-map-line-width::
* map-line-width-state::
* make-and-draw-map::
* make-and-draw-map-with-refmac-params::
* make-and-draw-map-with-reso-with-refmac-params::
* valid-labels::
* mtz-file-has-phases-p::
* is-mtz-file-p::
* cns-file-has-phases-p::
* auto-read-do-difference-map-too-state::
* set-auto-read-column-labels::
* set-map-radius::
* set-density-size::
* set-display-intro-string::
* get-map-radius::
* set-esoteric-depth-cue::
* esoteric-depth-cue-state::
* set-swap-difference-map-colours::
* set-map-is-difference-map::
* map-is-difference-map::
* another-level::
* another-level-from-map-molecule-number::
* residue-density-fit-scale-factor::
* density-at-point::
* density-score-residue::
@end menu

@node set-map-line-width
@subsection set-map-line-width
@deffn function set-map-line-width w

Where @emph{w} is an integer number

draw the lines of the chickenwire density in width w 

@end deffn

@node map-line-width-state
@subsection map-line-width-state
@deffn function map-line-width-state

return the width in which density contours are drawn 

@end deffn

@node make-and-draw-map
@subsection make-and-draw-map
@deffn function make-and-draw-map mtz_file_name f_col phi_col weight use_weights is_diff_map

Where: 
@itemize @bullet
@item @emph{mtz_file_name} is a string
@item @emph{f_col} is a string
@item @emph{phi_col} is a string
@item @emph{weight} is a string
@item @emph{use_weights} is an integer number
@item @emph{is_diff_map} is an integer number
@end itemize

make a map from an mtz file (simple interface) 

given mtz file mtz_file_name and F column f_col and phases column phi_col and optional weight column weight_col (pass use_weights=0 if weights are not to be used). Also mark the map as a difference map (is_diff_map=1) or not (is_diff_map=0) because they are handled differently inside coot.

Returns: -1 on error, else return the new molecule number 

@end deffn

@node make-and-draw-map-with-refmac-params
@subsection make-and-draw-map-with-refmac-params
@deffn function make-and-draw-map-with-refmac-params mtz_file_name a b weight use_weights is_diff_map have_refmac_params fobs_col sigfobs_col r_free_col sensible_f_free_col

Where: 
@itemize @bullet
@item @emph{mtz_file_name} is a string
@item @emph{a} is a string
@item @emph{b} is a string
@item @emph{weight} is a string
@item @emph{use_weights} is an integer number
@item @emph{is_diff_map} is an integer number
@item @emph{have_refmac_params} is an integer number
@item @emph{fobs_col} is a string
@item @emph{sigfobs_col} is a string
@item @emph{r_free_col} is a string
@item @emph{sensible_f_free_col} is an integer number
@end itemize

as the above function, execpt set refmac parameters too 

pass along the refmac column labels for storage (not used in the creation of the map)

Returns: -1 on error, else return imol 

@end deffn

@node make-and-draw-map-with-reso-with-refmac-params
@subsection make-and-draw-map-with-reso-with-refmac-params
@deffn function make-and-draw-map-with-reso-with-refmac-params mtz_file_name a b weight use_weights is_diff_map have_refmac_params fobs_col sigfobs_col r_free_col sensible_f_free_col is_anomalous use_reso_limits low_reso_limit high_reso_lim

Where: 
@itemize @bullet
@item @emph{mtz_file_name} is a string
@item @emph{a} is a string
@item @emph{b} is a string
@item @emph{weight} is a string
@item @emph{use_weights} is an integer number
@item @emph{is_diff_map} is an integer number
@item @emph{have_refmac_params} is an integer number
@item @emph{fobs_col} is a string
@item @emph{sigfobs_col} is a string
@item @emph{r_free_col} is a string
@item @emph{sensible_f_free_col} is an integer number
@item @emph{is_anomalous} is an integer number
@item @emph{use_reso_limits} is an integer number
@item @emph{low_reso_limit} is a number
@item @emph{high_reso_lim} is a number
@end itemize

as the above function, except set expert options too. 

@end deffn

@node valid-labels
@subsection valid-labels
@deffn function valid-labels mtz_file_name f_col phi_col weight_col use_weights

Where: 
@itemize @bullet
@item @emph{mtz_file_name} is a string
@item @emph{f_col} is a string
@item @emph{phi_col} is a string
@item @emph{weight_col} is a string
@item @emph{use_weights} is an integer number
@end itemize

does the mtz file have the columms that we want it to have? 

@end deffn

@node mtz-file-has-phases-p
@subsection mtz-file-has-phases-p
@deffn function mtz-file-has-phases-p mtz_file_name

Where @emph{mtz_file_name} is a string

does the mtz file have phases? 

@end deffn

@node is-mtz-file-p
@subsection is-mtz-file-p
@deffn function is-mtz-file-p filename

Where @emph{filename} is a string

is the given filename an mtz file? 

@end deffn

@node cns-file-has-phases-p
@subsection cns-file-has-phases-p
@deffn function cns-file-has-phases-p cns_file_name

Where @emph{cns_file_name} is a string

does the given file have cns phases? 

@end deffn

@node auto-read-do-difference-map-too-state
@subsection auto-read-do-difference-map-too-state
@deffn function auto-read-do-difference-map-too-state

return the flag to do a difference map (too) on auto-read MTZ 

Returns: 0 means no, 1 means yes. 

@end deffn

@node set-auto-read-column-labels
@subsection set-auto-read-column-labels
@deffn function set-auto-read-column-labels fwt phwt is_for_diff_map_flag

Where: 
@itemize @bullet
@item @emph{fwt} is a string
@item @emph{phwt} is a string
@item @emph{is_for_diff_map_flag} is an integer number
@end itemize

set the expected MTZ columns for Auto-reading MTZ file. 

Not every program uses the default refmac labels ("FWT"/"PHWT") for its MTZ file. Here we can tell coot to expect other labels so that coot can "Auto-open" such MTZ files.

e.g. (set-auto-read-column-labels "2FOFCWT" "PH2FOFCWT" 0) 

@end deffn

@node set-map-radius
@subsection set-map-radius
@deffn function set-map-radius f

Where @emph{f} is a number

set the extent of the box/radius of electron density contours 

@end deffn

@node set-density-size
@subsection set-density-size
@deffn function set-density-size f

Where @emph{f} is a number

another (old) way of setting the radius of the map 

@end deffn

@node set-display-intro-string
@subsection set-display-intro-string
@deffn function set-display-intro-string str

Where @emph{str} is a string

Give me this nice message str when I start coot. 

@end deffn

@node get-map-radius
@subsection get-map-radius
@deffn function get-map-radius

return the extent of the box/radius of electron density contours 

@end deffn

@node set-esoteric-depth-cue
@subsection set-esoteric-depth-cue
@deffn function set-esoteric-depth-cue istate

Where @emph{istate} is an integer number

not everone likes coot's esoteric depth cueing system 

Pass an argument istate=1 to turn it off

(this function is currently disabled). 

@end deffn

@node esoteric-depth-cue-state
@subsection esoteric-depth-cue-state
@deffn function esoteric-depth-cue-state

native depth cueing system 

return the state of the esoteric depth cueing flag 

@end deffn

@node set-swap-difference-map-colours
@subsection set-swap-difference-map-colours
@deffn function set-swap-difference-map-colours i

Where @emph{i} is an integer number

not everone likes coot's default difference map colouring. 

Pass an argument i=1 to swap the difference map colouring so that red is positive and green is negative. 

@end deffn

@node set-map-is-difference-map
@subsection set-map-is-difference-map
@deffn function set-map-is-difference-map imol

Where @emph{imol} is an integer number

post-hoc set the map of molecule number imol to be a difference map 

Returns: success status, 0 -> failure (imol does not have a map) 

@end deffn

@node map-is-difference-map
@subsection map-is-difference-map
@deffn function map-is-difference-map imol

Where @emph{imol} is an integer number

map is difference map? 

@end deffn

@node another-level
@subsection another-level
@deffn function another-level

Add another contour level for the last added map. 

Currently, the map must have been generated from an MTZ file. 

Returns: the molecule number of the new molecule or -1 on failure 

@end deffn

@node another-level-from-map-molecule-number
@subsection another-level-from-map-molecule-number
@deffn function another-level-from-map-molecule-number imap

Where @emph{imap} is an integer number

Add another contour level for the given map. 

Currently, the map must have been generated from an MTZ file. 

Returns: the molecule number of the new molecule or -1 on failure 

@end deffn

@node residue-density-fit-scale-factor
@subsection residue-density-fit-scale-factor
@deffn function residue-density-fit-scale-factor

return the scale factor for the Residue Density fit analysis 

@end deffn

@node density-at-point
@subsection density-at-point
@deffn function density-at-point imol_map x y z

Where: 
@itemize @bullet
@item @emph{imol_map} is an integer number
@item @emph{x} is a number
@item @emph{y} is a number
@item @emph{z} is a number
@end itemize

return the density at the given point for the given map. Return 0 for bad imol 

@end deffn

@node density-score-residue
@subsection density-score-residue
@deffn function density-score-residue imol chain_id res_no ins_code imol_map

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{res_no} is an integer number
@item @emph{ins_code} is a string
@item @emph{imol_map} is an integer number
@end itemize

simple density score for given residue (over-ridden by scripting function) 

@end deffn

@node Parameters from map
@section Parameters from map

@menu
* mtz-hklin-for-map::
* mtz-fp-for-map::
* mtz-phi-for-map::
* mtz-weight-for-map::
* mtz-use-weight-for-map::
@end menu

@node mtz-hklin-for-map
@subsection mtz-hklin-for-map
@deffn function mtz-hklin-for-map imol_map

Where @emph{imol_map} is an integer number

return the mtz file that was use to generate the map 

return 0 when there is no mtz file associated with that map (it was generated from a CCP4 map file say). 

@end deffn

@node mtz-fp-for-map
@subsection mtz-fp-for-map
@deffn function mtz-fp-for-map imol_map

Where @emph{imol_map} is an integer number

return the FP column in the file that was use to generate the map 

return 0 when there is no mtz file associated with that map (it was generated from a CCP4 map file say).

Caller should dispose of returned pointer. 

@end deffn

@node mtz-phi-for-map
@subsection mtz-phi-for-map
@deffn function mtz-phi-for-map imol_map

Where @emph{imol_map} is an integer number

return the phases column in mtz file that was use to generate the map 

return 0 when there is no mtz file associated with that map (it was generated from a CCP4 map file say). Caller should dispose of returned pointer. 

@end deffn

@node mtz-weight-for-map
@subsection mtz-weight-for-map
@deffn function mtz-weight-for-map imol_map

Where @emph{imol_map} is an integer number

return the weight column in the mtz file that was use to generate the map 

return 0 when there is no mtz file associated with that map (it was generated from a CCP4 map file say) or no weights were used. Caller should dispose of returned pointer. 

@end deffn

@node mtz-use-weight-for-map
@subsection mtz-use-weight-for-map
@deffn function mtz-use-weight-for-map imol_map

Where @emph{imol_map} is an integer number

return flag for whether weights were used that was use to generate the map 

return 0 when no weights were used or there is no mtz file associated with that map. 

@end deffn

@node PDB Functions
@section PDB Functions

@menu
* write-pdb-file::
* write-residue-range-to-pdb-file::
* quick-save::
@end menu

@node write-pdb-file
@subsection write-pdb-file
@deffn function write-pdb-file imol file_name

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{file_name} is a string
@end itemize

write molecule number imol as a PDB to file file_name 

@end deffn

@node write-residue-range-to-pdb-file
@subsection write-residue-range-to-pdb-file
@deffn function write-residue-range-to-pdb-file imol chainid resno_start resno_end filename

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chainid} is a string
@item @emph{resno_start} is an integer number
@item @emph{resno_end} is an integer number
@item @emph{filename} is a string
@end itemize

write molecule number imol's residue range as a PDB to file file_name 

@end deffn

@node quick-save
@subsection quick-save
@deffn function quick-save

save all modified coordinates molecules to the default names and save the state too. 

@end deffn

@node Refmac Functions
@section Refmac Functions

@menu
* set-refmac-counter::
* refmac-name::
* swap-map-colours::
* set-keep-map-colour-after-refmac::
* keep-map-colour-after-refmac-state::
@end menu

@node set-refmac-counter
@subsection set-refmac-counter
@deffn function set-refmac-counter imol refmac_count

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{refmac_count} is an integer number
@end itemize

set counter for runs of refmac so that this can be used to construct a unique filename for new output 

@end deffn

@node refmac-name
@subsection refmac-name
@deffn function refmac-name imol

Where @emph{imol} is an integer number

the name for refmac 

Returns: a stub name used in the construction of filename for refmac output 

@end deffn

@node swap-map-colours
@subsection swap-map-colours
@deffn function swap-map-colours imol1 imol2

Where: 
@itemize @bullet
@item @emph{imol1} is an integer number
@item @emph{imol2} is an integer number
@end itemize

swap the colours of maps 

swap the colour of maps imol1 and imol2. Useful to some after running refmac, so that the map to be build into is always the same colour 

@end deffn

@node set-keep-map-colour-after-refmac
@subsection set-keep-map-colour-after-refmac
@deffn function set-keep-map-colour-after-refmac istate

Where @emph{istate} is an integer number

flag to enable above 

call this with istate=1 

@end deffn

@node keep-map-colour-after-refmac-state
@subsection keep-map-colour-after-refmac-state
@deffn function keep-map-colour-after-refmac-state

the keep-map-colour-after-refmac internal state 

Returns: 1 for "yes", 0 for "no" 

@end deffn

@node Symmetry Functions
@section Symmetry Functions

@menu
* set-symmetry-size::
* get-show-symmetry::
* set-show-symmetry-master::
* set-show-symmetry-molecule::
* symmetry-as-calphas::
* get-symmetry-as-calphas-state::
* set-symmetry-molecule-rotate-colour-map::
* symmetry-molecule-rotate-colour-map-state::
* set-symmetry-colour-by-symop::
* set-symmetry-whole-chain::
* set-symmetry-atom-labels-expanded::
* has-unit-cell-state::
* undo-symmetry-view::
* first-molecule-with-symmetry-displayed::
* save-symmetry-coords::
* new-molecule-by-symmetry::
* new-molecule-by-symmetry-with-atom-selection::
* new-molecule-by-symop::
* n-symops::
* set-space-group::
* set-symmetry-shift-search-size::
@end menu

@node set-symmetry-size
@subsection set-symmetry-size
@deffn function set-symmetry-size f

Where @emph{f} is a number

set the size of the displayed symmetry 

@end deffn

@node get-show-symmetry
@subsection get-show-symmetry
@deffn function get-show-symmetry

is symmetry master display control on? 

@end deffn

@node set-show-symmetry-master
@subsection set-show-symmetry-master
@deffn function set-show-symmetry-master state

Where @emph{state} is an integer number

set display symmetry, master controller 

@end deffn

@node set-show-symmetry-molecule
@subsection set-show-symmetry-molecule
@deffn function set-show-symmetry-molecule mol_no state

Where: 
@itemize @bullet
@item @emph{mol_no} is an integer number
@item @emph{state} is an integer number
@end itemize

set display symmetry for molecule number mol_no 

pass with state=0 for off, state=1 for on 

@end deffn

@node symmetry-as-calphas
@subsection symmetry-as-calphas
@deffn function symmetry-as-calphas mol_no state

Where: 
@itemize @bullet
@item @emph{mol_no} is an integer number
@item @emph{state} is an integer number
@end itemize

display symmetry as CAs? 

pass with state=0 for off, state=1 for on 

@end deffn

@node get-symmetry-as-calphas-state
@subsection get-symmetry-as-calphas-state
@deffn function get-symmetry-as-calphas-state imol

Where @emph{imol} is an integer number

what is state of display CAs for molecule number mol_no? 

return state=0 for off, state=1 for on 

@end deffn

@node set-symmetry-molecule-rotate-colour-map
@subsection set-symmetry-molecule-rotate-colour-map
@deffn function set-symmetry-molecule-rotate-colour-map imol state

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{state} is an integer number
@end itemize

set the colour map rotation (i.e. the hue) for the symmetry atoms of molecule number imol 

@end deffn

@node symmetry-molecule-rotate-colour-map-state
@subsection symmetry-molecule-rotate-colour-map-state
@deffn function symmetry-molecule-rotate-colour-map-state imol

Where @emph{imol} is an integer number

should there be colour map rotation (i.e. the hue) change for the symmetry atoms of molecule number imol? 

return state=0 for off, state=1 for on 

@end deffn

@node set-symmetry-colour-by-symop
@subsection set-symmetry-colour-by-symop
@deffn function set-symmetry-colour-by-symop imol state

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{state} is an integer number
@end itemize

set symmetry colour by symop mode 

@end deffn

@node set-symmetry-whole-chain
@subsection set-symmetry-whole-chain
@deffn function set-symmetry-whole-chain imol state

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{state} is an integer number
@end itemize

set symmetry colour for the chain 

@end deffn

@node set-symmetry-atom-labels-expanded
@subsection set-symmetry-atom-labels-expanded
@deffn function set-symmetry-atom-labels-expanded state

Where @emph{state} is an integer number

set use expanded symmetry atom labels 

@end deffn

@node has-unit-cell-state
@subsection has-unit-cell-state
@deffn function has-unit-cell-state imol

Where @emph{imol} is an integer number

molecule number imol has a unit cell? 

Returns: 1 on "yes, it has a cell", 0 for "no" 

@end deffn

@node undo-symmetry-view
@subsection undo-symmetry-view
@deffn function undo-symmetry-view

Undo symmetry view. Translate back to main molecule from this symmetry position. 

@end deffn

@node first-molecule-with-symmetry-displayed
@subsection first-molecule-with-symmetry-displayed
@deffn function first-molecule-with-symmetry-displayed

return the molecule number. 

Returns: -1 if there is no molecule with symmetry displayed. 

@end deffn

@node save-symmetry-coords
@subsection save-symmetry-coords
@deffn function save-symmetry-coords imol filename symop_no shift_a shift_b shift_c pre_shift_to_origin_na pre_shift_to_origin_nb pre_shift_to_origin_nc

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{filename} is a string
@item @emph{symop_no} is an integer number
@item @emph{shift_a} is an integer number
@item @emph{shift_b} is an integer number
@item @emph{shift_c} is an integer number
@item @emph{pre_shift_to_origin_na} is an integer number
@item @emph{pre_shift_to_origin_nb} is an integer number
@item @emph{pre_shift_to_origin_nc} is an integer number
@end itemize

save the symmetry coordinates of molecule number imol to filename 

Allow a shift of the coordinates to the origin before symmetry expansion is apllied (this is how symmetry works in Coot internals). 

@end deffn

@node new-molecule-by-symmetry
@subsection new-molecule-by-symmetry
@deffn function new-molecule-by-symmetry imol name m11 m12 m13 m21 m22 m23 m31 m32 m33 tx ty tz pre_shift_to_origin_na pre_shift_to_origin_nb pre_shift_to_origin_nc

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{name} is a string
@item @emph{m11} is a number
@item @emph{m12} is a number
@item @emph{m13} is a number
@item @emph{m21} is a number
@item @emph{m22} is a number
@item @emph{m23} is a number
@item @emph{m31} is a number
@item @emph{m32} is a number
@item @emph{m33} is a number
@item @emph{tx} is a number
@item @emph{ty} is a number
@item @emph{tz} is a number
@item @emph{pre_shift_to_origin_na} is an integer number
@item @emph{pre_shift_to_origin_nb} is an integer number
@item @emph{pre_shift_to_origin_nc} is an integer number
@end itemize

create a new molecule (molecule number is the return value) from imol. 

The rotation/translation matrix components are given in 

 coordinates.

Allow a shift of the coordinates to the origin before symmetry expansion is aplied.

Pass "" as the name-in and a name will be constructed for you.

Return -1 on failure. 

@end deffn

@node new-molecule-by-symmetry-with-atom-selection
@subsection new-molecule-by-symmetry-with-atom-selection
@deffn function new-molecule-by-symmetry-with-atom-selection imol name mmdb_atom_selection_string m11 m12 m13 m21 m22 m23 m31 m32 m33 tx ty tz pre_shift_to_origin_na pre_shift_to_origin_nb pre_shift_to_origin_nc

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{name} is a string
@item @emph{mmdb_atom_selection_string} is a string
@item @emph{m11} is a number
@item @emph{m12} is a number
@item @emph{m13} is a number
@item @emph{m21} is a number
@item @emph{m22} is a number
@item @emph{m23} is a number
@item @emph{m31} is a number
@item @emph{m32} is a number
@item @emph{m33} is a number
@item @emph{tx} is a number
@item @emph{ty} is a number
@item @emph{tz} is a number
@item @emph{pre_shift_to_origin_na} is an integer number
@item @emph{pre_shift_to_origin_nb} is an integer number
@item @emph{pre_shift_to_origin_nc} is an integer number
@end itemize

create a new molecule (molecule number is the return value) from imol, but only for atom that match the mmdb_atom_selection_string. 

The rotation/translation matrix components are given in 

 coordinates.

Allow a shift of the coordinates to the origin before symmetry expansion is aplied.

Pass "" as the name-in and a name will be constructed for you.

Return -1 on failure. 

@end deffn

@node new-molecule-by-symop
@subsection new-molecule-by-symop
@deffn function new-molecule-by-symop imol symop_string pre_shift_to_origin_na pre_shift_to_origin_nb pre_shift_to_origin_nc

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{symop_string} is a string
@item @emph{pre_shift_to_origin_na} is an integer number
@item @emph{pre_shift_to_origin_nb} is an integer number
@item @emph{pre_shift_to_origin_nc} is an integer number
@end itemize

create a new molecule (molecule number is the return value) from imol. 

@end deffn

@node n-symops
@subsection n-symops
@deffn function n-symops imol

Where @emph{imol} is an integer number

return the number of symmetry operators for the given molecule 

return -1 on no-symmetry for molecule or inappropriate imol number 

@end deffn

@node set-space-group
@subsection set-space-group
@deffn function set-space-group imol spg

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{spg} is a string
@end itemize

set the space group for a coordinates molecule 

for shelx FA pdb files, there is no space group. So allow the user to set it. This can be initted with a HM symbol or a symm list for clipper. Return the succes status of the setting. 

@end deffn

@node set-symmetry-shift-search-size
@subsection set-symmetry-shift-search-size
@deffn function set-symmetry-shift-search-size shift

Where @emph{shift} is an integer number

set the cell shift search size for symmetry searching. 

When the coordinates for one (or some) symmetry operator are missing (which happens sometimes, but rarely), try changing setting this to 2 (default is 1). It slows symmetry searching, which is why it is not set to 2 by default. 

@end deffn

@node History Functions
@section History Functions

@menu
* print-all-history-in-scheme::
* print-all-history-in-python::
* set-console-display-commands-state::
* set-console-display-commands-hilights::
@end menu

@node print-all-history-in-scheme
@subsection print-all-history-in-scheme
@deffn function print-all-history-in-scheme

print the history in scheme format 

@end deffn

@node print-all-history-in-python
@subsection print-all-history-in-python
@deffn function print-all-history-in-python

print the history in python format 

@end deffn

@node set-console-display-commands-state
@subsection set-console-display-commands-state
@deffn function set-console-display-commands-state istate

Where @emph{istate} is an integer number

set a flag to show the text command equivalent of gui commands in the console as they happen. 

1 for on, 0 for off. 

@end deffn

@node set-console-display-commands-hilights
@subsection set-console-display-commands-hilights
@deffn function set-console-display-commands-hilights bold_flag colour_flag colour_index

Where: 
@itemize @bullet
@item @emph{bold_flag} is an integer number
@item @emph{colour_flag} is an integer number
@item @emph{colour_index} is an integer number
@end itemize

set a flag to show the text command equivalent of gui commands in the console as they happen in bold and colours. 

colour_flag: pass 1 for on, 0 for off.

colour_index 0 to 7 inclusive for various different colourings. 

@end deffn

@node State Functions
@section State Functions

@menu
* save-state::
* save-state-file::
* save-state-file-py::
* set-save-state-file-name::
* set-run-state-file-status::
* run-state-file::
* run-state-file-maybe::
@end menu

@node save-state
@subsection save-state
@deffn function save-state

save the current state to the default filename 

@end deffn

@node save-state-file
@subsection save-state-file
@deffn function save-state-file filename

Where @emph{filename} is a string

save the current state to file filename 

@end deffn

@node save-state-file-py
@subsection save-state-file-py
@deffn function save-state-file-py filename

Where @emph{filename} is a string

save the current state to file filename 

@end deffn

@node set-save-state-file-name
@subsection set-save-state-file-name
@deffn function set-save-state-file-name filename

Where @emph{filename} is a string

set the default state file name (default 0-coot.state.scm) 

@end deffn

@node set-run-state-file-status
@subsection set-run-state-file-status
@deffn function set-run-state-file-status istat

Where @emph{istat} is an integer number

set run state file status 

0: never run it 1: ask to run it 2: run it, no questions 

@end deffn

@node run-state-file
@subsection run-state-file
@deffn function run-state-file

run the state file (reading from default filenname) 

@end deffn

@node run-state-file-maybe
@subsection run-state-file-maybe
@deffn function run-state-file-maybe

run the state file depending on the state variables 

@end deffn

@node The Virtual Trackball
@section The Virtual Trackball

@menu
* vt-surface::
* vt-surface-status::
@end menu

@node vt-surface
@subsection vt-surface
@deffn function vt-surface mode

Where @emph{mode} is an integer number

How should the mouse move the view? 

mode=1 for "Flat", mode=2 for "Spherical Surface" 

@end deffn

@node vt-surface-status
@subsection vt-surface-status
@deffn function vt-surface-status

return the mouse view status mode 

mode=1 for "Flat", mode=2 for "Spherical Surface" 

@end deffn

@node Clipping Functions
@section Clipping Functions

@menu
* set-clipping-back::
* set-clipping-front::
@end menu

@node set-clipping-back
@subsection set-clipping-back
@deffn function set-clipping-back v

Where @emph{v} is a number

set clipping plane back 

@end deffn

@node set-clipping-front
@subsection set-clipping-front
@deffn function set-clipping-front v

Where @emph{v} is a number

set clipping plane front 

@end deffn

@node Unit Cell interface
@section Unit Cell interface

@menu
* get-show-unit-cell::
* set-show-unit-cells-all::
* set-show-unit-cell::
@end menu

@node get-show-unit-cell
@subsection get-show-unit-cell
@deffn function get-show-unit-cell imol

Where @emph{imol} is an integer number

return the stage of show unit cell for molecule number imol 

@end deffn

@node set-show-unit-cells-all
@subsection set-show-unit-cells-all
@deffn function set-show-unit-cells-all istate

Where @emph{istate} is an integer number

set the state of show unit cell for all molecules 

1 for displayed 0 for undisplayed 

@end deffn

@node set-show-unit-cell
@subsection set-show-unit-cell
@deffn function set-show-unit-cell imol istate

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{istate} is an integer number
@end itemize

set the state of show unit cell for the particular molecule number imol 

1 for displayed 0 for undisplayed 

@end deffn

@node Colour
@section Colour

@menu
* set-colour-map-rotation-on-read-pdb::
* set-colour-map-rotation-on-read-pdb-flag::
* set-colour-map-rotation-on-read-pdb-c-only-flag::
* set-colour-by-chain::
* set-colour-by-molecule::
* set-symmetry-colour::
@end menu

@node set-colour-map-rotation-on-read-pdb
@subsection set-colour-map-rotation-on-read-pdb
@deffn function set-colour-map-rotation-on-read-pdb f

Where @emph{f} is a number

set the hue change step on reading a new molecule 

@end deffn

@node set-colour-map-rotation-on-read-pdb-flag
@subsection set-colour-map-rotation-on-read-pdb-flag
@deffn function set-colour-map-rotation-on-read-pdb-flag i

Where @emph{i} is an integer number

shall the hue change step be used? 

@end deffn

@node set-colour-map-rotation-on-read-pdb-c-only-flag
@subsection set-colour-map-rotation-on-read-pdb-c-only-flag
@deffn function set-colour-map-rotation-on-read-pdb-c-only-flag i

Where @emph{i} is an integer number

shall the colour map rotation apply only to C atoms? 

@end deffn

@node set-colour-by-chain
@subsection set-colour-by-chain
@deffn function set-colour-by-chain imol

Where @emph{imol} is an integer number

colour molecule number imol by chain type 

@end deffn

@node set-colour-by-molecule
@subsection set-colour-by-molecule
@deffn function set-colour-by-molecule imol

Where @emph{imol} is an integer number

colour molecule number imol by molecule 

@end deffn

@node set-symmetry-colour
@subsection set-symmetry-colour
@deffn function set-symmetry-colour r g b

Where: 
@itemize @bullet
@item @emph{r} is a number
@item @emph{g} is a number
@item @emph{b} is a number
@end itemize

set the symmetry colour base 

@end deffn

@node Map colour
@section Map colour

@menu
* set-colour-map-rotation-for-map::
* set-molecule-bonds-colour-map-rotation::
* get-molecule-bonds-colour-map-rotation::
@end menu

@node set-colour-map-rotation-for-map
@subsection set-colour-map-rotation-for-map
@deffn function set-colour-map-rotation-for-map f

Where @emph{f} is a number

set the colour map rotation (hue change) for maps 

default: for maps is 14 degrees. 

@end deffn

@node set-molecule-bonds-colour-map-rotation
@subsection set-molecule-bonds-colour-map-rotation
@deffn function set-molecule-bonds-colour-map-rotation imol theta

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{theta} is a number
@end itemize

set the colour map rotation for molecule number imol 

theta is in degrees 

@end deffn

@node get-molecule-bonds-colour-map-rotation
@subsection get-molecule-bonds-colour-map-rotation
@deffn function get-molecule-bonds-colour-map-rotation imol

Where @emph{imol} is an integer number

Get the colour map rotation for molecule number imol. 

@end deffn

@node Anisotropic Atoms Interface
@section Anisotropic Atoms Interface

@menu
* get-limit-aniso::
* get-show-limit-aniso::
* get-show-aniso::
* set-limit-aniso::
* set-show-aniso::
* set-aniso-probability::
* get-aniso-probability::
@end menu

@node get-limit-aniso
@subsection get-limit-aniso
@deffn function get-limit-aniso

get the aniso radius limit 

@end deffn

@node get-show-limit-aniso
@subsection get-show-limit-aniso
@deffn function get-show-limit-aniso

get show the aniso limit 

@end deffn

@node get-show-aniso
@subsection get-show-aniso
@deffn function get-show-aniso

return show-aniso-atoms state 

@end deffn

@node set-limit-aniso
@subsection set-limit-aniso
@deffn function set-limit-aniso state

Where @emph{state} is an integer number

set the aniso atom limit 

@end deffn

@node set-show-aniso
@subsection set-show-aniso
@deffn function set-show-aniso state

Where @emph{state} is an integer number

set show aniso atoms 

@end deffn

@node set-aniso-probability
@subsection set-aniso-probability
@deffn function set-aniso-probability f

Where @emph{f} is a number

set aniso probability 

@end deffn

@node get-aniso-probability
@subsection get-aniso-probability
@deffn function get-aniso-probability

get aniso probability 

@end deffn

@node Display Functions
@section Display Functions

@menu
* set-graphics-window-size::
* set-graphics-window-position::
* store-graphics-window-position::
* graphics-draw::
* zalman-stereo-mode::
* hardware-stereo-mode::
* stereo-mode-state::
* mono-mode::
* side-by-side-stereo-mode::
* set-hardware-stereo-angle-factor::
* hardware-stereo-angle-factor-state::
* set-model-fit-refine-dialog-position::
* set-display-control-dialog-position::
* set-go-to-atom-window-position::
* set-delete-dialog-position::
* set-rotate-translate-dialog-position::
* set-accept-reject-dialog-position::
* set-ramachandran-plot-dialog-position::
* set-edit-chi-angles-dialog-position::
* set-rotamer-selection-dialog-position::
@end menu

@node set-graphics-window-size
@subsection set-graphics-window-size
@deffn function set-graphics-window-size x_size y_size

Where: 
@itemize @bullet
@item @emph{x_size} is an integer number
@item @emph{y_size} is an integer number
@end itemize

set the window size 

@end deffn

@node set-graphics-window-position
@subsection set-graphics-window-position
@deffn function set-graphics-window-position x_pos y_pos

Where: 
@itemize @bullet
@item @emph{x_pos} is an integer number
@item @emph{y_pos} is an integer number
@end itemize

set the graphics window position 

@end deffn

@node store-graphics-window-position
@subsection store-graphics-window-position
@deffn function store-graphics-window-position x_pos y_pos

Where: 
@itemize @bullet
@item @emph{x_pos} is an integer number
@item @emph{y_pos} is an integer number
@end itemize

store the graphics window position 

@end deffn

@node graphics-draw
@subsection graphics-draw
@deffn function graphics-draw

draw a frame 

@end deffn

@node zalman-stereo-mode
@subsection zalman-stereo-mode
@deffn function zalman-stereo-mode

try to turn on Zalman stereo mode 

@end deffn

@node hardware-stereo-mode
@subsection hardware-stereo-mode
@deffn function hardware-stereo-mode

try to turn on stereo mode 

@end deffn

@node stereo-mode-state
@subsection stereo-mode-state
@deffn function stereo-mode-state

what is the stero state? 

Returns: 1 for in hardware stereo, 2 for side by side stereo, else return 0. 

@end deffn

@node mono-mode
@subsection mono-mode
@deffn function mono-mode

try to turn on mono mode 

@end deffn

@node side-by-side-stereo-mode
@subsection side-by-side-stereo-mode
@deffn function side-by-side-stereo-mode use_wall_eye_mode

Where @emph{use_wall_eye_mode} is an integer number

turn on side bye side stereo mode 

@end deffn

@node set-hardware-stereo-angle-factor
@subsection set-hardware-stereo-angle-factor
@deffn function set-hardware-stereo-angle-factor f

Where @emph{f} is a number

how much should the eyes be separated in stereo mode? 

@end deffn

@node hardware-stereo-angle-factor-state
@subsection hardware-stereo-angle-factor-state
@deffn function hardware-stereo-angle-factor-state

return the hardware stereo angle factor 

@end deffn

@node set-model-fit-refine-dialog-position
@subsection set-model-fit-refine-dialog-position
@deffn function set-model-fit-refine-dialog-position x_pos y_pos

Where: 
@itemize @bullet
@item @emph{x_pos} is an integer number
@item @emph{y_pos} is an integer number
@end itemize

set position of Model/Fit/Refine dialog 

@end deffn

@node set-display-control-dialog-position
@subsection set-display-control-dialog-position
@deffn function set-display-control-dialog-position x_pos y_pos

Where: 
@itemize @bullet
@item @emph{x_pos} is an integer number
@item @emph{y_pos} is an integer number
@end itemize

set position of Display Control dialog 

@end deffn

@node set-go-to-atom-window-position
@subsection set-go-to-atom-window-position
@deffn function set-go-to-atom-window-position x_pos y_pos

Where: 
@itemize @bullet
@item @emph{x_pos} is an integer number
@item @emph{y_pos} is an integer number
@end itemize

set position of Go To Atom dialog 

@end deffn

@node set-delete-dialog-position
@subsection set-delete-dialog-position
@deffn function set-delete-dialog-position x_pos y_pos

Where: 
@itemize @bullet
@item @emph{x_pos} is an integer number
@item @emph{y_pos} is an integer number
@end itemize

set position of Delete dialog 

@end deffn

@node set-rotate-translate-dialog-position
@subsection set-rotate-translate-dialog-position
@deffn function set-rotate-translate-dialog-position x_pos y_pos

Where: 
@itemize @bullet
@item @emph{x_pos} is an integer number
@item @emph{y_pos} is an integer number
@end itemize

set position of the Rotate/Translate Residue Range dialog 

@end deffn

@node set-accept-reject-dialog-position
@subsection set-accept-reject-dialog-position
@deffn function set-accept-reject-dialog-position x_pos y_pos

Where: 
@itemize @bullet
@item @emph{x_pos} is an integer number
@item @emph{y_pos} is an integer number
@end itemize

set position of the Accept/Reject dialog 

@end deffn

@node set-ramachandran-plot-dialog-position
@subsection set-ramachandran-plot-dialog-position
@deffn function set-ramachandran-plot-dialog-position x_pos y_pos

Where: 
@itemize @bullet
@item @emph{x_pos} is an integer number
@item @emph{y_pos} is an integer number
@end itemize

set position of the Ramachadran Plot dialog 

@end deffn

@node set-edit-chi-angles-dialog-position
@subsection set-edit-chi-angles-dialog-position
@deffn function set-edit-chi-angles-dialog-position x_pos y_pos

Where: 
@itemize @bullet
@item @emph{x_pos} is an integer number
@item @emph{y_pos} is an integer number
@end itemize

set edit chi angles dialog position 

@end deffn

@node set-rotamer-selection-dialog-position
@subsection set-rotamer-selection-dialog-position
@deffn function set-rotamer-selection-dialog-position x_pos y_pos

Where: 
@itemize @bullet
@item @emph{x_pos} is an integer number
@item @emph{y_pos} is an integer number
@end itemize

set rotamer selection dialog position 

@end deffn

@node Smooth Scrolling
@section Smooth Scrolling

@menu
* set-smooth-scroll-flag::
* get-smooth-scroll::
* set-smooth-scroll-steps::
* set-smooth-scroll-limit::
@end menu

@node set-smooth-scroll-flag
@subsection set-smooth-scroll-flag
@deffn function set-smooth-scroll-flag v

Where @emph{v} is an integer number

set smooth scrolling 

@end deffn

@node get-smooth-scroll
@subsection get-smooth-scroll
@deffn function get-smooth-scroll

return the smooth scrolling state 

@end deffn

@node set-smooth-scroll-steps
@subsection set-smooth-scroll-steps
@deffn function set-smooth-scroll-steps i

Where @emph{i} is an integer number

set the number of steps in the smooth scroll 

Set more steps (e.g. 50) for more smoothness (default 10). 

@end deffn

@node set-smooth-scroll-limit
@subsection set-smooth-scroll-limit
@deffn function set-smooth-scroll-limit lim

Where @emph{lim} is a number

do not scroll for distances greater this limit 

@end deffn

@node Font Parameters
@section Font Parameters

@menu
* set-font-size::
* get-font-size::
* set-font-colour::
* set-use-stroke-characters::
@end menu

@node set-font-size
@subsection set-font-size
@deffn function set-font-size i

Where @emph{i} is an integer number

set the font size 

@end deffn

@node get-font-size
@subsection get-font-size
@deffn function get-font-size

return the font size 

Returns: 1 (small) 2 (medium, default) 3 (large) 

@end deffn

@node set-font-colour
@subsection set-font-colour
@deffn function set-font-colour red green blue

Where: 
@itemize @bullet
@item @emph{red} is a number
@item @emph{green} is a number
@item @emph{blue} is a number
@end itemize

set the colour of the atom label font - the arguments are in the range 0->1 

@end deffn

@node set-use-stroke-characters
@subsection set-use-stroke-characters
@deffn function set-use-stroke-characters state

Where @emph{state} is an integer number

set use stroke characters 

@end deffn

@node Rotation Centre
@section Rotation Centre

@menu
* set-rotation-centre-size::
* recentre-on-read-pdb::
* set-recentre-on-read-pdb::
* set-rotation-centre::
* go-to-ligand::
* set-go-to-ligand-n-atoms-limit::
@end menu

@node set-rotation-centre-size
@subsection set-rotation-centre-size
@deffn function set-rotation-centre-size f

Where @emph{f} is a number

set rotoation centre marker size 

@end deffn

@node recentre-on-read-pdb
@subsection recentre-on-read-pdb
@deffn function recentre-on-read-pdb

return the recentre-on-pdb state 

@end deffn

@node set-recentre-on-read-pdb
@subsection set-recentre-on-read-pdb
@deffn function set-recentre-on-read-pdb int

Where @emph{int} is a short

set the recentre-on-pdb state 

@end deffn

@node set-rotation-centre
@subsection set-rotation-centre
@deffn function set-rotation-centre x y z

Where: 
@itemize @bullet
@item @emph{x} is a number
@item @emph{y} is a number
@item @emph{z} is a number
@end itemize

set the rotation centre 

@end deffn

@node go-to-ligand
@subsection go-to-ligand
@deffn function go-to-ligand

centre on the ligand of the "active molecule", if we are already there, centre on the next hetgroup (etc) 

@end deffn

@node set-go-to-ligand-n-atoms-limit
@subsection set-go-to-ligand-n-atoms-limit
@deffn function set-go-to-ligand-n-atoms-limit n_atom_min

Where @emph{n_atom_min} is an integer number

go to the ligand that has more than n_atom_min atoms 

@end deffn

@node Atom Selection Utilities
@section Atom Selection Utilities

@menu
* median-temperature-factor::
* average-temperature-factor::
* standard-deviation-temperature-factor::
* clear-pending-picks::
* set-default-temperature-factor-for-new-atoms::
* default-new-atoms-b-factor::
* set-reset-b-factor-moved-atoms::
* get-reset-b-factor-moved-atoms-state::
* set-atom-attribute::
* set-atom-string-attribute::
* set-residue-name::
@end menu

@node median-temperature-factor
@subsection median-temperature-factor
@deffn function median-temperature-factor imol

Where @emph{imol} is an integer number

return the median temperature factor for imol 

@end deffn

@node average-temperature-factor
@subsection average-temperature-factor
@deffn function average-temperature-factor imol

Where @emph{imol} is an integer number

return the average temperature factor for the atoms in imol 

@end deffn

@node standard-deviation-temperature-factor
@subsection standard-deviation-temperature-factor
@deffn function standard-deviation-temperature-factor imol

Where @emph{imol} is an integer number

return the standard deviation of the atom temperature factors for imol 

@end deffn

@node clear-pending-picks
@subsection clear-pending-picks
@deffn function clear-pending-picks

clear pending picks (stop coot thinking that the user is about to pick an atom). 

@end deffn

@node set-default-temperature-factor-for-new-atoms
@subsection set-default-temperature-factor-for-new-atoms
@deffn function set-default-temperature-factor-for-new-atoms new_b

Where @emph{new_b} is a number

set the default temperature factor for newly created atoms (initial default 20) 

@end deffn

@node default-new-atoms-b-factor
@subsection default-new-atoms-b-factor
@deffn function default-new-atoms-b-factor

return the default temperature factor for newly created atoms 

@end deffn

@node set-reset-b-factor-moved-atoms
@subsection set-reset-b-factor-moved-atoms
@deffn function set-reset-b-factor-moved-atoms state

Where @emph{state} is an integer number

reset temperature factor for all moved atoms to the default for new atoms (usually 30) 

@end deffn

@node get-reset-b-factor-moved-atoms-state
@subsection get-reset-b-factor-moved-atoms-state
@deffn function get-reset-b-factor-moved-atoms-state

return the state if temperature factors shoudl be reset for moved atoms 

@end deffn

@node set-atom-attribute
@subsection set-atom-attribute
@deffn function set-atom-attribute imol chain_id resno ins_code atom_name alt_conf attribute_name val

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{ins_code} is a string
@item @emph{atom_name} is a string
@item @emph{alt_conf} is a string
@item @emph{attribute_name} is a string
@item @emph{val} is a number
@end itemize

set a numberical attibute to the atom with the given specifier. 

Attributes can be "x", "y","z", "B", "occ" and the attribute val is a floating point number 

@end deffn

@node set-atom-string-attribute
@subsection set-atom-string-attribute
@deffn function set-atom-string-attribute imol chain_id resno ins_code atom_name alt_conf attribute_name attribute_value

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{ins_code} is a string
@item @emph{atom_name} is a string
@item @emph{alt_conf} is a string
@item @emph{attribute_name} is a string
@item @emph{attribute_value} is a string
@end itemize

set a string attibute to the atom with the given specifier. 

Attributes can be "atom-name", "alt-conf", "element" or "segid". 

@end deffn

@node set-residue-name
@subsection set-residue-name
@deffn function set-residue-name imol chain_id res_no ins_code new_residue_name

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{res_no} is an integer number
@item @emph{ins_code} is a string
@item @emph{new_residue_name} is a string
@end itemize

set lots of atom attributes at once by-passing the rebonding and redrawing of the above 2 functions 

set the residue name of the specified residue 

@end deffn

@node Skeletonization Interface
@section Skeletonization Interface

@menu
* skeletonize-map::
* unskeletonize-map::
* set-max-skeleton-search-depth::
* set-skeleton-box-size::
@end menu

@node skeletonize-map
@subsection skeletonize-map
@deffn function skeletonize-map prune_flag imol

Where: 
@itemize @bullet
@item @emph{prune_flag} is an integer number
@item @emph{imol} is an integer number
@end itemize

skeletonize molecule number imol 

the prune_flag should almost always be 0. 

@end deffn

@node unskeletonize-map
@subsection unskeletonize-map
@deffn function unskeletonize-map imol

Where @emph{imol} is an integer number

undisplay the skeleton on molecule number imol 

@end deffn

@node set-max-skeleton-search-depth
@subsection set-max-skeleton-search-depth
@deffn function set-max-skeleton-search-depth v

Where @emph{v} is an integer number

set the skeleton search depth, used in baton building 

For high resolution maps, you need to search deeper down the skeleton tree. This limit needs to be increased to 20 or so for high res maps (it is 10 by default) 

@end deffn

@node set-skeleton-box-size
@subsection set-skeleton-box-size
@deffn function set-skeleton-box-size f

Where @emph{f} is a number

the box size (in Angstroms) for which the skeleton is displayed 

@end deffn

@node Skeleton Colour
@section Skeleton Colour

@menu
* set-skeleton-colour::
@end menu

@node set-skeleton-colour
@subsection set-skeleton-colour
@deffn function set-skeleton-colour imol r g b

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{r} is a number
@item @emph{g} is a number
@item @emph{b} is a number
@end itemize

set the skeleton colour 

@end deffn

@node Read Maps
@section Read Maps

@menu
* handle-read-ccp4-map::
@end menu

@node handle-read-ccp4-map
@subsection handle-read-ccp4-map
@deffn function handle-read-ccp4-map filename is_diff_map_flag

Where: 
@itemize @bullet
@item @emph{filename} is a string
@item @emph{is_diff_map_flag} is an integer number
@end itemize

read a CCP4 map or a CNS map (despite the name). 

@end deffn

@node Save Coordinates
@section Save Coordinates

@menu
* save-coordinates::
* set-save-coordinates-in-original-directory::
@end menu

@node save-coordinates
@subsection save-coordinates
@deffn function save-coordinates imol filename

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{filename} is a string
@end itemize

save coordinates of molecule number imol in filename 

Returns: status 1 is good (success), 0 is fail. 

@end deffn

@node set-save-coordinates-in-original-directory
@subsection set-save-coordinates-in-original-directory
@deffn function set-save-coordinates-in-original-directory i

Where @emph{i} is an integer number

set save coordinates in the starting directory 

@end deffn

@node Read Phases File Functions
@section Read Phases File Functions

@menu
* read-phs-and-coords-and-make-map::
* read-phs-and-make-map-using-cell-symm-from-previous-mol::
* read-phs-and-make-map-using-cell-symm-from-mol::
* read-phs-and-make-map-using-cell-symm::
* read-phs-and-make-map-with-reso-limits::
@end menu

@node read-phs-and-coords-and-make-map
@subsection read-phs-and-coords-and-make-map
@deffn function read-phs-and-coords-and-make-map pdb_filename

Where @emph{pdb_filename} is a string

read phs file use coords to get cell and symm to make map 

uses pending data to make the map. 

@end deffn

@node read-phs-and-make-map-using-cell-symm-from-previous-mol
@subsection read-phs-and-make-map-using-cell-symm-from-previous-mol
@deffn function read-phs-and-make-map-using-cell-symm-from-previous-mol phs_filename

Where @emph{phs_filename} is a string

read a phs file, the cell and symm information is from previously read (most recently read) coordinates file 

For use with phs data filename provided on the command line 

@end deffn

@node read-phs-and-make-map-using-cell-symm-from-mol
@subsection read-phs-and-make-map-using-cell-symm-from-mol
@deffn function read-phs-and-make-map-using-cell-symm-from-mol phs_filename imol

Where: 
@itemize @bullet
@item @emph{phs_filename} is a string
@item @emph{imol} is an integer number
@end itemize

read phs file and use a previously read molecule to provide the cell and symmetry information 

Returns: the new molecule number, return -1 if problem creating the map (e.g. not phs data, file not found etc). 

@end deffn

@node read-phs-and-make-map-using-cell-symm
@subsection read-phs-and-make-map-using-cell-symm
@deffn function read-phs-and-make-map-using-cell-symm phs_file_name hm_spacegroup a b c alpha beta gamma

Where: 
@itemize @bullet
@item @emph{phs_file_name} is a string
@item @emph{hm_spacegroup} is a string
@item @emph{a} is a number
@item @emph{b} is a number
@item @emph{c} is a number
@item @emph{alpha} is a number
@item @emph{beta} is a number
@item @emph{gamma} is a number
@end itemize

read phs file use coords to use cell and symm to make map 

in degrees 

@end deffn

@node read-phs-and-make-map-with-reso-limits
@subsection read-phs-and-make-map-with-reso-limits
@deffn function read-phs-and-make-map-with-reso-limits imol phs_file_name reso_lim_low reso_lim_high

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{phs_file_name} is a string
@item @emph{reso_lim_low} is a number
@item @emph{reso_lim_high} is a number
@end itemize

read a phs file and use the cell and symm in molecule number imol and use the resolution limits reso_lim_high (in Angstroems). 

@end deffn

@node Graphics Move
@section Graphics Move

@menu
* undo-last-move::
* translate-molecule-by::
* transform-molecule-by::
* transform-zone::
@end menu

@node undo-last-move
@subsection undo-last-move
@deffn function undo-last-move

undo last move 

@end deffn

@node translate-molecule-by
@subsection translate-molecule-by
@deffn function translate-molecule-by imol x y z

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{x} is a number
@item @emph{y} is a number
@item @emph{z} is a number
@end itemize

translate molecule number imol by (x,y,z) in Angstroms 

@end deffn

@node transform-molecule-by
@subsection transform-molecule-by
@deffn function transform-molecule-by imol m11 m12 m13 m21 m22 m23 m31 m32 m33 x y z

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{m11} is a number
@item @emph{m12} is a number
@item @emph{m13} is a number
@item @emph{m21} is a number
@item @emph{m22} is a number
@item @emph{m23} is a number
@item @emph{m31} is a number
@item @emph{m32} is a number
@item @emph{m33} is a number
@item @emph{x} is a number
@item @emph{y} is a number
@item @emph{z} is a number
@end itemize

transform molecule number imol by the given rotation matrix, then translate by (x,y,z) in Angstroms 

@end deffn

@node transform-zone
@subsection transform-zone
@deffn function transform-zone imol chain_id resno_start resno_end ins_code m11 m12 m13 m21 m22 m23 m31 m32 m33 x y z

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno_start} is an integer number
@item @emph{resno_end} is an integer number
@item @emph{ins_code} is a string
@item @emph{m11} is a number
@item @emph{m12} is a number
@item @emph{m13} is a number
@item @emph{m21} is a number
@item @emph{m22} is a number
@item @emph{m23} is a number
@item @emph{m31} is a number
@item @emph{m32} is a number
@item @emph{m33} is a number
@item @emph{x} is a number
@item @emph{y} is a number
@item @emph{z} is a number
@end itemize

transform fragment of molecule number imol by the given rotation matrix, then translate by (x,y,z) in Angstroms 

@end deffn

@node Go To Atom Widget Functions
@section Go To Atom Widget Functions

@menu
* post-go-to-atom-window::
* go-to-atom-molecule-number::
* go-to-atom-chain-id::
* go-to-atom-atom-name::
* go-to-atom-residue-number::
* go-to-atom-ins-code::
* go-to-atom-alt-conf::
* set-go-to-atom-chain-residue-atom-name::
* set-go-to-atom-chain-residue-atom-name-full::
* set-go-to-atom-chain-residue-atom-name-no-redraw::
* update-go-to-atom-from-current-position::
* atom-spec-to-atom-index::
* full-atom-spec-to-atom-index::
* update-go-to-atom-window-on-changed-mol::
* update-go-to-atom-window-on-new-mol::
* set-go-to-atom-molecule::
@end menu

@node post-go-to-atom-window
@subsection post-go-to-atom-window
@deffn function post-go-to-atom-window

Post the Go To Atom Window. 

@end deffn

@node go-to-atom-molecule-number
@subsection go-to-atom-molecule-number
@deffn function go-to-atom-molecule-number

the go-to-atom molecule number 

@end deffn

@node go-to-atom-chain-id
@subsection go-to-atom-chain-id
@deffn function go-to-atom-chain-id

the go-to-atom chain-id 

@end deffn

@node go-to-atom-atom-name
@subsection go-to-atom-atom-name
@deffn function go-to-atom-atom-name

the go-to-atom atom name 

@end deffn

@node go-to-atom-residue-number
@subsection go-to-atom-residue-number
@deffn function go-to-atom-residue-number

the go-to-atom residue number 

@end deffn

@node go-to-atom-ins-code
@subsection go-to-atom-ins-code
@deffn function go-to-atom-ins-code

the go-to-atom insertion code 

@end deffn

@node go-to-atom-alt-conf
@subsection go-to-atom-alt-conf
@deffn function go-to-atom-alt-conf

the go-to-atom alt conf 

@end deffn

@node set-go-to-atom-chain-residue-atom-name
@subsection set-go-to-atom-chain-residue-atom-name
@deffn function set-go-to-atom-chain-residue-atom-name t1_chain_id iresno t3_atom_name

Where: 
@itemize @bullet
@item @emph{t1_chain_id} is a string
@item @emph{iresno} is an integer number
@item @emph{t3_atom_name} is a string
@end itemize

set the go to atom specification 

It seems important for swig that the char * arguments are const char *, not const gchar * (or else we get wrong type of argument error on (say) "A"

Returns: the success status of the go to. 0 for fail, 1 for success. 

@end deffn

@node set-go-to-atom-chain-residue-atom-name-full
@subsection set-go-to-atom-chain-residue-atom-name-full
@deffn function set-go-to-atom-chain-residue-atom-name-full chain_id resno ins_code atom_name alt_conf

Where: 
@itemize @bullet
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{ins_code} is a string
@item @emph{atom_name} is a string
@item @emph{alt_conf} is a string
@end itemize

set the go to (full) atom specification 

It seems important for swig that the char * arguments are const char *, not const gchar * (or else we get wrong type of argument error on (say) "A"

Returns: the success status of the go to. 0 for fail, 1 for success. 

@end deffn

@node set-go-to-atom-chain-residue-atom-name-no-redraw
@subsection set-go-to-atom-chain-residue-atom-name-no-redraw
@deffn function set-go-to-atom-chain-residue-atom-name-no-redraw t1 iresno t3 make_the_move_flag

Where: 
@itemize @bullet
@item @emph{t1} is a string
@item @emph{iresno} is an integer number
@item @emph{t3} is a string
@item @emph{make_the_move_flag} is an integer number
@end itemize

set go to atom but don't redraw 

@end deffn

@node update-go-to-atom-from-current-position
@subsection update-go-to-atom-from-current-position
@deffn function update-go-to-atom-from-current-position

update the Go To Atom widget entries to atom closest to screen centre. 

@end deffn

@node atom-spec-to-atom-index
@subsection atom-spec-to-atom-index
@deffn function atom-spec-to-atom-index mol chain resno atom_name

Where: 
@itemize @bullet
@item @emph{mol} is an integer number
@item @emph{chain} is a string
@item @emph{resno} is an integer number
@item @emph{atom_name} is a string
@end itemize

what is the atom index of the given atom? 

@end deffn

@node full-atom-spec-to-atom-index
@subsection full-atom-spec-to-atom-index
@deffn function full-atom-spec-to-atom-index imol chain resno inscode atom_name altloc

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain} is a string
@item @emph{resno} is an integer number
@item @emph{inscode} is a string
@item @emph{atom_name} is a string
@item @emph{altloc} is a string
@end itemize

what is the atom index of the given atom? 

@end deffn

@node update-go-to-atom-window-on-changed-mol
@subsection update-go-to-atom-window-on-changed-mol
@deffn function update-go-to-atom-window-on-changed-mol imol

Where @emph{imol} is an integer number

update the Go To Atom window 

@end deffn

@node update-go-to-atom-window-on-new-mol
@subsection update-go-to-atom-window-on-new-mol
@deffn function update-go-to-atom-window-on-new-mol

update the Go To Atom window. This updates the option menu for the molecules. 

@end deffn

@node set-go-to-atom-molecule
@subsection set-go-to-atom-molecule
@deffn function set-go-to-atom-molecule imol

Where @emph{imol} is an integer number

set the molecule for the Go To Atom 

For dynarama callback sake. The widget/class knows which molecule that it was generated from, so in order to go to the molecule from dynarama, we first need to the the molecule - because 

 does not mention the molecule (see "Next/Previous Residue" for reasons for that). This function simply calls the graphics_info_t function of the same name.

Also used in scripting, where go-to-atom-chain-residue-atom-name does not mention the molecule number.

20090914-PE set-go-to-atom-molecule can be used in a script and it should change the go-to-atom-molecule in the Go To Atom dialog (if it is being displayed). This does mean, of course that using the ramachandran plot to centre on atoms will change the Go To Atom dialog. Maybe that is surprising (maybe not). 

@end deffn

@node Map and Molecule Control
@section Map and Molecule Control

@menu
* post-display-control-window::
* set-map-displayed::
* set-mol-displayed::
* set-mol-active::
* mol-is-displayed::
* mol-is-active::
* map-is-displayed::
* set-all-maps-displayed::
* set-all-models-displayed-and-active::
* show-spacegroup::
@end menu

@node post-display-control-window
@subsection post-display-control-window
@deffn function post-display-control-window

display the Display Constrol window 

@end deffn

@node set-map-displayed
@subsection set-map-displayed
@deffn function set-map-displayed imol state

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{state} is an integer number
@end itemize

make the map displayed/undisplayed, 0 for off, 1 for on 

@end deffn

@node set-mol-displayed
@subsection set-mol-displayed
@deffn function set-mol-displayed imol state

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{state} is an integer number
@end itemize

make the coordinates molecule displayed/undisplayed, 0 for off, 1 for on 

@end deffn

@node set-mol-active
@subsection set-mol-active
@deffn function set-mol-active imol state

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{state} is an integer number
@end itemize

make the coordinates molecule active/inactve (clickable), 0 for off, 1 for on 

@end deffn

@node mol-is-displayed
@subsection mol-is-displayed
@deffn function mol-is-displayed imol

Where @emph{imol} is an integer number

return the display state of molecule number imol 

Returns: 1 for on, 0 for off 

@end deffn

@node mol-is-active
@subsection mol-is-active
@deffn function mol-is-active imol

Where @emph{imol} is an integer number

return the active state of molecule number imol 

Returns: 1 for on, 0 for off 

@end deffn

@node map-is-displayed
@subsection map-is-displayed
@deffn function map-is-displayed imol

Where @emph{imol} is an integer number

return the display state of molecule number imol 

Returns: 1 for on, 0 for off 

@end deffn

@node set-all-maps-displayed
@subsection set-all-maps-displayed
@deffn function set-all-maps-displayed on_or_off

Where @emph{on_or_off} is an integer number

if on_or_off is 0 turn off all maps displayed, for other values of on_or_off turn on all maps 

@end deffn

@node set-all-models-displayed-and-active
@subsection set-all-models-displayed-and-active
@deffn function set-all-models-displayed-and-active on_or_off

Where @emph{on_or_off} is an integer number

if on_or_off is 0 turn off all models displayed and active, for other values of on_or_off turn on all models. 

@end deffn

@node show-spacegroup
@subsection show-spacegroup
@deffn function show-spacegroup imol

Where @emph{imol} is an integer number

return the spacegroup of molecule number imol . Deprecated. 

Returns: "No Spacegroup" when the spacegroup of a molecule has not been set. 

@end deffn

@node Align and Mutate
@section Align and Mutate

@menu
* align-and-mutate::
* set-alignment-gap-and-space-penalty::
@end menu

@node align-and-mutate
@subsection align-and-mutate
@deffn function align-and-mutate imol chain_id fasta_maybe renumber_residues_flag

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{fasta_maybe} is a string
@item @emph{renumber_residues_flag} is an integer number
@end itemize

aligand and mutate the given chain to the given sequence 

@end deffn

@node set-alignment-gap-and-space-penalty
@subsection set-alignment-gap-and-space-penalty
@deffn function set-alignment-gap-and-space-penalty wgap wspace

Where: 
@itemize @bullet
@item @emph{wgap} is a number
@item @emph{wspace} is a number
@end itemize

set the penalty for affine gap and space when aligning, defaults -3.0 and -0.4 

@end deffn

@node Renumber Residue Range
@section Renumber Residue Range

@menu
* renumber-residue-range::
* change-residue-number::
@end menu

@node renumber-residue-range
@subsection renumber-residue-range
@deffn function renumber-residue-range imol chain_id start_res last_res offset

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{start_res} is an integer number
@item @emph{last_res} is an integer number
@item @emph{offset} is an integer number
@end itemize

renumber the given residue range by offset residues 

@end deffn

@node change-residue-number
@subsection change-residue-number
@deffn function change-residue-number imol chain_id current_resno current_inscode new_resno new_inscode

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{current_resno} is an integer number
@item @emph{current_inscode} is a string
@item @emph{new_resno} is an integer number
@item @emph{new_inscode} is a string
@end itemize

change chain id, residue number or insertion code for given residue 

@end deffn

@node Scripting Interface
@section Scripting Interface

@menu
* probe-available-p::
* post-scripting-window::
* post-scheme-scripting-window::
* post-python-scripting-window::
@end menu

@node probe-available-p
@subsection probe-available-p
@deffn function probe-available-p

Can we run probe (was the executable variable set properly?) (predicate). 

Returns: 1 for yes, 2 for no 

@end deffn

@node post-scripting-window
@subsection post-scripting-window
@deffn function post-scripting-window

do nothing - compatibility function 

@end deffn

@node post-scheme-scripting-window
@subsection post-scheme-scripting-window
@deffn function post-scheme-scripting-window

pop-up a scripting window for scheming 

@end deffn

@node post-python-scripting-window
@subsection post-python-scripting-window
@deffn function post-python-scripting-window

pop-up a scripting window for pythoning 

@end deffn

@node Monomer
@section Monomer

@menu
* get-coords-for-accession-code::
* run-script::
* run-guile-script::
* run-python-script::
* import-python-module::
@end menu

@node get-coords-for-accession-code
@subsection get-coords-for-accession-code
@deffn function get-coords-for-accession-code code

Where @emph{code} is a string

if possible, read in the new coords getting coords via web. 

(no return value because get-url-str does not return one). 

@end deffn

@node run-script
@subsection run-script
@deffn function run-script filename

Where @emph{filename} is a string

run script file 

@end deffn

@node run-guile-script
@subsection run-guile-script
@deffn function run-guile-script filename

Where @emph{filename} is a string

guile run script file 

@end deffn

@node run-python-script
@subsection run-python-script
@deffn function run-python-script filename

Where @emph{filename} is a string

run python script file 

@end deffn

@node import-python-module
@subsection import-python-module
@deffn function import-python-module module_name use_namespace

Where: 
@itemize @bullet
@item @emph{module_name} is a string
@item @emph{use_namespace} is an integer number
@end itemize

import python module 

@end deffn

@node Regularization and Refinement
@section Regularization and Refinement

@menu
* add-planar-peptide-restraints::
* remove-planar-peptide-restraints::
* add-omega-torsion-restriants::
* remove-omega-torsion-restriants::
* set-refinement-immediate-replacement::
* refinement-immediate-replacement-state::
* set-residue-selection-flash-frames-number::
* accept-regularizement::
* set-refine-with-torsion-restraints::
* refine-with-torsion-restraints-state::
* set-matrix::
* matrix-state::
* set-refine-auto-range-step::
* set-refine-max-residues::
* refine-zone-atom-index-define::
* refine-zone::
* refine-auto-range::
* regularize-zone::
* set-dragged-refinement-steps-per-frame::
* dragged-refinement-steps-per-frame::
* set-refinement-refine-per-frame::
* refinement-refine-per-frame-state::
* set-refinement-drag-elasticity::
* set-refine-ramachandran-angles::
* set-fix-chiral-volumes-before-refinement::
* check-chiral-volumes::
* set-show-chiral-volume-errors-dialog::
* set-secondary-structure-restraints-type::
* secondary-structure-restraints-type::
* imol-refinement-map::
* set-imol-refinement-map::
* does-residue-exist-p::
* add-extra-bond-restraint::
* delete-all-extra-restraints::
* delete-extra-restraints-for-residue::
* set-extra-restraints-prosmart-sigma-limits::
* set-use-only-extra-torsion-restraints-for-torsions::
* use-only-extra-torsion-restraints-for-torsions-state::
* show-restraints-editor::
* show-restraints-editor-by-index::
* write-restraints-cif-dictionary::
@end menu

@node add-planar-peptide-restraints
@subsection add-planar-peptide-restraints
@deffn function add-planar-peptide-restraints

add a restraint on peptides to make them planar 

This adds a 5 atom restraint that includes both CA atoms of the peptide. Use this rather than editting the mon_lib_list.cif file. 

@end deffn

@node remove-planar-peptide-restraints
@subsection remove-planar-peptide-restraints
@deffn function remove-planar-peptide-restraints

remove restraints on peptides to make them planar. 

@end deffn

@node add-omega-torsion-restriants
@subsection add-omega-torsion-restriants
@deffn function add-omega-torsion-restriants

add restraints on the omega angle of the peptides 

(that is the torsion round the peptide bond). Omega angles that are closer to 0 than to 180 will be refined as cis peptides (and of course if omega is greater than 90 then the peptide will be refined as a trans peptide (this is the normal case). 

@end deffn

@node remove-omega-torsion-restriants
@subsection remove-omega-torsion-restriants
@deffn function remove-omega-torsion-restriants

remove omega restraints on CIS and TRANS linked residues. 

@end deffn

@node set-refinement-immediate-replacement
@subsection set-refinement-immediate-replacement
@deffn function set-refinement-immediate-replacement istate

Where @emph{istate} is an integer number

set immediate replacement mode for refinement and regularization. You need this (call with istate=1) if you are scripting refinement/regularization 

@end deffn

@node refinement-immediate-replacement-state
@subsection refinement-immediate-replacement-state
@deffn function refinement-immediate-replacement-state

query the state of the immediate replacement mode 

@end deffn

@node set-residue-selection-flash-frames-number
@subsection set-residue-selection-flash-frames-number
@deffn function set-residue-selection-flash-frames-number i

Where @emph{i} is an integer number

set the number of frames for which the selected residue range flashes 

On fast computers, this can be set to higher than the default for more aesthetic appeal. 

@end deffn

@node accept-regularizement
@subsection accept-regularizement
@deffn function accept-regularizement

accept the new positions of the regularized or refined residues 

If you are scripting refinement and/or regularization, this is the function that you need to call after refine-zone or regularize-zone. 

@end deffn

@node set-refine-with-torsion-restraints
@subsection set-refine-with-torsion-restraints
@deffn function set-refine-with-torsion-restraints istate

Where @emph{istate} is an integer number

turn on (or off) torsion restraints 

Pass with istate=1 for on, istate=0 for off. 

@end deffn

@node refine-with-torsion-restraints-state
@subsection refine-with-torsion-restraints-state
@deffn function refine-with-torsion-restraints-state

return the state of above 

@end deffn

@node set-matrix
@subsection set-matrix
@deffn function set-matrix f

Where @emph{f} is a number

set the relative weight of the geometric terms to the map terms 

The default is 60.

The higher the number the more weight that is given to the map terms but the resulting chi squared values are higher). This will be needed for maps generated from data not on (or close to) the absolute scale or maps that have been scaled (for example so that the sigma level has been scaled to 1.0). 

@end deffn

@node matrix-state
@subsection matrix-state
@deffn function matrix-state

return the relative weight of the geometric terms to the map terms. 

@end deffn

@node set-refine-auto-range-step
@subsection set-refine-auto-range-step
@deffn function set-refine-auto-range-step i

Where @emph{i} is an integer number

change the +/- step for autoranging (default is 1) 

Auto-ranging alow you to select a range from one button press, this allows you to set the number of residues either side of the clicked residue that becomes the selected zone 

@end deffn

@node set-refine-max-residues
@subsection set-refine-max-residues
@deffn function set-refine-max-residues n

Where @emph{n} is an integer number

set the heuristic fencepost for the maximum number of residues in the refinement/regularization residue range 

Default is 20 

@end deffn

@node refine-zone-atom-index-define
@subsection refine-zone-atom-index-define
@deffn function refine-zone-atom-index-define imol ind1 ind2

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{ind1} is an integer number
@item @emph{ind2} is an integer number
@end itemize

refine a zone based on atom indexing 

@end deffn

@node refine-zone
@subsection refine-zone
@deffn function refine-zone imol chain_id resno1 resno2 altconf

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno1} is an integer number
@item @emph{resno2} is an integer number
@item @emph{altconf} is a string
@end itemize

refine a zone 

presumes that imol_Refinement_Map has been set 

@end deffn

@node refine-auto-range
@subsection refine-auto-range
@deffn function refine-auto-range imol chain_id resno1 altconf

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno1} is an integer number
@item @emph{altconf} is a string
@end itemize

refine a zone using auto-range 

presumes that imol_Refinement_Map has been set 

@end deffn

@node regularize-zone
@subsection regularize-zone
@deffn function regularize-zone imol chain_id resno1 resno2 altconf

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno1} is an integer number
@item @emph{resno2} is an integer number
@item @emph{altconf} is a string
@end itemize

regularize a zone 

Returns: a status, whether the regularisation was done or not. 0 for no, 1 for yes. 

@end deffn

@node set-dragged-refinement-steps-per-frame
@subsection set-dragged-refinement-steps-per-frame
@deffn function set-dragged-refinement-steps-per-frame v

Where @emph{v} is an integer number

set the number of refinement steps applied to the intermediate atoms each frame of graphics. 

smaller numbers make the movement of the intermediate atoms slower, smoother, more elegant.

Default: 80. 

@end deffn

@node dragged-refinement-steps-per-frame
@subsection dragged-refinement-steps-per-frame
@deffn function dragged-refinement-steps-per-frame

return the number of steps per frame in dragged refinement 

@end deffn

@node set-refinement-refine-per-frame
@subsection set-refinement-refine-per-frame
@deffn function set-refinement-refine-per-frame istate

Where @emph{istate} is an integer number

allow refinement of intermediate atoms after dragging, before displaying (default: 0, off). 

An attempt to do something like xfit does, at the request of Frank von Delft.

Pass with istate=1 to enable this option. 

@end deffn

@node refinement-refine-per-frame-state
@subsection refinement-refine-per-frame-state
@deffn function refinement-refine-per-frame-state

query the state of the above option 

@end deffn

@node set-refinement-drag-elasticity
@subsection set-refinement-drag-elasticity
@deffn function set-refinement-drag-elasticity e

Where @emph{e} is a number

the elasticity of the dragged atom in refinement mode. 

Default 0.33

Bigger numbers mean bigger movement of the other atoms. 

@end deffn

@node set-refine-ramachandran-angles
@subsection set-refine-ramachandran-angles
@deffn function set-refine-ramachandran-angles state

Where @emph{state} is an integer number

turn on Ramachandran angles refinement in refinement and regularization 

name consistent with 

 !? 

@end deffn

@node set-fix-chiral-volumes-before-refinement
@subsection set-fix-chiral-volumes-before-refinement
@deffn function set-fix-chiral-volumes-before-refinement istate

Where @emph{istate} is an integer number

correct the sign of chiral volumes before commencing refinement? 

Do we want to fix chiral volumes (by moving the chiral atom to the other side of the chiral plane if necessary). Default yes (1). Note: doesn't work currently. 

@end deffn

@node check-chiral-volumes
@subsection check-chiral-volumes
@deffn function check-chiral-volumes imol

Where @emph{imol} is an integer number

query the state of the above option 

@end deffn

@node set-show-chiral-volume-errors-dialog
@subsection set-show-chiral-volume-errors-dialog
@deffn function set-show-chiral-volume-errors-dialog istate

Where @emph{istate} is an integer number

For experienced Cooters who don't like Coot nannying about chiral volumes during refinement. 

@end deffn

@node set-secondary-structure-restraints-type
@subsection set-secondary-structure-restraints-type
@deffn function set-secondary-structure-restraints-type itype

Where @emph{itype} is an integer number

set the type of secondary structure restraints 

0 no sec str restraints

1 alpha helix restraints

2 beta strand restraints 

@end deffn

@node secondary-structure-restraints-type
@subsection secondary-structure-restraints-type
@deffn function secondary-structure-restraints-type

return the secondary structure restraints type 

@end deffn

@node imol-refinement-map
@subsection imol-refinement-map
@deffn function imol-refinement-map

the molecule number of the map used for refinement 

Returns: the map number, if it has been set or there is only one map, return -1 on no map set (ambiguous) or no maps. 

@end deffn

@node set-imol-refinement-map
@subsection set-imol-refinement-map
@deffn function set-imol-refinement-map imol

Where @emph{imol} is an integer number

set the molecule number of the map to be used for refinement/fitting. 

Returns: imol on success, -1 on failure 

@end deffn

@node does-residue-exist-p
@subsection does-residue-exist-p
@deffn function does-residue-exist-p imol chain_id resno inscode

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{inscode} is a string
@end itemize

Does the residue exist? (Raw function) 

Returns: 0 on not-exist, 1 on does exist. 

@end deffn

@node add-extra-bond-restraint
@subsection add-extra-bond-restraint
@deffn function add-extra-bond-restraint imol chain_id_1 res_no_1 ins_code_1 atom_name_1 alt_conf_1 chain_id_2 res_no_2 ins_code_2 atom_name_2 alt_conf_2 bond_dist esd

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id_1} is a string
@item @emph{res_no_1} is an integer number
@item @emph{ins_code_1} is a string
@item @emph{atom_name_1} is a string
@item @emph{alt_conf_1} is a string
@item @emph{chain_id_2} is a string
@item @emph{res_no_2} is an integer number
@item @emph{ins_code_2} is a string
@item @emph{atom_name_2} is a string
@item @emph{alt_conf_2} is a string
@item @emph{bond_dist} is a number
@item @emph{esd} is a number
@end itemize

add a user-define bond restraint 

this extra restraint is used when the given atoms are selected in refinement or regularization.

Returns: the index of the new restraint.

Returns: -1 when the atoms were not found and no extra bond restraint was stored. 

@end deffn

@node delete-all-extra-restraints
@subsection delete-all-extra-restraints
@deffn function delete-all-extra-restraints imol

Where @emph{imol} is an integer number

clear out all the extra/user-defined restraints for molecule number imol 

@end deffn

@node delete-extra-restraints-for-residue
@subsection delete-extra-restraints-for-residue
@deffn function delete-extra-restraints-for-residue imol chain_id res_no ins_code

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{res_no} is an integer number
@item @emph{ins_code} is a string
@end itemize

clear out all the extra/user-defined restraints for this residue in molecule number imol 

@end deffn

@node set-extra-restraints-prosmart-sigma-limits
@subsection set-extra-restraints-prosmart-sigma-limits
@deffn function set-extra-restraints-prosmart-sigma-limits imol limit_high limit_low

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{limit_high} is a number
@item @emph{limit_low} is a number
@end itemize

often we don't want to see all prosmart restraints, just the (big) violations 

@end deffn

@node set-use-only-extra-torsion-restraints-for-torsions
@subsection set-use-only-extra-torsion-restraints-for-torsions
@deffn function set-use-only-extra-torsion-restraints-for-torsions state

Where @emph{state} is an integer number

set use only extra torsion restraints for torsions 

@end deffn

@node use-only-extra-torsion-restraints-for-torsions-state
@subsection use-only-extra-torsion-restraints-for-torsions-state
@deffn function use-only-extra-torsion-restraints-for-torsions-state

return only-use-extra-torsion-restraints-for-torsions state 

@end deffn

@node show-restraints-editor
@subsection show-restraints-editor
@deffn function show-restraints-editor monomer_type

Where @emph{monomer_type} is a string

show restraints editor 

@end deffn

@node show-restraints-editor-by-index
@subsection show-restraints-editor-by-index
@deffn function show-restraints-editor-by-index menu_item_index

Where @emph{menu_item_index} is an integer number

show restraints editor using residue type index 

@end deffn

@node write-restraints-cif-dictionary
@subsection write-restraints-cif-dictionary
@deffn function write-restraints-cif-dictionary monomer_type file_name

Where: 
@itemize @bullet
@item @emph{monomer_type} is a string
@item @emph{file_name} is a string
@end itemize

write cif restraints for monomer 

@end deffn

@node Simplex Refinement Interface
@section Simplex Refinement Interface

@menu
* fit-residue-range-to-map-by-simplex::
* score-residue-range-fit-to-map::
@end menu

@node fit-residue-range-to-map-by-simplex
@subsection fit-residue-range-to-map-by-simplex
@deffn function fit-residue-range-to-map-by-simplex res1 res2 altloc chain_id imol imol_for_map

Where: 
@itemize @bullet
@item @emph{res1} is an integer number
@item @emph{res2} is an integer number
@item @emph{altloc} is a string
@item @emph{chain_id} is a string
@item @emph{imol} is an integer number
@item @emph{imol_for_map} is an integer number
@end itemize

refine residue range using simplex optimization 

@end deffn

@node score-residue-range-fit-to-map
@subsection score-residue-range-fit-to-map
@deffn function score-residue-range-fit-to-map res1 res2 altloc chain_id imol imol_for_map

Where: 
@itemize @bullet
@item @emph{res1} is an integer number
@item @emph{res2} is an integer number
@item @emph{altloc} is a string
@item @emph{chain_id} is a string
@item @emph{imol} is an integer number
@item @emph{imol_for_map} is an integer number
@end itemize

simply score the residue range fit to map 

@end deffn

@node Nomenclature Errors
@section Nomenclature Errors

@menu
* fix-nomenclature-errors::
* set-nomenclature-errors-on-read::
@end menu

@node fix-nomenclature-errors
@subsection fix-nomenclature-errors
@deffn function fix-nomenclature-errors imol

Where @emph{imol} is an integer number

fix nomenclature errors in molecule number imol 

Returns: the number of resides altered. 

@end deffn

@node set-nomenclature-errors-on-read
@subsection set-nomenclature-errors-on-read
@deffn function set-nomenclature-errors-on-read mode

Where @emph{mode} is a string

set way nomenclature errors should be handled on reading coordinates. 

mode should be "auto-correct", "ignore", "prompt". The default is "prompt" 

@end deffn

@node Atom Info  Interface
@section Atom Info  Interface

@menu
* output-atom-info-as-text::
@end menu

@node output-atom-info-as-text
@subsection output-atom-info-as-text
@deffn function output-atom-info-as-text imol chain_id resno ins_code atname altconf

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{ins_code} is a string
@item @emph{atname} is a string
@item @emph{altconf} is a string
@end itemize

output to the terminal the Atom Info for the give atom specs 

@end deffn

@node Residue Info
@section Residue Info

@menu
* residue-info-dialog::
@end menu

@node residue-info-dialog
@subsection residue-info-dialog
@deffn function residue-info-dialog imol chain_id resno ins_code

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{ins_code} is a string
@end itemize

show residue info dialog for given residue 

@end deffn

@node Residue Environment Functions
@section Residue Environment Functions

@menu
* set-show-environment-distances::
* set-show-environment-distances-bumps::
* set-show-environment-distances-h-bonds::
* show-environment-distances-state::
* set-environment-distances-distance-limits::
@end menu

@node set-show-environment-distances
@subsection set-show-environment-distances
@deffn function set-show-environment-distances state

Where @emph{state} is an integer number

show environment distances. If state is 0, distances are turned off, otherwise distances are turned on. 

@end deffn

@node set-show-environment-distances-bumps
@subsection set-show-environment-distances-bumps
@deffn function set-show-environment-distances-bumps state

Where @emph{state} is an integer number

show bumps environment distances. If state is 0, bump distances are turned off, otherwise bump distances are turned on. 

@end deffn

@node set-show-environment-distances-h-bonds
@subsection set-show-environment-distances-h-bonds
@deffn function set-show-environment-distances-h-bonds state

Where @emph{state} is an integer number

show H-bond environment distances. If state is 0, bump distances are turned off, otherwise H-bond distances are turned on. 

@end deffn

@node show-environment-distances-state
@subsection show-environment-distances-state
@deffn function show-environment-distances-state

show the state of display of the environment distances 

@end deffn

@node set-environment-distances-distance-limits
@subsection set-environment-distances-distance-limits
@deffn function set-environment-distances-distance-limits min_dist max_dist

Where: 
@itemize @bullet
@item @emph{min_dist} is a number
@item @emph{max_dist} is a number
@end itemize

min and max distances for the environment distances 

@end deffn

@node Pointer Functions
@section Pointer Functions

@menu
* set-show-pointer-distances::
* show-pointer-distances-state::
@end menu

@node set-show-pointer-distances
@subsection set-show-pointer-distances
@deffn function set-show-pointer-distances istate

Where @emph{istate} is an integer number

turn on (or off) the pointer distance by passing 1 (or 0). 

@end deffn

@node show-pointer-distances-state
@subsection show-pointer-distances-state
@deffn function show-pointer-distances-state

show the state of display of the pointer distances 

@end deffn

@node Zoom Functions
@section Zoom Functions

@menu
* scale-zoom::
* zoom-factor::
* set-smooth-scroll-do-zoom::
* smooth-scroll-do-zoom::
@end menu

@node scale-zoom
@subsection scale-zoom
@deffn function scale-zoom f

Where @emph{f} is a number

scale the view by f 

external (scripting) interface (with redraw) 

@end deffn

@node zoom-factor
@subsection zoom-factor
@deffn function zoom-factor

return the current zoom factor 

@end deffn

@node set-smooth-scroll-do-zoom
@subsection set-smooth-scroll-do-zoom
@deffn function set-smooth-scroll-do-zoom i

Where @emph{i} is an integer number

set smooth scroll with zoom 

@end deffn

@node smooth-scroll-do-zoom
@subsection smooth-scroll-do-zoom
@deffn function smooth-scroll-do-zoom

return the state of the above system 

@end deffn

@node CNS Data Functions
@section CNS Data Functions

@menu
* handle-cns-data-file::
* handle-cns-data-file-with-cell::
@end menu

@node handle-cns-data-file
@subsection handle-cns-data-file
@deffn function handle-cns-data-file filename imol

Where: 
@itemize @bullet
@item @emph{filename} is a string
@item @emph{imol} is an integer number
@end itemize

read CNS data (currently only a placeholder) 

@end deffn

@node handle-cns-data-file-with-cell
@subsection handle-cns-data-file-with-cell
@deffn function handle-cns-data-file-with-cell filename imol a b c alpha beta gamma spg_info

Where: 
@itemize @bullet
@item @emph{filename} is a string
@item @emph{imol} is an integer number
@item @emph{a} is a number
@item @emph{b} is a number
@item @emph{c} is a number
@item @emph{alpha} is a number
@item @emph{beta} is a number
@item @emph{gamma} is a number
@item @emph{spg_info} is a string
@end itemize

read CNS data (currently only a placeholder) 

a, b,c are in Angstroems. alpha, beta, gamma are in degrees. spg is the space group info, either ;-delimited symmetry operators or the space group name 

@end deffn

@node mmCIF Functions
@section mmCIF Functions

@menu
* open-cif-dictionary-file-selector-dialog::
@end menu

@node open-cif-dictionary-file-selector-dialog
@subsection open-cif-dictionary-file-selector-dialog
@deffn function open-cif-dictionary-file-selector-dialog

open the cif dictionary file selector dialog 

@end deffn

@node SHELXL Functions
@section SHELXL Functions

@menu
* read-shelx-ins-file::
* write-shelx-ins-file::
@end menu

@node read-shelx-ins-file
@subsection read-shelx-ins-file
@deffn function read-shelx-ins-file filename recentre_flag

Where: 
@itemize @bullet
@item @emph{filename} is a string
@item @emph{recentre_flag} is an integer number
@end itemize

read a SHELXL .ins file 

@end deffn

@node write-shelx-ins-file
@subsection write-shelx-ins-file
@deffn function write-shelx-ins-file imol filename

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{filename} is a string
@end itemize

write a SHELXL .ins file for molecule number imol 

@end deffn

@node Validation Functions
@section Validation Functions

@menu
* difference-map-peaks::
* gln-asn-b-factor-outliers::
@end menu

@node difference-map-peaks
@subsection difference-map-peaks
@deffn function difference-map-peaks imol imol_coords level max_closeness do_positive_level_flag do_negative_level_flag

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{imol_coords} is an integer number
@item @emph{level} is a number
@item @emph{max_closeness} is a number
@item @emph{do_positive_level_flag} is an integer number
@item @emph{do_negative_level_flag} is an integer number
@end itemize

generate a list of difference map peaks 

peaks within max_closeness (2.0 A typically) of a larger peak are not listed. 

@end deffn

@node gln-asn-b-factor-outliers
@subsection gln-asn-b-factor-outliers
@deffn function gln-asn-b-factor-outliers imol

Where @emph{imol} is an integer number

Make a gui for GLN adn ASN B-factor outiers, compairing the O and N temperatur factors difference to the distribution of temperature factors from the other atoms. 

@end deffn

@node Ramachandran Plot Functions
@section Ramachandran Plot Functions

@menu
* do-ramachandran-plot::
* set-kleywegt-plot-n-diffs::
* set-ramachandran-plot-contour-levels::
* set-ramachandran-plot-background-block-size::
* ramachandran-plot-differences::
* ramachandran-plot-differences-by-chain::
@end menu

@node do-ramachandran-plot
@subsection do-ramachandran-plot
@deffn function do-ramachandran-plot imol

Where @emph{imol} is an integer number

Ramachandran plot for molecule number imol. 

@end deffn

@node set-kleywegt-plot-n-diffs
@subsection set-kleywegt-plot-n-diffs
@deffn function set-kleywegt-plot-n-diffs n_diffs

Where @emph{n_diffs} is an integer number

set the number of biggest difference arrows on the Kleywegt plot. 

@end deffn

@node set-ramachandran-plot-contour-levels
@subsection set-ramachandran-plot-contour-levels
@deffn function set-ramachandran-plot-contour-levels level_prefered level_allowed

Where: 
@itemize @bullet
@item @emph{level_prefered} is a number
@item @emph{level_allowed} is a number
@end itemize

set the contour levels for theremachandran plot, default values are 0.02 (prefered) 0.002 (allowed) 

@end deffn

@node set-ramachandran-plot-background-block-size
@subsection set-ramachandran-plot-background-block-size
@deffn function set-ramachandran-plot-background-block-size blocksize

Where @emph{blocksize} is a number

set the ramachandran plot background block size. 

Smaller is smoother but slower. Should be divisible exactly into

@end deffn

@node ramachandran-plot-differences
@subsection ramachandran-plot-differences
@deffn function ramachandran-plot-differences imol1 imol2

Where: 
@itemize @bullet
@item @emph{imol1} is an integer number
@item @emph{imol2} is an integer number
@end itemize

2 molecule ramachandran plot (NCS differences) a.k.a. A Kleywegt Plot. 

@end deffn

@node ramachandran-plot-differences-by-chain
@subsection ramachandran-plot-differences-by-chain
@deffn function ramachandran-plot-differences-by-chain imol1 imol2 a_chain b_chain

Where: 
@itemize @bullet
@item @emph{imol1} is an integer number
@item @emph{imol2} is an integer number
@item @emph{a_chain} is a string
@item @emph{b_chain} is a string
@end itemize

A chain-specific Kleywegt Plot. 

@end deffn

@node Sequence View Interface
@section Sequence View Interface

@menu
* do-sequence-view::
@end menu

@node do-sequence-view
@subsection do-sequence-view
@deffn function do-sequence-view imol

Where @emph{imol} is an integer number

display the sequence view dialog for molecule number imol 

@end deffn

@node Atom Labelling
@section Atom Labelling

@menu
* set-brief-atom-labels::
* brief-atom-labels-state::
@end menu

@node set-brief-atom-labels
@subsection set-brief-atom-labels
@deffn function set-brief-atom-labels istat

Where @emph{istat} is an integer number

use brief atom names for on-screen labels 

call with istat=1 to use brief labels, istat=0 for normal labels 

@end deffn

@node brief-atom-labels-state
@subsection brief-atom-labels-state
@deffn function brief-atom-labels-state

the brief atom label state 

@end deffn

@node Screen Rotation
@section Screen Rotation

@menu
* rotate-y-scene::
* rotate-x-scene::
* rotate-z-scene::
* spin-zoom-trans::
@end menu

@node rotate-y-scene
@subsection rotate-y-scene
@deffn function rotate-y-scene nsteps stepsize

Where: 
@itemize @bullet
@item @emph{nsteps} is an integer number
@item @emph{stepsize} is a number
@end itemize

rotate view round y axis stepsize degrees for nstep such steps 

@end deffn

@node rotate-x-scene
@subsection rotate-x-scene
@deffn function rotate-x-scene nsteps stepsize

Where: 
@itemize @bullet
@item @emph{nsteps} is an integer number
@item @emph{stepsize} is a number
@end itemize

rotate view round x axis stepsize degrees for nstep such steps 

@end deffn

@node rotate-z-scene
@subsection rotate-z-scene
@deffn function rotate-z-scene nsteps stepsize

Where: 
@itemize @bullet
@item @emph{nsteps} is an integer number
@item @emph{stepsize} is a number
@end itemize

rotate view round z axis stepsize degrees for nstep such steps 

@end deffn

@node spin-zoom-trans
@subsection spin-zoom-trans
@deffn function spin-zoom-trans axis nstep stepsize zoom_by x_rel y_rel z_rel

Where: 
@itemize @bullet
@item @emph{axis} is an integer number
@item @emph{nstep} is an integer number
@item @emph{stepsize} is a number
@item @emph{zoom_by} is a number
@item @emph{x_rel} is a number
@item @emph{y_rel} is a number
@item @emph{z_rel} is a number
@end itemize

Bells and whistles rotation. 

spin, zoom and translate.

where axis is either x,y or z, stepsize is in degrees, zoom_by and x_rel etc are how much zoom, x,y,z should have changed by after nstep steps. 

@end deffn

@node Screen Translation
@section Screen Translation

@menu
* translate-scene-x::
* translate-scene-y::
* translate-scene-z::
@end menu

@node translate-scene-x
@subsection translate-scene-x
@deffn function translate-scene-x nsteps

Where @emph{nsteps} is an integer number

translate rotation centre relative to screen axes for nsteps 

@end deffn

@node translate-scene-y
@subsection translate-scene-y
@deffn function translate-scene-y nsteps

Where @emph{nsteps} is an integer number

translate rotation centre relative to screen axes for nsteps 

@end deffn

@node translate-scene-z
@subsection translate-scene-z
@deffn function translate-scene-z nsteps

Where @emph{nsteps} is an integer number

translate rotation centre relative to screen axes for nsteps 

@end deffn

@node Views Interface
@section Views Interface

@menu
* add-view-here::
* add-view-raw::
* remove-named-view::
* remove-view::
* add-view-description::
* add-action-view::
* insert-action-view-after-view::
* save-views::
* clear-all-views::
@end menu

@node add-view-here
@subsection add-view-here
@deffn function add-view-here view_name

Where @emph{view_name} is a string

return the view number 

@end deffn

@node add-view-raw
@subsection add-view-raw
@deffn function add-view-raw rcx rcy rcz quat1 quat2 quat3 quat4 zoom view_name

Where: 
@itemize @bullet
@item @emph{rcx} is a number
@item @emph{rcy} is a number
@item @emph{rcz} is a number
@item @emph{quat1} is a number
@item @emph{quat2} is a number
@item @emph{quat3} is a number
@item @emph{quat4} is a number
@item @emph{zoom} is a number
@item @emph{view_name} is a string
@end itemize

return the view number 

@end deffn

@node remove-named-view
@subsection remove-named-view
@deffn function remove-named-view view_name

Where @emph{view_name} is a string

the view with the given name 

@end deffn

@node remove-view
@subsection remove-view
@deffn function remove-view view_number

Where @emph{view_number} is an integer number

the given view number 

@end deffn

@node add-view-description
@subsection add-view-description
@deffn function add-view-description view_number description

Where: 
@itemize @bullet
@item @emph{view_number} is an integer number
@item @emph{description} is a string
@end itemize

Add a view description/annotation to the give view number. 

@end deffn

@node add-action-view
@subsection add-action-view
@deffn function add-action-view view_name action_function

Where: 
@itemize @bullet
@item @emph{view_name} is a string
@item @emph{action_function} is a string
@end itemize

add a view (not add to an existing view) that does something (e.g. displays or undisplays a molecule) rather than move the graphics. 

Returns: the view number for this (new) view. 

@end deffn

@node insert-action-view-after-view
@subsection insert-action-view-after-view
@deffn function insert-action-view-after-view view_number view_name action_function

Where: 
@itemize @bullet
@item @emph{view_number} is an integer number
@item @emph{view_name} is a string
@item @emph{action_function} is a string
@end itemize

add an action view after the view of the given view number 

Returns: the view number for this (new) view. 

@end deffn

@node save-views
@subsection save-views
@deffn function save-views view_file_name

Where @emph{view_file_name} is a string

save views to view_file_name 

@end deffn

@node clear-all-views
@subsection clear-all-views
@deffn function clear-all-views

Clear the view list. 

@end deffn

@node Background Colour
@section Background Colour

@menu
* set-background-colour::
* redraw-background::
* background-is-black-p::
@end menu

@node set-background-colour
@subsection set-background-colour
@deffn function set-background-colour red green blue

Where: 
@itemize @bullet
@item @emph{red} is a number
@item @emph{green} is a number
@item @emph{blue} is a number
@end itemize

set the background colour 

red, green and blue are numbers between 0.0 and 1.0 

@end deffn

@node redraw-background
@subsection redraw-background
@deffn function redraw-background

re draw the background colour when switching between mono and stereo 

@end deffn

@node background-is-black-p
@subsection background-is-black-p
@deffn function background-is-black-p

is the background black (or nearly black)? 

Returns: 1 if the background is black (or nearly black), else return 0. 

@end deffn

@node Ligand Fitting Functions
@section Ligand Fitting Functions

@menu
* set-ligand-acceptable-fit-fraction::
* set-ligand-cluster-sigma-level::
* set-ligand-flexible-ligand-n-samples::
* set-find-ligand-n-top-ligands::
* set-find-ligand-multi-solutions-per-cluster::
* set-find-ligand-mask-waters::
* set-ligand-search-protein-molecule::
* set-ligand-search-map-molecule::
* add-ligand-search-ligand-molecule::
* add-ligand-search-wiggly-ligand-molecule::
* set-find-ligand-here-cluster::
* ligand-expert::
* do-find-ligands-dialog::
* match-ligand-atom-names::
* flip-ligand::
@end menu

@node set-ligand-acceptable-fit-fraction
@subsection set-ligand-acceptable-fit-fraction
@deffn function set-ligand-acceptable-fit-fraction f

Where @emph{f} is a number

set the fraction of atoms which must be in positive density after a ligand fit 

@end deffn

@node set-ligand-cluster-sigma-level
@subsection set-ligand-cluster-sigma-level
@deffn function set-ligand-cluster-sigma-level f

Where @emph{f} is a number

set the default sigma level that the map is searched to find potential ligand sites 

@end deffn

@node set-ligand-flexible-ligand-n-samples
@subsection set-ligand-flexible-ligand-n-samples
@deffn function set-ligand-flexible-ligand-n-samples i

Where @emph{i} is an integer number

set the number of conformation samples 

big ligands require more samples. Default 10. 

@end deffn

@node set-find-ligand-n-top-ligands
@subsection set-find-ligand-n-top-ligands
@deffn function set-find-ligand-n-top-ligands n

Where @emph{n} is an integer number

search the top n sites for ligands. 

Default 10. 

@end deffn

@node set-find-ligand-multi-solutions-per-cluster
@subsection set-find-ligand-multi-solutions-per-cluster
@deffn function set-find-ligand-multi-solutions-per-cluster lim_1 lim_2

Where: 
@itemize @bullet
@item @emph{lim_1} is a number
@item @emph{lim_2} is a number
@end itemize

allow multiple ligand solutions per cluster. 

The first limit is the fraction of the top scored positions that go on to correlation scoring (closer to 1 means less and faster - default 0.7).

The second limit is the fraction of the top correlation score that is considered interesting. Limits the number of solutions displayed to user. Default 0.9.

There is currently no chi-angle set redundancy filtering - I suspect that there should be.

Nino-mode. 

@end deffn

@node set-find-ligand-mask-waters
@subsection set-find-ligand-mask-waters
@deffn function set-find-ligand-mask-waters istate

Where @emph{istate} is an integer number

how shall we treat the waters during ligand fitting? 

pass with istate=1 for waters to mask the map in the same way that protein atoms do. 

@end deffn

@node set-ligand-search-protein-molecule
@subsection set-ligand-search-protein-molecule
@deffn function set-ligand-search-protein-molecule imol

Where @emph{imol} is an integer number

set the protein molecule for ligand searching 

@end deffn

@node set-ligand-search-map-molecule
@subsection set-ligand-search-map-molecule
@deffn function set-ligand-search-map-molecule imol_map

Where @emph{imol_map} is an integer number

set the map molecule for ligand searching 

@end deffn

@node add-ligand-search-ligand-molecule
@subsection add-ligand-search-ligand-molecule
@deffn function add-ligand-search-ligand-molecule imol_ligand

Where @emph{imol_ligand} is an integer number

add a rigid ligand molecule to the list of ligands to search for in ligand searching 

@end deffn

@node add-ligand-search-wiggly-ligand-molecule
@subsection add-ligand-search-wiggly-ligand-molecule
@deffn function add-ligand-search-wiggly-ligand-molecule imol_ligand

Where @emph{imol_ligand} is an integer number

add a flexible ligand molecule to the list of ligands to search for in ligand searching 

@end deffn

@node set-find-ligand-here-cluster
@subsection set-find-ligand-here-cluster
@deffn function set-find-ligand-here-cluster state

Where @emph{state} is an integer number

Allow the user a scripting means to find ligand at the rotation centre. 

@end deffn

@node ligand-expert
@subsection ligand-expert
@deffn function ligand-expert

this sets the flag to have expert option ligand entries in the Ligand Searching dialog 

@end deffn

@node do-find-ligands-dialog
@subsection do-find-ligands-dialog
@deffn function do-find-ligands-dialog

display the find ligands dialog 

if maps, coords and ligands are available, that is. 

@end deffn

@node match-ligand-atom-names
@subsection match-ligand-atom-names
@deffn function match-ligand-atom-names imol_ligand chain_id_ligand resno_ligand ins_code_ligand imol_reference chain_id_reference resno_reference ins_code_reference

Where: 
@itemize @bullet
@item @emph{imol_ligand} is an integer number
@item @emph{chain_id_ligand} is a string
@item @emph{resno_ligand} is an integer number
@item @emph{ins_code_ligand} is a string
@item @emph{imol_reference} is an integer number
@item @emph{chain_id_reference} is a string
@item @emph{resno_reference} is an integer number
@item @emph{ins_code_reference} is a string
@end itemize

Overlap residue with "template"-based matching. 

Overlap the first residue in imol_ligand onto the residue specified by the reference parameters. Use graph matching, not atom names.


Match ligand atom names

By using graph matching, make the names of the atoms of the given ligand/residue match those of the reference residue/ligand as closely as possible - where there would be an atom name clash, invent a new atom name. 

Returns: success status, False = failed to find residue in either imol_ligand or imo_ref. If success, return the RT operator.

@end deffn

@node flip-ligand
@subsection flip-ligand
@deffn function flip-ligand imol chain_id resno

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@end itemize

flip the ligand (usually active residue) around its eigen vectors to the next flip number. Immediate replacement (like flip peptide). 

@end deffn

@node Water Fitting Functions
@section Water Fitting Functions

@menu
* execute-find-waters-real::
* move-waters-to-around-protein::
* move-hetgroups-to-around-protein::
* max-water-distance::
* set-water-check-spherical-variance-limit::
* set-ligand-water-to-protein-distance-limits::
* set-ligand-water-n-cycles::
* execute-find-blobs::
* split-water::
@end menu

@node execute-find-waters-real
@subsection execute-find-waters-real
@deffn function execute-find-waters-real imol_for_map imol_for_protein new_waters_mol_flag rmsd_cut_off

Where: 
@itemize @bullet
@item @emph{imol_for_map} is an integer number
@item @emph{imol_for_protein} is an integer number
@item @emph{new_waters_mol_flag} is an integer number
@item @emph{rmsd_cut_off} is a number
@end itemize

find waters 

@end deffn

@node move-waters-to-around-protein
@subsection move-waters-to-around-protein
@deffn function move-waters-to-around-protein imol

Where @emph{imol} is an integer number

move waters of molecule number imol so that they are around the protein. 

Returns: the number of moved waters. 

@end deffn

@node move-hetgroups-to-around-protein
@subsection move-hetgroups-to-around-protein
@deffn function move-hetgroups-to-around-protein imol

Where @emph{imol} is an integer number

move all hetgroups (including waters) of molecule number imol so that they are around the protein. 

@end deffn

@node max-water-distance
@subsection max-water-distance
@deffn function max-water-distance imol

Where @emph{imol} is an integer number

return the maximum minimum distance of any water atom to any protein atom - used in validation of move_waters_to_around_protein() funtion. 

@end deffn

@node set-water-check-spherical-variance-limit
@subsection set-water-check-spherical-variance-limit
@deffn function set-water-check-spherical-variance-limit f

Where @emph{f} is a number

set the limit of interesting variance, above which waters are listed (otherwise ignored) 

default 0.12. 

@end deffn

@node set-ligand-water-to-protein-distance-limits
@subsection set-ligand-water-to-protein-distance-limits
@deffn function set-ligand-water-to-protein-distance-limits f1 f2

Where: 
@itemize @bullet
@item @emph{f1} is a number
@item @emph{f2} is a number
@end itemize

set ligand to protein distance limits 

f1 is the minimum distance, f2 is the maximum distance 

@end deffn

@node set-ligand-water-n-cycles
@subsection set-ligand-water-n-cycles
@deffn function set-ligand-water-n-cycles i

Where @emph{i} is an integer number

set the number of cycles of water searching 

@end deffn

@node execute-find-blobs
@subsection execute-find-blobs
@deffn function execute-find-blobs imol_model imol_for_map cut_off interactive_flag

Where: 
@itemize @bullet
@item @emph{imol_model} is an integer number
@item @emph{imol_for_map} is an integer number
@item @emph{cut_off} is a number
@item @emph{interactive_flag} is an integer number
@end itemize

find blobs 

@end deffn

@node split-water
@subsection split-water
@deffn function split-water imol chain_id res_no ins_code

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{res_no} is an integer number
@item @emph{ins_code} is a string
@end itemize

split the given water and fit to map. 

If refinement map is not defined, don't do anything.

If there is more than one atom in the specified resiue, don't do anything.

If the given atom does not have an alt conf of "", don't do anything. 

@end deffn

@node Bond Representation
@section Bond Representation

@menu
* set-default-bond-thickness::
* set-bond-thickness::
* set-bond-thickness-intermediate-atoms::
* set-default-representation-type::
* get-default-bond-thickness::
* set-draw-zero-occ-markers::
* set-draw-hydrogens::
* draw-hydrogens-state::
* graphics-to-ca-representation::
* graphics-to-ca-plus-ligands-representation::
* graphics-to-ca-plus-ligands-and-sidechains-representation::
* graphics-to-bonds-no-waters-representation::
* graphics-to-bonds-representation::
* graphics-to-ca-plus-ligands-sec-struct-representation::
* graphics-to-sec-struct-bonds-representation::
* graphics-to-rainbow-representation::
* graphics-to-b-factor-representation::
* graphics-to-b-factor-cas-representation::
* graphics-to-occupancy-representation::
* graphics-molecule-bond-type::
* set-b-factor-bonds-scale-factor::
* change-model-molecule-representation-mode::
* make-ball-and-stick::
* clear-ball-and-stick::
* additional-representation-by-string::
* additional-representation-by-attributes::
@end menu

@node set-default-bond-thickness
@subsection set-default-bond-thickness
@deffn function set-default-bond-thickness t

Where @emph{t} is an integer number

set the default thickness for bonds (e.g. in ~/.coot) 

@end deffn

@node set-bond-thickness
@subsection set-bond-thickness
@deffn function set-bond-thickness imol t

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{t} is a number
@end itemize

set the thickness of the bonds in molecule number imol to t pixels 

@end deffn

@node set-bond-thickness-intermediate-atoms
@subsection set-bond-thickness-intermediate-atoms
@deffn function set-bond-thickness-intermediate-atoms t

Where @emph{t} is a number

set the thickness of the bonds of the intermediate atoms to t pixels 

@end deffn

@node set-default-representation-type
@subsection set-default-representation-type
@deffn function set-default-representation-type type

Where @emph{type} is an integer number

set the default represenation type (default 1). 

@end deffn

@node get-default-bond-thickness
@subsection get-default-bond-thickness
@deffn function get-default-bond-thickness

get the default thickness for bonds 

@end deffn

@node set-draw-zero-occ-markers
@subsection set-draw-zero-occ-markers
@deffn function set-draw-zero-occ-markers status

Where @emph{status} is an integer number

set status of drawing zero occupancy markers. 

default status is 1. 

@end deffn

@node set-draw-hydrogens
@subsection set-draw-hydrogens
@deffn function set-draw-hydrogens imol istat

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{istat} is an integer number
@end itemize

set the hydrogen drawing state. istat = 0 is hydrogens off, istat = 1: show hydrogens 

@end deffn

@node draw-hydrogens-state
@subsection draw-hydrogens-state
@deffn function draw-hydrogens-state imol

Where @emph{imol} is an integer number

the state of draw hydrogens for molecule number imol. 

return -1 on bad imol. 

@end deffn

@node graphics-to-ca-representation
@subsection graphics-to-ca-representation
@deffn function graphics-to-ca-representation imol

Where @emph{imol} is an integer number

draw molecule number imol as CAs 

@end deffn

@node graphics-to-ca-plus-ligands-representation
@subsection graphics-to-ca-plus-ligands-representation
@deffn function graphics-to-ca-plus-ligands-representation imol

Where @emph{imol} is an integer number

draw molecule number imol as CA + ligands 

@end deffn

@node graphics-to-ca-plus-ligands-and-sidechains-representation
@subsection graphics-to-ca-plus-ligands-and-sidechains-representation
@deffn function graphics-to-ca-plus-ligands-and-sidechains-representation imol

Where @emph{imol} is an integer number

draw molecule number imol as CA + ligands + sidechains 

@end deffn

@node graphics-to-bonds-no-waters-representation
@subsection graphics-to-bonds-no-waters-representation
@deffn function graphics-to-bonds-no-waters-representation imol

Where @emph{imol} is an integer number

draw molecule number imol with no waters 

@end deffn

@node graphics-to-bonds-representation
@subsection graphics-to-bonds-representation
@deffn function graphics-to-bonds-representation mol

Where @emph{mol} is an integer number

draw molecule number imol with normal bonds 

@end deffn

@node graphics-to-ca-plus-ligands-sec-struct-representation
@subsection graphics-to-ca-plus-ligands-sec-struct-representation
@deffn function graphics-to-ca-plus-ligands-sec-struct-representation imol

Where @emph{imol} is an integer number

draw molecule number imol with CA bonds in secondary structure representation and ligands 

@end deffn

@node graphics-to-sec-struct-bonds-representation
@subsection graphics-to-sec-struct-bonds-representation
@deffn function graphics-to-sec-struct-bonds-representation imol

Where @emph{imol} is an integer number

draw molecule number imol with bonds in secondary structure representation 

@end deffn

@node graphics-to-rainbow-representation
@subsection graphics-to-rainbow-representation
@deffn function graphics-to-rainbow-representation imol

Where @emph{imol} is an integer number

draw molecule number imol in Jones' Rainbow 

@end deffn

@node graphics-to-b-factor-representation
@subsection graphics-to-b-factor-representation
@deffn function graphics-to-b-factor-representation imol

Where @emph{imol} is an integer number

draw molecule number imol coloured by B-factor 

@end deffn

@node graphics-to-b-factor-cas-representation
@subsection graphics-to-b-factor-cas-representation
@deffn function graphics-to-b-factor-cas-representation imol

Where @emph{imol} is an integer number

draw molecule number imol coloured by B-factor, CA + ligands 

@end deffn

@node graphics-to-occupancy-representation
@subsection graphics-to-occupancy-representation
@deffn function graphics-to-occupancy-representation imol

Where @emph{imol} is an integer number

draw molecule number imol coloured by occupancy 

@end deffn

@node graphics-molecule-bond-type
@subsection graphics-molecule-bond-type
@deffn function graphics-molecule-bond-type imol

Where @emph{imol} is an integer number

what is the bond drawing state of molecule number imol 

@end deffn

@node set-b-factor-bonds-scale-factor
@subsection set-b-factor-bonds-scale-factor
@deffn function set-b-factor-bonds-scale-factor imol f

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{f} is a number
@end itemize

scale the colours for colour by b factor representation 

@end deffn

@node change-model-molecule-representation-mode
@subsection change-model-molecule-representation-mode
@deffn function change-model-molecule-representation-mode up_or_down

Where @emph{up_or_down} is an integer number

change the representation of the model molecule closest to the centre of the screen 

@end deffn

@node make-ball-and-stick
@subsection make-ball-and-stick
@deffn function make-ball-and-stick imol atom_selection_str bond_thickness sphere_size do_spheres_flag

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{atom_selection_str} is a string
@item @emph{bond_thickness} is a number
@item @emph{sphere_size} is a number
@item @emph{do_spheres_flag} is an integer number
@end itemize

make a ball and stick representation of imol given atom selection 

e.g. (make-ball-and-stick 0 "/1" 0.15 0.25 1) 

@end deffn

@node clear-ball-and-stick
@subsection clear-ball-and-stick
@deffn function clear-ball-and-stick imol

Where @emph{imol} is an integer number

clear ball and stick representation of molecule number imol 

@end deffn

@node additional-representation-by-string
@subsection additional-representation-by-string
@deffn function additional-representation-by-string imol atom_selection representation_type bonds_box_type bond_width draw_hydrogens_flag

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{atom_selection} is a string
@item @emph{representation_type} is an integer number
@item @emph{bonds_box_type} is an integer number
@item @emph{bond_width} is a number
@item @emph{draw_hydrogens_flag} is an integer number
@end itemize

return the index of the additional representation. Return -1 on error 

@end deffn

@node additional-representation-by-attributes
@subsection additional-representation-by-attributes
@deffn function additional-representation-by-attributes imol chain_id resno_start resno_end ins_code representation_type bonds_box_type bond_width draw_hydrogens_flag

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno_start} is an integer number
@item @emph{resno_end} is an integer number
@item @emph{ins_code} is a string
@item @emph{representation_type} is an integer number
@item @emph{bonds_box_type} is an integer number
@item @emph{bond_width} is a number
@item @emph{draw_hydrogens_flag} is an integer number
@end itemize

return the index of the additional representation. 

Returns: -1 on error. 

@end deffn

@node Dots Representation
@section Dots Representation

@menu
* dots::
* set-dots-colour::
* unset-dots-colour::
* clear-dots::
* clear-dots-by-name::
* n-dots-sets::
@end menu

@node dots
@subsection dots
@deffn function dots imol atom_selection_str dots_object_name dot_density sphere_size_scale

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{atom_selection_str} is a string
@item @emph{dots_object_name} is a string
@item @emph{dot_density} is a number
@item @emph{sphere_size_scale} is a number
@end itemize

display dotted surface 

return a generic objects handle (which can be used to remove later) 

@end deffn

@node set-dots-colour
@subsection set-dots-colour
@deffn function set-dots-colour imol r g b

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{r} is a number
@item @emph{g} is a number
@item @emph{b} is a number
@end itemize

set the colour of the surface dots of the imol-th molecule to be the given single colour 

r,g,b are values between 0.0 and 1.0 

@end deffn

@node unset-dots-colour
@subsection unset-dots-colour
@deffn function unset-dots-colour imol

Where @emph{imol} is an integer number

no longer set the dots of molecule imol to a single colour 

i.e. go back to element-based colours. 

@end deffn

@node clear-dots
@subsection clear-dots
@deffn function clear-dots imol dots_handle

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{dots_handle} is an integer number
@end itemize

clear dots in imol with dots_handle 

@end deffn

@node clear-dots-by-name
@subsection clear-dots-by-name
@deffn function clear-dots-by-name imol dots_object_name

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{dots_object_name} is a string
@end itemize

clear the first dots object for imol with given name 

@end deffn

@node n-dots-sets
@subsection n-dots-sets
@deffn function n-dots-sets imol

Where @emph{imol} is an integer number

return the number of dots sets for molecule number imol 

@end deffn

@node Pep-flip Interface
@section Pep-flip Interface

@menu
* pepflip::
@end menu

@node pepflip
@subsection pepflip
@deffn function pepflip imol chain_id resno inscode altconf

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{inscode} is a string
@item @emph{altconf} is a string
@end itemize

pepflip the given residue 

@end deffn

@node Rigid Body Refinement Interface
@section Rigid Body Refinement Interface

@menu
* rigid-body-refine-zone::
* set-rigid-body-fit-acceptable-fit-fraction::
@end menu

@node rigid-body-refine-zone
@subsection rigid-body-refine-zone
@deffn function rigid-body-refine-zone reso_start resno_end chain_id imol

Where: 
@itemize @bullet
@item @emph{reso_start} is an integer number
@item @emph{resno_end} is an integer number
@item @emph{chain_id} is a string
@item @emph{imol} is an integer number
@end itemize

setup rigid body refine zone 

where we set the atom selection holders according to the arguments and then call execute_rigid_body_refine() 

@end deffn

@node set-rigid-body-fit-acceptable-fit-fraction
@subsection set-rigid-body-fit-acceptable-fit-fraction
@deffn function set-rigid-body-fit-acceptable-fit-fraction f

Where @emph{f} is a number

set rigid body fraction of atoms in positive density 

@end deffn

@node Add Terminal Residue Functions
@section Add Terminal Residue Functions

@menu
* set-add-terminal-residue-immediate-addition::
* add-terminal-residue::
* add-terminal-residue-using-phi-psi::
* set-add-terminal-residue-default-residue-type::
* set-add-terminal-residue-do-post-refine::
* add-terminal-residue-do-post-refine-state::
@end menu

@node set-add-terminal-residue-immediate-addition
@subsection set-add-terminal-residue-immediate-addition
@deffn function set-add-terminal-residue-immediate-addition i

Where @emph{i} is an integer number

set immediate addition of terminal residue 

call with i=1 for immediate addtion 

@end deffn

@node add-terminal-residue
@subsection add-terminal-residue
@deffn function add-terminal-residue imol chain_id residue_number residue_type immediate_add

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{residue_number} is an integer number
@item @emph{residue_type} is a string
@item @emph{immediate_add} is an integer number
@end itemize

Add a terminal residue. 

residue type can be "auto" and immediate_add is recommended to be 1.

return 0 on failure, 1 on success 

@end deffn

@node add-terminal-residue-using-phi-psi
@subsection add-terminal-residue-using-phi-psi
@deffn function add-terminal-residue-using-phi-psi imol chain_id res_no residue_type phi psi

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{res_no} is an integer number
@item @emph{residue_type} is a string
@item @emph{phi} is a number
@item @emph{psi} is a number
@end itemize

Add a terminal residue using given phi and psi angles. 

@end deffn

@node set-add-terminal-residue-default-residue-type
@subsection set-add-terminal-residue-default-residue-type
@deffn function set-add-terminal-residue-default-residue-type type

Where @emph{type} is a string

set the residue type of an added terminal residue. 

@end deffn

@node set-add-terminal-residue-do-post-refine
@subsection set-add-terminal-residue-do-post-refine
@deffn function set-add-terminal-residue-do-post-refine istat

Where @emph{istat} is an integer number

set a flag to run refine zone on terminal residues after an addition. 

@end deffn

@node add-terminal-residue-do-post-refine-state
@subsection add-terminal-residue-do-post-refine-state
@deffn function add-terminal-residue-do-post-refine-state

what is the value of the previous flag? 

@end deffn

@node Delete Residues
@section Delete Residues

@menu
* delete-residue-range::
* delete-residue::
* delete-residue-with-full-spec::
* delete-residue-hydrogens::
* delete-atom::
* delete-residue-sidechain::
* delete-hydrogens::
@end menu

@node delete-residue-range
@subsection delete-residue-range
@deffn function delete-residue-range imol chain_id resno_start end_resno

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno_start} is an integer number
@item @emph{end_resno} is an integer number
@end itemize

delete residue range 

@end deffn

@node delete-residue
@subsection delete-residue
@deffn function delete-residue imol chain_id resno inscode

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{inscode} is a string
@end itemize

delete residue 

@end deffn

@node delete-residue-with-full-spec
@subsection delete-residue-with-full-spec
@deffn function delete-residue-with-full-spec imol imodel chain_id resno inscode altloc

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{imodel} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{inscode} is a string
@item @emph{altloc} is a string
@end itemize

delete residue with altconf 

@end deffn

@node delete-residue-hydrogens
@subsection delete-residue-hydrogens
@deffn function delete-residue-hydrogens imol chain_id resno inscode altloc

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{inscode} is a string
@item @emph{altloc} is a string
@end itemize

delete hydrogen atoms in residue 

@end deffn

@node delete-atom
@subsection delete-atom
@deffn function delete-atom imol chain_id resno ins_code at_name altloc

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{ins_code} is a string
@item @emph{at_name} is a string
@item @emph{altloc} is a string
@end itemize

delete atom in residue 

@end deffn

@node delete-residue-sidechain
@subsection delete-residue-sidechain
@deffn function delete-residue-sidechain imol chain_id resno ins_code do_delete_dialog

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{ins_code} is a string
@item @emph{do_delete_dialog} is an integer number
@end itemize

delete all atoms in residue that are not main chain or CB 

@end deffn

@node delete-hydrogens
@subsection delete-hydrogens
@deffn function delete-hydrogens imol

Where @emph{imol} is an integer number

delete all hydrogens in molecule, 

Returns: number of hydrogens deleted. 

@end deffn

@node Mainchain Building Functions
@section Mainchain Building Functions

@menu
* db-mainchain::
@end menu

@node db-mainchain
@subsection db-mainchain
@deffn function db-mainchain imol chain_id iresno_start iresno_end direction_string

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{iresno_start} is an integer number
@item @emph{iresno_end} is an integer number
@item @emph{direction_string} is a string
@end itemize

CA -> mainchain conversion. 

@end deffn

@node Rotatmer Functions
@section Rotatmer Functions

@menu
* set-rotamer-search-mode::
* set-rotamer-lowest-probability::
* set-rotamer-check-clashes::
* auto-fit-best-rotamer::
* set-auto-fit-best-rotamer-clash-flag::
* n-rotamers::
* set-residue-to-rotamer-number::
* set-residue-to-rotamer-name::
* fill-partial-residues::
@end menu

@node set-rotamer-search-mode
@subsection set-rotamer-search-mode
@deffn function set-rotamer-search-mode mode

Where @emph{mode} is an integer number

set the mode of rotamer search, options are (ROTAMERSEARCHAUTOMATIC), (ROTAMERSEARCHLOWRES) (aka. "backrub rotamers"), (ROTAMERSEARCHHIGHRES) (with rigid body fitting) 

@end deffn

@node set-rotamer-lowest-probability
@subsection set-rotamer-lowest-probability
@deffn function set-rotamer-lowest-probability f

Where @emph{f} is a number

For Dunbrack rotamers, set the lowest probability to be considered. Set as a percentage i.e. 1.00 is quite low. For Richardson Rotamers, this has no effect. 

@end deffn

@node set-rotamer-check-clashes
@subsection set-rotamer-check-clashes
@deffn function set-rotamer-check-clashes i

Where @emph{i} is an integer number

set a flag: 0 is off, 1 is on 

@end deffn

@node auto-fit-best-rotamer
@subsection auto-fit-best-rotamer
@deffn function auto-fit-best-rotamer resno altloc insertion_code chain_id imol_coords imol_map clash_flag lowest_probability

Where: 
@itemize @bullet
@item @emph{resno} is an integer number
@item @emph{altloc} is a string
@item @emph{insertion_code} is a string
@item @emph{chain_id} is a string
@item @emph{imol_coords} is an integer number
@item @emph{imol_map} is an integer number
@item @emph{clash_flag} is an integer number
@item @emph{lowest_probability} is a number
@end itemize

auto fit by rotamer search. 

return the score, for some not very good reason. clash_flag determines if we use clashes with other residues in the score for this rotamer (or not). It would be cool to call this from a script that went residue by residue along a (newly-built) chain (now available). 

@end deffn

@node set-auto-fit-best-rotamer-clash-flag
@subsection set-auto-fit-best-rotamer-clash-flag
@deffn function set-auto-fit-best-rotamer-clash-flag i

Where @emph{i} is an integer number

set the clash flag for rotamer search 

And this functions for [pre-setting] the variables for auto_fit_best_rotamer called interactively (using a graphics_info_t function). 0 off, 1 on. 

@end deffn

@node n-rotamers
@subsection n-rotamers
@deffn function n-rotamers imol chain_id resno ins_code

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{ins_code} is a string
@end itemize

return the number of rotamers for this residue - return -1 on no residue found. 

@end deffn

@node set-residue-to-rotamer-number
@subsection set-residue-to-rotamer-number
@deffn function set-residue-to-rotamer-number imol chain_id resno ins_code alt_conf rotamer_number

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{ins_code} is a string
@item @emph{alt_conf} is a string
@item @emph{rotamer_number} is an integer number
@end itemize

set the residue specified to the rotamer number specifed. 

@end deffn

@node set-residue-to-rotamer-name
@subsection set-residue-to-rotamer-name
@deffn function set-residue-to-rotamer-name imol chain_id resno ins_code alt_conf rotamer_name

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{ins_code} is a string
@item @emph{alt_conf} is a string
@item @emph{rotamer_name} is a string
@end itemize

set the residue specified to the rotamer name specified. 

(rotamer names are the Richardson rotamer names.)

return value is 0 if atoms were not moved (e.g. because rotamer-name was not know) 

@end deffn

@node fill-partial-residues
@subsection fill-partial-residues
@deffn function fill-partial-residues imol

Where @emph{imol} is an integer number

fill all the residues of molecule number imol that have missing atoms. 

To be used to remove the effects of chainsaw. 

@end deffn

@node 180 Flip Side chain
@section 180 Flip Side chain

@menu
* do-180-degree-side-chain-flip::
@end menu

@node do-180-degree-side-chain-flip
@subsection do-180-degree-side-chain-flip
@deffn function do-180-degree-side-chain-flip imol chain_id resno inscode altconf

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{inscode} is a string
@item @emph{altconf} is a string
@end itemize

rotate 180 degrees round the last chi angle 

@end deffn

@node Mutate Functions
@section Mutate Functions

@menu
* setup-mutate-auto-fit::
* mutate::
* mutate-base::
* set-mutate-auto-fit-do-post-refine::
* mutate-auto-fit-do-post-refine-state::
* set-rotamer-auto-fit-do-post-refine::
* rotamer-auto-fit-do-post-refine-state::
* mutate-single-residue-by-serial-number::
* set-residue-type-chooser-stub-state::
@end menu

@node setup-mutate-auto-fit
@subsection setup-mutate-auto-fit
@deffn function setup-mutate-auto-fit state

Where @emph{state} is an integer number

Mutate then fit to map. 

that we have a map define is checked first 

@end deffn

@node mutate
@subsection mutate
@deffn function mutate imol chain_id ires inscode target_res_type

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{ires} is an integer number
@item @emph{inscode} is a string
@item @emph{target_res_type} is a string
@end itemize

mutate a given residue 

target_res_type is a three-letter-code.

Return 1 on a good mutate. 

@end deffn

@node mutate-base
@subsection mutate-base
@deffn function mutate-base imol chain_id res_no ins_code res_type

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{res_no} is an integer number
@item @emph{ins_code} is a string
@item @emph{res_type} is a string
@end itemize

mutate a base. return success status, 1 for a good mutate. 

@end deffn

@node set-mutate-auto-fit-do-post-refine
@subsection set-mutate-auto-fit-do-post-refine
@deffn function set-mutate-auto-fit-do-post-refine istate

Where @emph{istate} is an integer number

Do you want Coot to automatically run a refinement after every mutate and autofit? 

1 for yes, 0 for no. 

@end deffn

@node mutate-auto-fit-do-post-refine-state
@subsection mutate-auto-fit-do-post-refine-state
@deffn function mutate-auto-fit-do-post-refine-state

what is the value of the previous flag? 

@end deffn

@node set-rotamer-auto-fit-do-post-refine
@subsection set-rotamer-auto-fit-do-post-refine
@deffn function set-rotamer-auto-fit-do-post-refine istate

Where @emph{istate} is an integer number

Do you want Coot to automatically run a refinement after every rotamer autofit? 

1 for yes, 0 for no. 

@end deffn

@node rotamer-auto-fit-do-post-refine-state
@subsection rotamer-auto-fit-do-post-refine-state
@deffn function rotamer-auto-fit-do-post-refine-state

what is the value of the previous flag? 

@end deffn

@node mutate-single-residue-by-serial-number
@subsection mutate-single-residue-by-serial-number
@deffn function mutate-single-residue-by-serial-number ires_ser chain_id imol target_res_type

Where: 
@itemize @bullet
@item @emph{ires_ser} is an integer number
@item @emph{chain_id} is a string
@item @emph{imol} is an integer number
@item @emph{target_res_type} is a character
@end itemize

an alternate interface to mutation of a singe residue. 


ires-ser is the serial number of the residue, not the seqnum There 2 functions don't make backups, but 

 does - CHECKME Hence 

 is for use as a "one-by-one" type and the following 2 by wrappers that muate either a residue range or a whole chain

Note that the target_res_type is a char, not a string (or a char *). So from the scheme interface you'd use (for example) hash backslash A for ALA. 

Returns: 1 on success, 0 on failure

@end deffn

@node set-residue-type-chooser-stub-state
@subsection set-residue-type-chooser-stub-state
@deffn function set-residue-type-chooser-stub-state istat

Where @emph{istat} is an integer number

set a flag saying that the residue chosen by mutate or auto-fit mutate should only be added as a stub (mainchain + CB) 

@end deffn

@node Pointer Atom Functions
@section Pointer Atom Functions

@menu
* create-pointer-atom-molecule-maybe::
* pointer-atom-molecule::
@end menu

@node create-pointer-atom-molecule-maybe
@subsection create-pointer-atom-molecule-maybe
@deffn function create-pointer-atom-molecule-maybe

Return the current pointer atom molecule, create a pointer atom molecule if necessary (i.e. when the user has not set it). 

@end deffn

@node pointer-atom-molecule
@subsection pointer-atom-molecule
@deffn function pointer-atom-molecule

Return the current pointer atom molecule. 

@end deffn

@node Baton Build Interface Functions
@section Baton Build Interface Functions

@menu
* set-baton-mode::
* try-set-draw-baton::
* accept-baton-position::
* baton-tip-try-another::
* baton-tip-previous::
* shorten-baton::
* lengthen-baton::
* baton-build-delete-last-residue::
* set-baton-build-params::
@end menu

@node set-baton-mode
@subsection set-baton-mode
@deffn function set-baton-mode i

Where @emph{i} is an integer number

toggle so that mouse movement moves the baton not rotates the view. 

@end deffn

@node try-set-draw-baton
@subsection try-set-draw-baton
@deffn function try-set-draw-baton i

Where @emph{i} is an integer number

draw the baton or not 

@end deffn

@node accept-baton-position
@subsection accept-baton-position
@deffn function accept-baton-position

accept the baton tip position - a prime candidate for a key binding 

@end deffn

@node baton-tip-try-another
@subsection baton-tip-try-another
@deffn function baton-tip-try-another

move the baton tip position - another prime candidate for a key binding 

@end deffn

@node baton-tip-previous
@subsection baton-tip-previous
@deffn function baton-tip-previous

move the baton tip to the previous position 

@end deffn

@node shorten-baton
@subsection shorten-baton
@deffn function shorten-baton

shorten the baton length 

@end deffn

@node lengthen-baton
@subsection lengthen-baton
@deffn function lengthen-baton

lengthen the baton 

@end deffn

@node baton-build-delete-last-residue
@subsection baton-build-delete-last-residue
@deffn function baton-build-delete-last-residue

delete the most recently build CA position 

@end deffn

@node set-baton-build-params
@subsection set-baton-build-params
@deffn function set-baton-build-params istart_resno chain_id direction

Where: 
@itemize @bullet
@item @emph{istart_resno} is an integer number
@item @emph{chain_id} is a string
@item @emph{direction} is a string
@end itemize

set the parameters for the start of a new baton-built fragment. direction can either be "forwards" or "backwards" 

@end deffn

@node Crosshairs  Interface
@section Crosshairs  Interface

@menu
* set-draw-crosshairs::
@end menu

@node set-draw-crosshairs
@subsection set-draw-crosshairs
@deffn function set-draw-crosshairs i

Where @emph{i} is an integer number

draw the distance crosshairs, 0 for off, 1 for on. 

@end deffn

@node Edit Chi Angles
@section Edit Chi Angles

@menu
* set-find-hydrogen-torsions::
* edit-chi-angles::
* setup-torsion-general::
@end menu

@node set-find-hydrogen-torsions
@subsection set-find-hydrogen-torsions
@deffn function set-find-hydrogen-torsions state

Where @emph{state} is an integer number

show torsions that rotate hydrogens in the torsion angle manipulation dialog. Note that this may be needed if, in the dictionary cif file torsion which have as a 4th atom both a hydrogen and a heavier atom bonding to the 3rd atom, but list the 4th atom as a hydrogen (not a heavier atom). 

@end deffn

@node edit-chi-angles
@subsection edit-chi-angles
@deffn function edit-chi-angles imol chain_id resno ins_code altconf

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{ins_code} is a string
@item @emph{altconf} is a string
@end itemize

display the edit chi angles gui for the given residue 

return a status of 0 if it failed to fined the residue, return a value of 1 if it worked. 

@end deffn

@node setup-torsion-general
@subsection setup-torsion-general
@deffn function setup-torsion-general state

Where @emph{state} is an integer number

beloved torsion general at last makes an entrance onto the Coot scene... 

@end deffn

@node Masks
@section Masks

@menu
* mask-map-by-molecule::
* set-map-mask-atom-radius::
* map-mask-atom-radius::
@end menu

@node mask-map-by-molecule
@subsection mask-map-by-molecule
@deffn function mask-map-by-molecule map_mol_no coord_mol_no invert_flag

Where: 
@itemize @bullet
@item @emph{map_mol_no} is an integer number
@item @emph{coord_mol_no} is an integer number
@item @emph{invert_flag} is an integer number
@end itemize

generate a new map that has been masked by some coordinates 

(mask-map-by-molecule map-no mol-no invert?) creates and displays a masked map, cuts down density where the coordinates are (invert is 0). If invert? is 1, cut the density down where there are no atoms atoms. 

@end deffn

@node set-map-mask-atom-radius
@subsection set-map-mask-atom-radius
@deffn function set-map-mask-atom-radius rad

Where @emph{rad} is a number

set the atom radius for map masking 

@end deffn

@node map-mask-atom-radius
@subsection map-mask-atom-radius
@deffn function map-mask-atom-radius

get the atom radius for map masking 

@end deffn

@node check Waters Interface
@section check Waters Interface

@menu
* delete-checked-waters-baddies::
@end menu

@node delete-checked-waters-baddies
@subsection delete-checked-waters-baddies
@deffn function delete-checked-waters-baddies imol b_factor_lim map_sigma_lim min_dist max_dist part_occ_contact_flag zero_occ_flag logical_operator_and_or_flag

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{b_factor_lim} is a number
@item @emph{map_sigma_lim} is a number
@item @emph{min_dist} is a number
@item @emph{max_dist} is a number
@item @emph{part_occ_contact_flag} is an integer number
@item @emph{zero_occ_flag} is an integer number
@item @emph{logical_operator_and_or_flag} is an integer number
@end itemize

Delete waters that are fail to meet the given criteria. 

@end deffn

@node Trim
@section Trim

@menu
* trim-molecule-by-map::
@end menu

@node trim-molecule-by-map
@subsection trim-molecule-by-map
@deffn function trim-molecule-by-map imol_coords imol_map map_level delete_or_zero_occ_flag

Where: 
@itemize @bullet
@item @emph{imol_coords} is an integer number
@item @emph{imol_map} is an integer number
@item @emph{map_level} is a number
@item @emph{delete_or_zero_occ_flag} is an integer number
@end itemize

cut off (delete or give zero occupancy) atoms in the given molecule if they are below the given map (absolute) level. 

@end deffn

@node External Ray-Tracing
@section External Ray-Tracing

@menu
* raster3d::
* set-raster3d-bond-thickness::
* set-raster3d-atom-radius::
* set-raster3d-density-thickness::
* set-renderer-show-atoms::
* set-raster3d-bone-thickness::
* set-raster3d-shadows-enabled::
* set-raster3d-water-sphere::
* raster-screen-shot::
@end menu

@node raster3d
@subsection raster3d
@deffn function raster3d rd3_filename

Where @emph{rd3_filename} is a string

create a r3d file for the current view 

@end deffn

@node set-raster3d-bond-thickness
@subsection set-raster3d-bond-thickness
@deffn function set-raster3d-bond-thickness f

Where @emph{f} is a number

set the bond thickness for the Raster3D representation 

@end deffn

@node set-raster3d-atom-radius
@subsection set-raster3d-atom-radius
@deffn function set-raster3d-atom-radius f

Where @emph{f} is a number

set the atom radius for the Raster3D representation 

@end deffn

@node set-raster3d-density-thickness
@subsection set-raster3d-density-thickness
@deffn function set-raster3d-density-thickness f

Where @emph{f} is a number

set the density line thickness for the Raster3D representation 

@end deffn

@node set-renderer-show-atoms
@subsection set-renderer-show-atoms
@deffn function set-renderer-show-atoms istate

Where @emph{istate} is an integer number

set the flag to show atoms for the Raster3D representation 

@end deffn

@node set-raster3d-bone-thickness
@subsection set-raster3d-bone-thickness
@deffn function set-raster3d-bone-thickness f

Where @emph{f} is a number

set the bone (skeleton) thickness for the Raster3D representation 

@end deffn

@node set-raster3d-shadows-enabled
@subsection set-raster3d-shadows-enabled
@deffn function set-raster3d-shadows-enabled state

Where @emph{state} is an integer number

turn off shadows for raster3d output - give argument 0 to turn off 

@end deffn

@node set-raster3d-water-sphere
@subsection set-raster3d-water-sphere
@deffn function set-raster3d-water-sphere istate

Where @emph{istate} is an integer number

set the flag to show waters as spheres for the Raster3D representation. 1 show as spheres, 0 the usual stars. 

@end deffn

@node raster-screen-shot
@subsection raster-screen-shot
@deffn function raster-screen-shot

run raster3d and display the resulting image. 

@end deffn

@node Superposition (SSM)
@section Superposition (SSM)

@menu
* superpose::
* superpose-with-chain-selection::
* superpose-with-atom-selection::
@end menu

@node superpose
@subsection superpose
@deffn function superpose imol1 imol2 move_imol2_flag

Where: 
@itemize @bullet
@item @emph{imol1} is an integer number
@item @emph{imol2} is an integer number
@item @emph{move_imol2_flag} is an integer number
@end itemize

simple interface to superposition. 

Superpose all residues of imol2 onto imol1. imol1 is reference, we can either move imol2 or copy it to generate a new molecule depending on the vaule of move_imol2_flag (1 for move 0 for copy). 

@end deffn

@node superpose-with-chain-selection
@subsection superpose-with-chain-selection
@deffn function superpose-with-chain-selection imol1 imol2 chain_imol1 chain_imol2 chain_used_flag_imol1 chain_used_flag_imol2 move_imol2_copy_flag

Where: 
@itemize @bullet
@item @emph{imol1} is an integer number
@item @emph{imol2} is an integer number
@item @emph{chain_imol1} is a string
@item @emph{chain_imol2} is a string
@item @emph{chain_used_flag_imol1} is an integer number
@item @emph{chain_used_flag_imol2} is an integer number
@item @emph{move_imol2_copy_flag} is an integer number
@end itemize

chain-based interface to superposition. 

Superpose the given chains of imol2 onto imol1. imol1 is reference, we can either move imol2 or copy it to generate a new molecule depending on the vaule of move_imol2_flag (1 for move 0 for copy). 

@end deffn

@node superpose-with-atom-selection
@subsection superpose-with-atom-selection
@deffn function superpose-with-atom-selection imol1 imol2 mmdb_atom_sel_str_1 mmdb_atom_sel_str_2 move_imol2_copy_flag

Where: 
@itemize @bullet
@item @emph{imol1} is an integer number
@item @emph{imol2} is an integer number
@item @emph{mmdb_atom_sel_str_1} is a string
@item @emph{mmdb_atom_sel_str_2} is a string
@item @emph{move_imol2_copy_flag} is an integer number
@end itemize

detailed interface to superposition. 

Superpose the given atom selection (specified by the mmdb atom selection strings) of imol2 onto imol1. imol1 is reference, we can either move imol2 or copy it to generate a new molecule depending on the vaule of move_imol2_flag (1 for move 0 for copy).

Returns: the index of the superposed molecule - which could either be a new molecule (if move_imol2_flag was 1) or the imol2 or -1 (signifying failure to do the SMM superposition). 

@end deffn

@node NCS
@section NCS

@menu
* set-draw-ncs-ghosts::
* draw-ncs-ghosts-state::
* set-ncs-ghost-bond-thickness::
* ncs-update-ghosts::
* make-dynamically-transformed-ncs-maps::
* add-ncs-matrix::
* add-strict-ncs-matrix::
* show-strict-ncs-state::
* set-show-strict-ncs::
* set-ncs-homology-level::
* copy-chain::
* copy-from-ncs-master-to-others::
* copy-residue-range-from-ncs-master-to-others::
* ncs-control-change-ncs-master-to-chain::
* ncs-control-change-ncs-master-to-chain-id::
* ncs-control-display-chain::
@end menu

@node set-draw-ncs-ghosts
@subsection set-draw-ncs-ghosts
@deffn function set-draw-ncs-ghosts imol istate

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{istate} is an integer number
@end itemize

set drawing state of NCS ghosts for molecule number imol 

@end deffn

@node draw-ncs-ghosts-state
@subsection draw-ncs-ghosts-state
@deffn function draw-ncs-ghosts-state imol

Where @emph{imol} is an integer number

return the drawing state of NCS ghosts for molecule number imol. Return -1 on imol is a bad molecule or no ghosts. 

@end deffn

@node set-ncs-ghost-bond-thickness
@subsection set-ncs-ghost-bond-thickness
@deffn function set-ncs-ghost-bond-thickness imol f

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{f} is a number
@end itemize

set bond thickness of NCS ghosts for molecule number imol 

@end deffn

@node ncs-update-ghosts
@subsection ncs-update-ghosts
@deffn function ncs-update-ghosts imol

Where @emph{imol} is an integer number

update ghosts for molecule number imol 

@end deffn

@node make-dynamically-transformed-ncs-maps
@subsection make-dynamically-transformed-ncs-maps
@deffn function make-dynamically-transformed-ncs-maps imol_model imol_map overwrite_maps_of_same_name_flag

Where: 
@itemize @bullet
@item @emph{imol_model} is an integer number
@item @emph{imol_map} is an integer number
@item @emph{overwrite_maps_of_same_name_flag} is an integer number
@end itemize

make NCS map 

@end deffn

@node add-ncs-matrix
@subsection add-ncs-matrix
@deffn function add-ncs-matrix imol this_chain_id target_chain_id m11 m12 m13 m21 m22 m23 m31 m32 m33 t1 t2 t3

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{this_chain_id} is a string
@item @emph{target_chain_id} is a string
@item @emph{m11} is a number
@item @emph{m12} is a number
@item @emph{m13} is a number
@item @emph{m21} is a number
@item @emph{m22} is a number
@item @emph{m23} is a number
@item @emph{m31} is a number
@item @emph{m32} is a number
@item @emph{m33} is a number
@item @emph{t1} is a number
@item @emph{t2} is a number
@item @emph{t3} is a number
@end itemize

Add NCS matrix. 

@end deffn

@node add-strict-ncs-matrix
@subsection add-strict-ncs-matrix
@deffn function add-strict-ncs-matrix imol this_chain_id target_chain_id m11 m12 m13 m21 m22 m23 m31 m32 m33 t1 t2 t3

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{this_chain_id} is a string
@item @emph{target_chain_id} is a string
@item @emph{m11} is a number
@item @emph{m12} is a number
@item @emph{m13} is a number
@item @emph{m21} is a number
@item @emph{m22} is a number
@item @emph{m23} is a number
@item @emph{m31} is a number
@item @emph{m32} is a number
@item @emph{m33} is a number
@item @emph{t1} is a number
@item @emph{t2} is a number
@item @emph{t3} is a number
@end itemize

add an NCS matrix for strict NCS molecule representation 

for CNS strict NCS usage: expand like normal symmetry does 

@end deffn

@node show-strict-ncs-state
@subsection show-strict-ncs-state
@deffn function show-strict-ncs-state imol

Where @emph{imol} is an integer number

return the state of NCS ghost molecules for molecule number imol 

@end deffn

@node set-show-strict-ncs
@subsection set-show-strict-ncs
@deffn function set-show-strict-ncs imol state

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{state} is an integer number
@end itemize

set display state of NCS ghost molecules for molecule number imol 

@end deffn

@node set-ncs-homology-level
@subsection set-ncs-homology-level
@deffn function set-ncs-homology-level flev

Where @emph{flev} is a number

At what level of homology should we say that we can't see homology for NCS calculation? (default 0.8) 

@end deffn

@node copy-chain
@subsection copy-chain
@deffn function copy-chain imol from_chain to_chain

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{from_chain} is a string
@item @emph{to_chain} is a string
@end itemize

Copy single NCS chain. 

@end deffn

@node copy-from-ncs-master-to-others
@subsection copy-from-ncs-master-to-others
@deffn function copy-from-ncs-master-to-others imol chain_id

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@end itemize

Copy chain from master to all related NCS chains. 

@end deffn

@node copy-residue-range-from-ncs-master-to-others
@subsection copy-residue-range-from-ncs-master-to-others
@deffn function copy-residue-range-from-ncs-master-to-others imol master_chain_id residue_range_start residue_range_end

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{master_chain_id} is a string
@item @emph{residue_range_start} is an integer number
@item @emph{residue_range_end} is an integer number
@end itemize

Copy residue range to all related NCS chains. 

If the target residues do not exist in the peer chains, then create them. 

@end deffn

@node ncs-control-change-ncs-master-to-chain
@subsection ncs-control-change-ncs-master-to-chain
@deffn function ncs-control-change-ncs-master-to-chain imol ichain

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{ichain} is an integer number
@end itemize

change the NCS master chain (by number) 

@end deffn

@node ncs-control-change-ncs-master-to-chain-id
@subsection ncs-control-change-ncs-master-to-chain-id
@deffn function ncs-control-change-ncs-master-to-chain-id imol chain_id

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@end itemize

change the NCS master chain (by chain_id) 

@end deffn

@node ncs-control-display-chain
@subsection ncs-control-display-chain
@deffn function ncs-control-display-chain imol ichain state

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{ichain} is an integer number
@item @emph{state} is an integer number
@end itemize

display the NCS master chain 

@end deffn

@node Helices and Strands
@section Helices and Strands

@menu
* place-helix-here::
* place-strand-here::
* place-strand-here-dialog::
* find-helices::
* find-strands::
* find-secondary-structure::
* find-secondary-structure-local::
@end menu

@node place-helix-here
@subsection place-helix-here
@deffn function place-helix-here

add a helix 

Add a helix somewhere close to this point in the map, try to fit the orientation. Add to a molecule called "Helix", create it if needed. Create another moecule called "Reverse Helix" if the helix orientation isn't completely unequivocal.

Returns: the index of the new molecule. 

@end deffn

@node place-strand-here
@subsection place-strand-here
@deffn function place-strand-here n_residues n_sample_strands

Where: 
@itemize @bullet
@item @emph{n_residues} is an integer number
@item @emph{n_sample_strands} is an integer number
@end itemize

add a strands 

Add a strand close to this point in the map, try to fit the orientation. Add to a molecule called "Strand", create it if needed. n_residues is the estimated number of residues in the strand.

n_sample_strands is the number of strands from the database tested to fit into this strand density. 8 is a suggested number. 20 for a more rigourous search, but it will be slower.

Returns: the index of the new molecule. 

@end deffn

@node place-strand-here-dialog
@subsection place-strand-here-dialog
@deffn function place-strand-here-dialog

show the strand placement gui. 

Choose the python version in there, if needed. Call scripting function, display it in place, don't return a widget. 

@end deffn

@node find-helices
@subsection find-helices
@deffn function find-helices

autobuild helices 

Find secondary structure in the current map. Add to a molecule called "Helices", create it if needed.

Returns: the index of the new molecule. 

@end deffn

@node find-strands
@subsection find-strands
@deffn function find-strands

autobuild strands 

Find secondary structure in the current map. Add to a molecule called "Strands", create it if needed.

Returns: the index of the new molecule. 

@end deffn

@node find-secondary-structure
@subsection find-secondary-structure
@deffn function find-secondary-structure use_helix helix_length helix_target use_strand strand_length strand_target

Where: 
@itemize @bullet
@item @emph{use_helix} is an integer number
@item @emph{helix_length} is an integer number
@item @emph{helix_target} is an integer number
@item @emph{use_strand} is an integer number
@item @emph{strand_length} is an integer number
@item @emph{strand_target} is an integer number
@end itemize

autobuild secondary structure 

Find secondary structure in the current map. Add to a molecule called "SecStruc", create it if needed.

Returns: the index of the new molecule. 

@end deffn

@node find-secondary-structure-local
@subsection find-secondary-structure-local
@deffn function find-secondary-structure-local use_helix helix_length helix_target use_strand strand_length strand_target radius

Where: 
@itemize @bullet
@item @emph{use_helix} is an integer number
@item @emph{helix_length} is an integer number
@item @emph{helix_target} is an integer number
@item @emph{use_strand} is an integer number
@item @emph{strand_length} is an integer number
@item @emph{strand_target} is an integer number
@item @emph{radius} is a number
@end itemize

autobuild secondary structure 

Find secondary structure local to current view in the current map. Add to a molecule called "SecStruc", create it if needed.

Returns: the index of the new molecule. 

@end deffn

@node Nucleotides
@section Nucleotides

@menu
* find-nucleic-acids-local::
@end menu

@node find-nucleic-acids-local
@subsection find-nucleic-acids-local
@deffn function find-nucleic-acids-local radius

Where @emph{radius} is a number

autobuild nucleic acid chains 

Find secondary structure local to current view in the current map. Add to a molecule called "NuclAcid", create it if needed.

Returns: the index of the new molecule. 

@end deffn

@node New Molecule by Section Interface
@section New Molecule by Section Interface

@menu
* new-molecule-by-residue-type-selection::
* new-molecule-by-atom-selection::
* new-molecule-by-sphere-selection::
@end menu

@node new-molecule-by-residue-type-selection
@subsection new-molecule-by-residue-type-selection
@deffn function new-molecule-by-residue-type-selection imol residue_type

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{residue_type} is a string
@end itemize

create a new molecule that consists of only the residue of type residue_type in molecule number imol 

Returns: the new molecule number, -1 means an error. 

@end deffn

@node new-molecule-by-atom-selection
@subsection new-molecule-by-atom-selection
@deffn function new-molecule-by-atom-selection imol atom_selection

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{atom_selection} is a string
@end itemize

create a new molecule that consists of only the atoms specified by the mmdb atoms selection string in molecule number imol 

Returns: the new molecule number, -1 means an error. 

@end deffn

@node new-molecule-by-sphere-selection
@subsection new-molecule-by-sphere-selection
@deffn function new-molecule-by-sphere-selection imol x y z r allow_partial_residues

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{x} is a number
@item @emph{y} is a number
@item @emph{z} is a number
@item @emph{r} is a number
@item @emph{allow_partial_residues} is an integer number
@end itemize

create a new molecule that consists of only the atoms within the given radius (r) of the given position. 

Returns: the new molecule number, -1 means an error. 

@end deffn

@node RNA/DNA
@section RNA/DNA

@menu
* ideal-nucleic-acid::
* watson-crick-pair::
* watson-crick-pair-for-residue-range::
@end menu

@node ideal-nucleic-acid
@subsection ideal-nucleic-acid
@deffn function ideal-nucleic-acid RNA_or_DNA form single_stranged_flag sequence

Where: 
@itemize @bullet
@item @emph{RNA_or_DNA} is a string
@item @emph{form} is a string
@item @emph{single_stranged_flag} is an integer number
@item @emph{sequence} is a string
@end itemize

create a molecule of idea nucleotides 

use the given sequence (single letter code)

RNA_or_DNA is either "RNA" or "DNA"

form is either "A" or "B"

Returns: the new molecule number or -1 if a problem 

@end deffn

@node watson-crick-pair
@subsection watson-crick-pair
@deffn function watson-crick-pair imol chain_id resno

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@end itemize

Return a molecule that contains a residue that is the WC pair partner of the clicked/picked/selected residue. 

@end deffn

@node watson-crick-pair-for-residue-range
@subsection watson-crick-pair-for-residue-range
@deffn function watson-crick-pair-for-residue-range imol chain_id resno_start resno_end

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno_start} is an integer number
@item @emph{resno_end} is an integer number
@end itemize

add base pairs for the given residue range, modify molecule imol by creating a new chain 

@end deffn

@node Sequence (Assignment)
@section Sequence (Assignment)

@menu
* print-sequence-chain::
* assign-fasta-sequence::
* assign-pir-sequence::
* assign-sequence-from-file::
* assign-sequence-from-string::
* delete-all-sequences-from-molecule::
* delete-sequence-by-chain-id::
@end menu

@node print-sequence-chain
@subsection print-sequence-chain
@deffn function print-sequence-chain imol chain_id

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@end itemize

Print the sequence to the console of the given molecule. 

@end deffn

@node assign-fasta-sequence
@subsection assign-fasta-sequence
@deffn function assign-fasta-sequence imol chain_id_in seq

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id_in} is a string
@item @emph{seq} is a string
@end itemize

Assign a FASTA sequence to a given chain in the molecule. 

@end deffn

@node assign-pir-sequence
@subsection assign-pir-sequence
@deffn function assign-pir-sequence imol chain_id_in seq

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id_in} is a string
@item @emph{seq} is a string
@end itemize

Assign a PIR sequence to a given chain in the molecule. If the chain of the molecule already had a chain assigned to it, then this will overwrite that old assignment with the new one. 

@end deffn

@node assign-sequence-from-file
@subsection assign-sequence-from-file
@deffn function assign-sequence-from-file imol file

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{file} is a string
@end itemize

Assign a sequence to a given molecule from (whatever) sequence file. 

@end deffn

@node assign-sequence-from-string
@subsection assign-sequence-from-string
@deffn function assign-sequence-from-string imol chain_id_in seq

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id_in} is a string
@item @emph{seq} is a string
@end itemize

Assign a sequence to a given molecule from a simple string. 

@end deffn

@node delete-all-sequences-from-molecule
@subsection delete-all-sequences-from-molecule
@deffn function delete-all-sequences-from-molecule imol

Where @emph{imol} is an integer number

Delete all the sequences from a given molecule. 

@end deffn

@node delete-sequence-by-chain-id
@subsection delete-sequence-by-chain-id
@deffn function delete-sequence-by-chain-id imol chain_id_in

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id_in} is a string
@end itemize

Delete the sequence for a given chain_id from a given molecule. 

@end deffn

@node Surface Interface
@section Surface Interface

@menu
* do-surface::
* set-transparent-electrostatic-surface::
* get-electrostatic-surface-opacity::
@end menu

@node do-surface
@subsection do-surface
@deffn function do-surface imol istate

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{istate} is an integer number
@end itemize

draw surface of molecule number imol 

if state = 1 draw the surface (normal representation goes away)

if state = 0 don't draw surface 

@end deffn

@node set-transparent-electrostatic-surface
@subsection set-transparent-electrostatic-surface
@deffn function set-transparent-electrostatic-surface imol opacity

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{opacity} is a number
@end itemize

simple on/off screendoor transparency at the moment, an opacity > 0.0 will turn on screendoor transparency (stippling). 

@end deffn

@node get-electrostatic-surface-opacity
@subsection get-electrostatic-surface-opacity
@deffn function get-electrostatic-surface-opacity imol

Where @emph{imol} is an integer number

return 1.0 for non transparent and 0.5 if screendoor transparency has been turned on. 

@end deffn

@node FFFearing
@section FFFearing

@menu
* fffear-search::
* set-fffear-angular-resolution::
* fffear-angular-resolution::
@end menu

@node fffear-search
@subsection fffear-search
@deffn function fffear-search imol_model imol_map

Where: 
@itemize @bullet
@item @emph{imol_model} is an integer number
@item @emph{imol_map} is an integer number
@end itemize

fffear search model in molecule number imol_model in map number imol_map 

@end deffn

@node set-fffear-angular-resolution
@subsection set-fffear-angular-resolution
@deffn function set-fffear-angular-resolution f

Where @emph{f} is a number

set and return the fffear angular resolution in degrees 

@end deffn

@node fffear-angular-resolution
@subsection fffear-angular-resolution
@deffn function fffear-angular-resolution

return the fffear angular resolution in degrees 

@end deffn

@node Remote Control
@section Remote Control

@menu
* make-socket-listener-maybe::
* set-socket-string-waiting::
* set-socket-python-string-waiting::
@end menu

@node make-socket-listener-maybe
@subsection make-socket-listener-maybe
@deffn function make-socket-listener-maybe

try to make socket listener 

@end deffn

@node set-socket-string-waiting
@subsection set-socket-string-waiting
@deffn function set-socket-string-waiting s

Where @emph{s} is a string

feed the main thread a scheme script to evaluate 

@end deffn

@node set-socket-python-string-waiting
@subsection set-socket-python-string-waiting
@deffn function set-socket-python-string-waiting s

Where @emph{s} is a string

feed the main thread a python script to evaluate 

@end deffn

@node Display Lists for Maps
@section Display Lists for Maps

@menu
* set-display-lists-for-maps::
* display-lists-for-maps-state::
@end menu

@node set-display-lists-for-maps
@subsection set-display-lists-for-maps
@deffn function set-display-lists-for-maps i

Where @emph{i} is an integer number

Should display lists be used for maps? It may speed things up if these are turned on (or off) - depends on graphics card and drivers. Pass 1 for on, 0 for off. 

@end deffn

@node display-lists-for-maps-state
@subsection display-lists-for-maps-state
@deffn function display-lists-for-maps-state

return the state of display_lists_for_maps. 

@end deffn

@node Browser Interface
@section Browser Interface

@menu
* browser-url::
* set-browser-interface::
* handle-online-coot-search-request::
@end menu

@node browser-url
@subsection browser-url
@deffn function browser-url url

Where @emph{url} is a string

try to open given url in Web browser 

@end deffn

@node set-browser-interface
@subsection set-browser-interface
@deffn function set-browser-interface browser

Where @emph{browser} is a string

set command to open the web browser, 

examples are "open" or "mozilla" 

@end deffn

@node handle-online-coot-search-request
@subsection handle-online-coot-search-request
@deffn function handle-online-coot-search-request entry_text

Where @emph{entry_text} is a string

the search interface 

find words, construct a url and open it. 

@end deffn

@node Generic Objects
@section Generic Objects

@menu
* new-generic-object-number::
* to-generic-object-add-line::
* to-generic-object-add-dashed-line::
* to-generic-object-add-point::
* to-generic-object-add-arc::
* to-generic-object-add-display-list-handle::
* set-display-generic-object::
* set-display-all-generic-objects::
* generic-object-is-displayed-p::
* generic-object-index::
* number-of-generic-objects::
* generic-object-info::
* generic-object-has-objects-p::
* close-generic-object::
* is-closed-generic-object-p::
* generic-object-clear::
* generic-objects-gui-wrapper::
@end menu

@node new-generic-object-number
@subsection new-generic-object-number
@deffn function new-generic-object-number objname

Where @emph{objname} is a string

create a new generic object with name objname and return the index of the object 

@end deffn

@node to-generic-object-add-line
@subsection to-generic-object-add-line
@deffn function to-generic-object-add-line object_number colour line_width from_x1 from_y1 from_z1 to_x2 to_y2 to_z2

Where: 
@itemize @bullet
@item @emph{object_number} is an integer number
@item @emph{colour} is a string
@item @emph{line_width} is an integer number
@item @emph{from_x1} is a number
@item @emph{from_y1} is a number
@item @emph{from_z1} is a number
@item @emph{to_x2} is a number
@item @emph{to_y2} is a number
@item @emph{to_z2} is a number
@end itemize

add line to generic object object_number 

@end deffn

@node to-generic-object-add-dashed-line
@subsection to-generic-object-add-dashed-line
@deffn function to-generic-object-add-dashed-line object_number colour line_width dash_density from_x1 from_y1 from_z1 to_x2 to_y2 to_z2

Where: 
@itemize @bullet
@item @emph{object_number} is an integer number
@item @emph{colour} is a string
@item @emph{line_width} is an integer number
@item @emph{dash_density} is a number
@item @emph{from_x1} is a number
@item @emph{from_y1} is a number
@item @emph{from_z1} is a number
@item @emph{to_x2} is a number
@item @emph{to_y2} is a number
@item @emph{to_z2} is a number
@end itemize

add a dashed line to generic object object_number 

dash_density is number of dashes per Angstrom. 

@end deffn

@node to-generic-object-add-point
@subsection to-generic-object-add-point
@deffn function to-generic-object-add-point object_number colour point_width from_x1 from_y1 from_z1

Where: 
@itemize @bullet
@item @emph{object_number} is an integer number
@item @emph{colour} is a string
@item @emph{point_width} is an integer number
@item @emph{from_x1} is a number
@item @emph{from_y1} is a number
@item @emph{from_z1} is a number
@end itemize

add point to generic object object_number 

@end deffn

@node to-generic-object-add-arc
@subsection to-generic-object-add-arc
@deffn function to-generic-object-add-arc object_number colour radius radius_inner from_angle to_angle start_point_x start_point_y start_point_z start_dir_x start_dir_y start_dir_z normal_x1 normal_y1 normal_z1

Where: 
@itemize @bullet
@item @emph{object_number} is an integer number
@item @emph{colour} is a string
@item @emph{radius} is a number
@item @emph{radius_inner} is a number
@item @emph{from_angle} is a number
@item @emph{to_angle} is a number
@item @emph{start_point_x} is a number
@item @emph{start_point_y} is a number
@item @emph{start_point_z} is a number
@item @emph{start_dir_x} is a number
@item @emph{start_dir_y} is a number
@item @emph{start_dir_z} is a number
@item @emph{normal_x1} is a number
@item @emph{normal_y1} is a number
@item @emph{normal_z1} is a number
@end itemize

add point to generic object object_number 

@end deffn

@node to-generic-object-add-display-list-handle
@subsection to-generic-object-add-display-list-handle
@deffn function to-generic-object-add-display-list-handle object_number display_list_id

Where: 
@itemize @bullet
@item @emph{object_number} is an integer number
@item @emph{display_list_id} is an integer number
@end itemize

add a display list handle generic object 

@end deffn

@node set-display-generic-object
@subsection set-display-generic-object
@deffn function set-display-generic-object object_number istate

Where: 
@itemize @bullet
@item @emph{object_number} is an integer number
@item @emph{istate} is an integer number
@end itemize

set the display status of object number object_number, 

when they are created, by default objects are not displayed, so we generally need this function. 

@end deffn

@node set-display-all-generic-objects
@subsection set-display-all-generic-objects
@deffn function set-display-all-generic-objects state

Where @emph{state} is an integer number

display (1) or undisplay (0) all generic display objects 

@end deffn

@node generic-object-is-displayed-p
@subsection generic-object-is-displayed-p
@deffn function generic-object-is-displayed-p object_number

Where @emph{object_number} is an integer number

is generic display object displayed? 

Returns: 1 for yes, otherwise 0 

@end deffn

@node generic-object-index
@subsection generic-object-index
@deffn function generic-object-index name

Where @emph{name} is a string

return the index of the object with name name, if not, return -1; 

@end deffn

@node number-of-generic-objects
@subsection number-of-generic-objects
@deffn function number-of-generic-objects

what is the name of generic object number obj_number? 


return the number of generic display objects 

Returns: 0 (NULL) (scheme False) on obj_number not available

@end deffn

@node generic-object-info
@subsection generic-object-info
@deffn function generic-object-info

print to the console the name and display status of the generic display objects 

@end deffn

@node generic-object-has-objects-p
@subsection generic-object-has-objects-p
@deffn function generic-object-has-objects-p obj_no

Where @emph{obj_no} is an integer number

does generic display object number obj_no have things to display? (predicate name) 

Returns: 0 for no things, 1 for things. 

@end deffn

@node close-generic-object
@subsection close-generic-object
@deffn function close-generic-object object_number

Where @emph{object_number} is an integer number

close generic object, clear the lines/points etc, not available for buttons/displaying etc 

@end deffn

@node is-closed-generic-object-p
@subsection is-closed-generic-object-p
@deffn function is-closed-generic-object-p object_number

Where @emph{object_number} is an integer number

has the generic object been closed? 

Returns: 1 for yes, 0 othersize 

@end deffn

@node generic-object-clear
@subsection generic-object-clear
@deffn function generic-object-clear object_number

Where @emph{object_number} is an integer number

clear out the lines and points from object_number, but keep it displayable (not closed). 

@end deffn

@node generic-objects-gui-wrapper
@subsection generic-objects-gui-wrapper
@deffn function generic-objects-gui-wrapper

a kludgey thing, so that the generic objects gui can be called from a callback. 

@end deffn

@node Molprobity Interface
@section Molprobity Interface

@menu
* handle-read-draw-probe-dots::
* handle-read-draw-probe-dots-unformatted::
* set-do-probe-dots-on-rotamers-and-chis::
* do-probe-dots-on-rotamers-and-chis-state::
* set-do-probe-dots-post-refine::
* do-probe-dots-post-refine-state::
* unmangle-hydrogen-name::
* set-interactive-probe-dots-molprobity-radius::
* interactive-probe-dots-molprobity-radius::
@end menu

@node handle-read-draw-probe-dots
@subsection handle-read-draw-probe-dots
@deffn function handle-read-draw-probe-dots dots_file

Where @emph{dots_file} is a string

pass a filename that contains molprobity's probe output in XtalView format 

@end deffn

@node handle-read-draw-probe-dots-unformatted
@subsection handle-read-draw-probe-dots-unformatted
@deffn function handle-read-draw-probe-dots-unformatted dots_file imol show_clash_gui_flag

Where: 
@itemize @bullet
@item @emph{dots_file} is a string
@item @emph{imol} is an integer number
@item @emph{show_clash_gui_flag} is an integer number
@end itemize

pass a filename that contains molprobity's probe output in unformatted format 

@end deffn

@node set-do-probe-dots-on-rotamers-and-chis
@subsection set-do-probe-dots-on-rotamers-and-chis
@deffn function set-do-probe-dots-on-rotamers-and-chis state

Where @emph{state} is an integer number

shall we run molprobity for on edit chi angles intermediate atoms? 

@end deffn

@node do-probe-dots-on-rotamers-and-chis-state
@subsection do-probe-dots-on-rotamers-and-chis-state
@deffn function do-probe-dots-on-rotamers-and-chis-state

return the state of if run molprobity for on edit chi angles intermediate atoms? 

@end deffn

@node set-do-probe-dots-post-refine
@subsection set-do-probe-dots-post-refine
@deffn function set-do-probe-dots-post-refine state

Where @emph{state} is an integer number

shall we run molprobity after a refinement has happened? 

@end deffn

@node do-probe-dots-post-refine-state
@subsection do-probe-dots-post-refine-state
@deffn function do-probe-dots-post-refine-state

show the state of shall we run molprobity after a refinement has happened? 

@end deffn

@node unmangle-hydrogen-name
@subsection unmangle-hydrogen-name
@deffn function unmangle-hydrogen-name pdb_hydrogen_name

Where @emph{pdb_hydrogen_name} is a string

make an attempt to convert pdb hydrogen name to the name used in Coot (and the refmac dictionary, perhaps). 

@end deffn

@node set-interactive-probe-dots-molprobity-radius
@subsection set-interactive-probe-dots-molprobity-radius
@deffn function set-interactive-probe-dots-molprobity-radius r

Where @emph{r} is a number

set the radius over which we can run interactive probe, bigger is better but slower. 

default is 6.0 

@end deffn

@node interactive-probe-dots-molprobity-radius
@subsection interactive-probe-dots-molprobity-radius
@deffn function interactive-probe-dots-molprobity-radius

return the radius over which we can run interactive probe. 

@end deffn

@node Map Sharpening Interface
@section Map Sharpening Interface

@menu
* sharpen::
* set-map-sharpening-scale-limit::
@end menu

@node sharpen
@subsection sharpen
@deffn function sharpen imol b_factor

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{b_factor} is a number
@end itemize

Sharpen map imol by b_factor (note (of course) that positive numbers blur the map). 

@end deffn

@node set-map-sharpening-scale-limit
@subsection set-map-sharpening-scale-limit
@deffn function set-map-sharpening-scale-limit f

Where @emph{f} is a number

set the limit of the b-factor map sharpening slider (default 30) 

@end deffn

@node Marking Fixed Atom Interface
@section Marking Fixed Atom Interface

@menu
* clear-all-fixed-atoms::
@end menu

@node clear-all-fixed-atoms
@subsection clear-all-fixed-atoms
@deffn function clear-all-fixed-atoms imol

Where @emph{imol} is an integer number

clear all fixed atoms 

@end deffn

@node Partial Charges
@section Partial Charges

@menu
* show-partial-charge-info::
@end menu

@node show-partial-charge-info
@subsection show-partial-charge-info
@deffn function show-partial-charge-info imol chain_id resno ins_code

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{ins_code} is a string
@end itemize

show the partial charges for the residue of the given specs (charges are read from the dictionary) 

@end deffn

@node EM interface
@section EM interface

@menu
* scale-cell::
@end menu

@node scale-cell
@subsection scale-cell
@deffn function scale-cell imol_map fac_u fac_v fac_w

Where: 
@itemize @bullet
@item @emph{imol_map} is an integer number
@item @emph{fac_u} is a number
@item @emph{fac_v} is a number
@item @emph{fac_w} is a number
@end itemize

Scale the cell, for use with EM maps, where the cell needs to be adjusted. Use like: (scale-cell 2 1.012 1.012 1.012). Return error status, 1 means it worked, 0 means it did not work. 

@end deffn

@node CCP4mg Interface
@section CCP4mg Interface

@menu
* write-ccp4mg-picture-description::
* get-atom-colour-from-mol-no::
@end menu

@node write-ccp4mg-picture-description
@subsection write-ccp4mg-picture-description
@deffn function write-ccp4mg-picture-description filename

Where @emph{filename} is a string

write a ccp4mg picture description file 

@end deffn

@node get-atom-colour-from-mol-no
@subsection get-atom-colour-from-mol-no
@deffn function get-atom-colour-from-mol-no imol element

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{element} is a string
@end itemize

get element colour for imol as Python formatted list char 

@end deffn

@node Aux functions
@section Aux functions

@menu
* laplacian::
@end menu

@node laplacian
@subsection laplacian
@deffn function laplacian imol

Where @emph{imol} is an integer number

Create the "Laplacian" (-ve second derivative) of the given map. 

@end deffn

@node SMILES
@section SMILES

@menu
* do-smiles-gui::
@end menu

@node do-smiles-gui
@subsection do-smiles-gui
@deffn function do-smiles-gui

display the SMILES string dialog 

@end deffn

@node PHENIX Support
@section PHENIX Support

@menu
* set-button-label-for-external-refinement::
@end menu

@node set-button-label-for-external-refinement
@subsection set-button-label-for-external-refinement
@deffn function set-button-label-for-external-refinement button_label

Where @emph{button_label} is a string

set the button label of the external Refinement program 

@end deffn

@node Graphics Text
@section Graphics Text

@menu
* place-text::
* remove-text::
* text-index-near-position::
@end menu

@node place-text
@subsection place-text
@deffn function place-text text x y z size

Where: 
@itemize @bullet
@item @emph{text} is a string
@item @emph{x} is a number
@item @emph{y} is a number
@item @emph{z} is a number
@item @emph{size} is an integer number
@end itemize

Put text at x,y,z. 


size variable is currently ignored. 

Returns: a text handle

@end deffn

@node remove-text
@subsection remove-text
@deffn function remove-text text_handle

Where @emph{text_handle} is an integer number

Remove "3d" text item. 

@end deffn

@node text-index-near-position
@subsection text-index-near-position
@deffn function text-index-near-position x y z r

Where: 
@itemize @bullet
@item @emph{x} is a number
@item @emph{y} is a number
@item @emph{z} is a number
@item @emph{r} is a number
@end itemize

return the closest text that is with r A of the given position. If no text item is close, then return -1 

@end deffn

@node PISA Interaction
@section PISA Interaction

@menu
* pisa-interaction::
@end menu

@node pisa-interaction
@subsection pisa-interaction
@deffn function pisa-interaction imol_1 imol_2

Where: 
@itemize @bullet
@item @emph{imol_1} is an integer number
@item @emph{imol_2} is an integer number
@end itemize

return the molecule number of the interacting residues. Return -1 if no new model was created. Old, not very useful. 

@end deffn

@node Jiggle Fit
@section Jiggle Fit

@menu
* fit-to-map-by-random-jiggle::
@end menu

@node fit-to-map-by-random-jiggle
@subsection fit-to-map-by-random-jiggle
@deffn function fit-to-map-by-random-jiggle imol chain_id resno ins_code n_trials jiggle_scale_factor

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{chain_id} is a string
@item @emph{resno} is an integer number
@item @emph{ins_code} is a string
@item @emph{n_trials} is an integer number
@item @emph{jiggle_scale_factor} is a number
@end itemize

jiggle fit to the current refinment map. return < -100 if not possible, else return the new best fit for this residue. 

@end deffn

@node SBase interface
@section SBase interface

@menu
* get-ccp4srs-monomer-and-dictionary::
* get-sbase-monomer::
@end menu

@node get-ccp4srs-monomer-and-dictionary
@subsection get-ccp4srs-monomer-and-dictionary
@deffn function get-ccp4srs-monomer-and-dictionary comp_id

Where @emph{comp_id} is a string

return the new molecule number of the monomer. 

The monomer will have chainid "A" and residue number 1.

Return -1 on failure to get monomer. 

@end deffn

@node get-sbase-monomer
@subsection get-sbase-monomer
@deffn function get-sbase-monomer comp_id

Where @emph{comp_id} is a string

same as above but using old name for back-compatibility 

@end deffn

@node FLE-View
@section FLE-View

@menu
* fle-view-set-water-dist-max::
* fle-view-set-h-bond-dist-max::
@end menu

@node fle-view-set-water-dist-max
@subsection fle-view-set-water-dist-max
@deffn function fle-view-set-water-dist-max dist_max

Where @emph{dist_max} is a number

set the maximum considered distance to water 

default 3.25 A. 

@end deffn

@node fle-view-set-h-bond-dist-max
@subsection fle-view-set-h-bond-dist-max
@deffn function fle-view-set-h-bond-dist-max h_bond_dist_max

Where @emph{h_bond_dist_max} is a number

set the maximum considered hydrogen bond distance 

default 3.9 A. 

@end deffn

@node LSQ-improve
@section LSQ-improve

@menu
* lsq-improve::
@end menu

@node lsq-improve
@subsection lsq-improve
@deffn function lsq-improve imol_ref ref_selection imol_moving moving_selection n_res dist_crit

Where: 
@itemize @bullet
@item @emph{imol_ref} is an integer number
@item @emph{ref_selection} is a string
@item @emph{imol_moving} is an integer number
@item @emph{moving_selection} is a string
@item @emph{n_res} is an integer number
@item @emph{dist_crit} is a number
@end itemize

an slightly-modified implementation of the "lsq_improve" algorithm of Kleywegt and Jones (1997). 

Note that if a residue selection is specified in the residue selection(s), then the first residue of the given range must exist in the molecule (if not, then mmdb will not select any atoms from that molecule).

Kleywegt and Jones set n_res to 4 and dist_crit to 6.0. 

@end deffn

@node single-model view
@section single-model view

@menu
* single-model-view-model-number::
* single-model-view-this-model-number::
* single-model-view-next-model-number::
* single-model-view-prev-model-number::
@end menu

@node single-model-view-model-number
@subsection single-model-view-model-number
@deffn function single-model-view-model-number imol imodel

Where: 
@itemize @bullet
@item @emph{imol} is an integer number
@item @emph{imodel} is an integer number
@end itemize

put molecule number imol to display only model number imodel 

@end deffn

@node single-model-view-this-model-number
@subsection single-model-view-this-model-number
@deffn function single-model-view-this-model-number imol

Where @emph{imol} is an integer number

the current model number being displayed 

return 0 on non-multimodel-molecule. 

@end deffn

@node single-model-view-next-model-number
@subsection single-model-view-next-model-number
@deffn function single-model-view-next-model-number imol

Where @emph{imol} is an integer number

change the representation to the next model number to be displayed 

return 0 on non-multimodel-molecule. 

@end deffn

@node single-model-view-prev-model-number
@subsection single-model-view-prev-model-number
@deffn function single-model-view-prev-model-number imol

Where @emph{imol} is an integer number

change the representation to the previous model number to be displayed 

return 0 on non-multimodel-molecule. 

@end deffn

@node graphics 2D ligand view
@section graphics 2D ligand view

@menu
* set-show-graphics-ligand-view::
@end menu

@node set-show-graphics-ligand-view
@subsection set-show-graphics-ligand-view
@deffn function set-show-graphics-ligand-view state

Where @emph{state} is an integer number

set the graphics ligand view state 

(default is 1 (on)). 

@end deffn

